2006-03-16  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text.C (delete): adjust cursor after backspace in change tracking
	mode (bug 2185).

2006-03-16  Félix-Antoine Bourbonnais  <bouf10pub2@myriade.ca>

	* text3.C (dispatch): set needsUpdate according to the return
	value of the methods below (bug 2298)

	* text2.C (cursorTop, cursorBottom, cursorHome, cursorEnd): return
	true if dEPM triggered.

2006-03-16  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text.C (getPossibleLabel): get a sensible prefix inside figure and 
	tabular	floats (bug 1999).

2006-03-16  John Spray  <spray@lyx.org>

	* lyxfunc.C (getStatus): disable LFUN_MENUWRITE when document is
	clean (bug 2313)

2006-03-15  Martin Vermeer  <martin.vermeer@hut.fi>

	* CutAndPaste.C (pasteSelectionHelper): comments
	* paragraph_funcs.C (mergeParagraph): fix Juergen's cut&paste bug
	* changes.h: comments
	* paragraph.C (stripLeadingSpaces): remove unnecessary setChange
	* text.C (backspace): allow deletion of inserted para break
	Change tracking -related bug fixes (reported by Juergen) and 
	some documentation work

2006-03-15  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* MenuBackend.C (expand): make sure the menu is empty before
	starting. 

	* MenuBackend.h (clear): new method.

2006-03-14  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* buffer.C: format up to 246.

2006-03-13  Martin Vermeer  <martin.vermeer@hut.fi>

	* rowpainter.C (paintChangeBar): fix painting of change bar with
	only paragraph break changed

2006-03-12  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* lyx_cb.C (Reconfigure): run lib/configure.py, not lib/configure
	* lyx_main.C (reconfigureUserLyXDir): run ditto

2006-03-12  Martin Vermeer  <martin.vermeer@hut.fi>

	* lyxtext.h: doxygen documentation fix

2006-03-11  Martin Vermeer  <martin.vermeer@hut.fi>

	* paragraph.[Ch] (write, lookupChange, lookupChangeFull;
	added setChangeFull):
	* paragraph_pimpl.[Ch] (trackChanges, cleanChanges, acceptChange,
	rejectChange, erase; added setChangeFull):
	* CutAndPaste.C (eraseSelectionHelper):
	* lyxtext.h:
	* text.C (readParToken, readParagraph, breakParagraph,
	acceptChange, rejectChange, backspace, currentState; 
	added backspacePos0):
	* paragraph_funcs.C (breakParagraphConservative, mergeParagraph):
	* lyxfind.C (findChange, findNextChange): fix bug 880: Change
	tracked paragraphs should still allow a paragraph split (and related
	things, i.e., multi-paragraph change tracking)

2006-03-10  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView_pimpl.C: fix bug 2212: First change is skipped is
	"Merge changes..." dialog

2006-03-10  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* bufferparams.C (writeLaTeX): define \labelitemi with \def. Fixes LaTeX 
	error if the class has not defined them yet (bug 2053).

2006-03-10  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]: 
	* LyXAction.C:
	* debug.[Ch]:
	* rowpainter.C:
	* text3.C: Inside-inset speedup, esp. for the Mac (bug 2195)

2006-03-07  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* pch.h: fix nullstream.hpp location for boost 1.33.0

2006-03-05  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* pch.h:
	* support/pch.h:
	* support/debugstream.h: Use the correct nullstream.

2006-02-26  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* text3.C (mathDispatch): fix math inset creation from string (bug 2315)

2006-02-28  Martin Vermeer  <martin.vermeer@hut.fi>

	* cursor.C (niceInsert): fix (properly) insertion of
	fonts/decorations around selection

2006-02-25  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* lyxfont.C (lyxWriteChanges): Don't write \lang latex

2006-02-24  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (mathDispatch): fix crash when selection is not empty
	but selectionAsString is empty (bug 2321).

2006-02-23  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text.C (changeCase): avoid crash in empty paragraph or on last
	word of the paragraph. (buf 2323)
	(cursorRightOneWord): fix the logic to stop at a beginning of a word.

2006-02-22  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* buffer.C (readHeader): also erase params.preamble in advance
	so that an empty preamble is actually recognized (bug 2317).

	* rowpainter.C (paintFromPos): ditch applyOuterFont (bug 2308).

2006-02-06  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* text2.C (deleteEmptyParagraphMechanism): 64bit compile fix

2006-02-05  Martin Vermeer  <martin.vermeer@hut.fi>

	* buffer.C:
	* bufferparams.[Ch]:
	* lyxtext.h:
	* paragraph.[Ch]:
	* paragraph_funcs.C
	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C: Fix bug 2115: blue language lines (for default font)
	popping up when the documnent font is different. This includes work
	by Georg Baum.

2006-02-02  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* exporter.C (Backends): Add "lyx" backend
	* exporter.C (Export): Handle "lyx" backend
	* graph.C (getReachable): Don't exclude "lyx"
	* MenuBackend.C (expandFormats): exclude "lyx" from export menu

2006-02-03  Martin Vermeer  <martin.vermeer@hut.fi>

	* cursor.C (bruteFind2): convert relative to absolute co-ordinates
	for correct in-mathed positioning

2006-02-03  Martin Vermeer  <martin.vermeer@hut.fi>

	* rowpainter.C (paintForeignMark): fix foreign blue line under
	insets

2006-01-30  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* * text2.C (deleteEmptyParagraphMechanism): fix off-by-one error of the start 
	pit of the uno range (bug 2022).

2006-01-28  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* messages.C (get): Only warn once if setlocale fails (bug 2177)

2006-01-28  Martin Vermeer  <martin.vermeer@hut.fi>

	* text2.C (setCharFont): take inset's own font settings into account
	when defining the font to reduce to, fixes 2019

2006-01-28  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* bufferview_funcs.C (coordOffset): remove the check for
	collapsed collapsables (fix for bug 2094). This is now done
	on a more general level (cursor.C).

	* dociterator.[Ch] (forwardPos): add an optional argument
	bool "ignorecollapsed" (default false), which lets forwardPos
	skip collapsed insets.

	* cursor.C (bruteFind): use forwardPos(ignorecollapsed = true)
	(fixes bug 2241 and 2094).

2006-01-26  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* buffer.C: change tracking (dvipost) doesn't require
	color.sty anymore.

	* LaTeXFeatures.C (getPackages): no need for the color
	option "usenames" (bug 2169).

2006-01-23  Helge Hafting <helge.hafting@aitel.hist.no>
	* buffer_funcs.C: Trivial fix - added {} around
	the statements to be affected by a if-test. Now
	label in a minipage in a float looks ok on screen again.

2006-01-23  Martin Vermeer  <martin.vermeer@hut.fi>

	* text2.C: fix bug 2015: on screen fonts in nested environments 
	can be wrong

2006-01-11  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* converter.C (convert): handle unknown formats

2006-01-19  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* cursor.C (goUpDown): comment out some debug messages.

	* counters.C (newCounter): make error messages more explicit
	(these appear with some textclasses like beamer)

2006-01-18  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* kbmap.C (defkey): 
	* lyxfunc.C (processKeySym): make sure new FuncRequest objects
	have origin set to KEYBOARD. (bug 2221)

2006-01-16  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* rowpainter.C (isCursorOnRow): do not exclude endpos().

2006-01-11  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* cursor.C (macroModeClose): returns true if an inset actually got
	inserted; revert faulty fix to bug 2034.

2006-01-10  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* tabular.C (getLabelList): remove (not used anymore).

2006-01-07  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* outputparams.[Ch]: add new flag inComment

2006-01-04  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text2.C (deleteEmptyParagraphMechanism): since we delete a
	paragraph, recordUndo should span two paragraphs (bug 2155).

2006-01-01  Martin Vermeer  <martin.vermeer@hut.fi>

	* rowpainter.C (paintPar): always repaint the row with the
	cursor in it

2006-01-01  Lars Gullik Bjønnes <larsbj@gullik.net>

	* MenuBackend.h: 
	* bufferlist.h: 
	* lyxtext.h: 
	* paragraph.h:
	* vspace.h: fix syntax error

2005-12-31  Martin Vermeer  <martin.vermeer@hut.fi>

	* text3.C (dispatch): Force refresh if typing into inset changes its
			      metrics

2005-12-30  Martin Vermeer  <martin.vermeer@hut.fi>

	* RowList_fwd.h:
	* paragraph.C:
	* paragraph.h:
	* rowpainter.C: Speed up rendering by only re-painting rows that
	have changed. When selection or whole-screen update active, all rows
	are repainted, as are all rows within insets.

2005-12-30  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* version.C.in: Use PACKAGE_VERSION instead of VERSION

2005-12-29  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* tabular.C (toggleFixedWidth): Use default layout of text class
	instead of hardcoded "Standard"

2005-12-22  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (dispatch): do not call getStatus again to determine
	whether a lfun is disabled (bug 2172).

2005-12-19  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* cursor.C (macroModeClose): set the cursor inside the new math
	atom if relevant (think \frac{}{}) (bug 2034)

2005-12-19  Martin Vermeer  <martin.vermeer@hut.fi>

	* lyxtext.h:
	* text.C:
	* text3.C (Delete, backspace): force update when merging paragraphs

2005-12-16  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView.C (mouseSetCursor): clear the selection properly (bug
	2163). 

2005-12-08  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* text.C (redoParagraph): honor inset->noFontChange()
	* rowpainter.C (paintInset): ditto

2005-12-15  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* lyx_main.C (priv_exec): don't initialize Math on startup 
	(initMath() has been moved to math_hullinset).

2005-12-12  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* lyxrc.C: set default_papersize to PAPER_DEFAULT;
	handle PAPER_DEFAULT in LyXRC::read and LyXRC::write (bug 2148).
	* paper.h: dispose dead PAPER_PACKAGES enum.

2005-12-07  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* Makefile.am (OTHERLIBS): add SOCKET_LIBS in case we compile
	without X support.

2005-12-06  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* exporter.C (Export): Don't try to copy a file if it does not exist
	(bug 1888)

2005-12-02  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text2.C (makeFontEntriesLayoutSpecific): remove.
	(setLayout): adapt.

	* text.C (insertChar): remove bogus caching of fonts (did not do
	anything). 

	* text2.C (LyXText): initialize current_font to ALL_INHERIT (was
	ALL_SANE). (bug 2146)

2005-12-01  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* rowpainter.C (paintFirst): fix centering of
	LABEL_CENTERED_TOP_ENVIRONMENT. 

2005-11-30  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView.C (mouseSetCursor): new method. Calls
	deleteEmptyParagraphMechanism if necessary.

	* lyxtext.h: make deleteEmptyParagraphMechanism public.

	* text3.C (dispatch/LFUN_MOUSE_PRESS): use
	BufferView::mouseSetCursor (bug 2109).
	(dispatch/LFUN_PASTE): remove #warning that is now irrelevant.

2005-11-29  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>	

	* text3.C (dispatch/LFUN_INDEX_INSERT): when a selection is set,
	do not remove it (this inset behaves differently from the others).

2005-11-29  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	Fix bug 2096.
	
	* BufferView_pimpl.C (getStatus): it is only possible to insert a
	file in a text inset.

	* buffer.C (readDocument): remove pit argument and code releated
	to it; set the inset owner correctly (unrelated, but useful).
	(readFile): get rid of pit argument.

	* CutAndPaste.C (pasteSelectionHelper): use a ParagraphList and a
	textclass instead of a selection index.
	(pasteParagraphList): new function.
	(pasteSelection): make it a wrapper around pasteParagraphList.

	* BufferView_pimpl.C (MenuInsertLyXFile): use
	cap::pasteParagraphList to insert a file.

2005-11-29  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* buffer_funcs.C (bufferErrors): prevent endless loop (bug 2121)

2005-11-17  Michael Gerz  <michael.gerz@teststep.org>

	* exporter.C: fix typo in text message

2005-11-28  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* text2.C (setLayout): move recUndo call to other setLayout method
	* tabular.C (toggleFixedWidth): new, handle cell width changes
	* tabular.C (setColumnPWidth): move some code from insettabular.C here
	and use toggleFixedWidth
	* tabular.C (setMColumnPWidth): ditto

2005-11-25  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* paragraph.C (asString): use new inset->textString method (fix
	bug 2089) 

2005-11-24  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* CutAndPaste.C (numberOfSelections): new helper function.

	* lyxfunc.C (getStatus): remove support for LFUN_COPY and LFUN_CUT.

	* text3.C (getStatus): move code for LFUN_CUT and LFUN_COPY from
	LyXFunc::getStatus; implement LFUN_PASTE.

2005-11-17  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* dociterator.[Ch]: new member realInset() that returns the cell
	for tabulars and the inset for the rest (bug 1952).
	* undo.C (textUndoOrRedo): use realInset when resetting insetOwner
	(bug 1952).

2005-11-15  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text.C (leftMargin): honor the NextNoIndent tag in layouts.

2005-11-17  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* lyxfunc.C:
	* paragraph.C:
	* text3.C: InsetBase::forceDefaultParagraphs now takes a cell as
	argument.

2005-11-07  Martin Vermeer  <martin.vermeer@hut.fi>

	* text.C (redoParagraph): Fix bug 1966: cursor doesn't go to next
	line after typing ctrl-enter

2005-11-10  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* bufferview_funcs.C (coordOffset): fix the fix for bug 2094, as
	math insets do not return a proper editable() state yet (bug 2124).

2005-11-07  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView_pimpl.[Ch]: Fix bug 1814: better scroll behaviour for 
	docs containing very large paragraphs.

2005-11-07  Martin Vermeer  <martin.vermeer@hut.fi>

	* cursor.C (selectionBegin, selectionEnd):
	* text.C (drawSelection): Fix bug 2115: assertion when anchor and 
	cursor at different depths.

2005-11-03  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* bufferview_funcs.C (coordOffset): do not call cursorPos
	for collapsed collapsables (fix bug 2094).

2005-11-03  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* paragraph.C (fontSpan): make sure that the FontSpan does not
	span across beginOfBody (bug 1947).

2005-11-02  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxlength.h: undefine macros that clash with solaris/x86 (bug 992)

2005-11-03  Michael Gerz  <michael.gerz@teststep.org>

	* messages.C: fix crash and localization on MinGW/Windows platform

2005-11-02  Angus Leeming  <leeming@lyx.org>

	* Bidi.C:
	* lyxtextclass.C: trivial fixes to some MSVS warnings.

2005-10-28  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (getStatus): re-enable disabled code. (bug 2081)

	* BranchList.h (empty): constify.

2005-10-25  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (getStatus): 
	* MenuBackend.C (expandBranches): take the branch list from the
	master document (bug 2092).
	
	* MenuBackend.C (expandBranches): 
	* bufferparams.C (writeFile): use BranchList type.

2005-10-25  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (dispatch, getStatus): 
	* LyXAction.C (init): 
	* lfuns.h: get rid of LFUN_KEYMAP_TOGGLE

2005-10-25  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* toc.C (getTocList): skip paragraphs which toclevel is NOT_IN_TOC.

2005-10-25  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text.C (insertChar): do not reset boundary (bug 2061)

2005-10-24  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* dociterator.C (updateInsets): new method. Updates the inset_
	cache of all the slices of the iterator.

	* text2.C (deleteEmptyParagraphMechanism): compare also containing
	insets when comparing pit/pos; pass the right cursor to
	recordUndo; when a paragraph has been deleted, compare `old.top()' to
	the right cursor slice of `cur'; use updateInsets on cur to make
	sure that the inset caches are correct; general cleanup.

2005-10-21  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (dispatch): LFUN_NEXT_INSET_TOGGLE: first try to
	dispatch LFUN_INSET_TOGGLE to inset at cursor, and then to
	containg inset. If this does not work, the same command will be
	sent to other insets down the queue by Cursor::dispatch. (bug 2066)

	* lyxfunc.C (dispatch): make sure the cursor is correct when doing
	a dispatch.

2005-10-20  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* lyxtextclass.C (Read): convert layout file if the format is wrong
	* lyxtextclass.C (layout2layout): new, needed for the above

2005-10-18  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* messages.C: do not forget to include <cerrno>.

2005-10-12  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* dociterator.h (StableDocIterator): add access to pos().
	* undo.C (samePar): new method to check if two
	iterators are in the same paragraph
	* undo.C (recordUndo): check for samePar instead of cell identity
	(which includes pos() and is too strict) (fixes bug 2097)

2005-10-07  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text.C (setCursorFromCoordinates): return a bool telling whether
	dEPM triggered.

	* text3.C (cursorPrevious): update if needed after
	setCursorFromCoordinates (when dEPM triggered).

	* text2.C (cursorDown, cursorUp): make sure to reset the anchor
	(otherwise the anchor may be completely wrong and make dEPM assert).

2005-10-12  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* buffer.C: version upgrade to 245.
	* bufferparams.C: remove \quotes_times (bug 2090).
	* text3.C (doDispatch): LFUN_QUOTE_INSERT has to output double
	quotation marks as default.

2005-10-09  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* CutAndPaste.C (nrOfParagraphs): remove (unused)
	* CutAndPaste.C (cutSelection): Remove debug message
	* CutAndPaste.C (cutSelection): Use the real cursor in mathed, record
	undo information and only copy if this is a real cut
	* CutAndPaste.C (pasteSelection): remove superflous cur.resetAnchor()
	call
	* CutAndPaste.C (pasteSelection): remove now superflous mathed warning
	(bug 2059)
	* CutAndPaste.C (eraseSelection): prevent cursor corruption
	* CutAndPaste.C (grabAndEraseSelection, selDel): remove now
	superflous cur.selection() setting
	* CutAndPaste.[Ch] (grabSelection): take a const cursor
	* cursor.C (selectionAsString): implement mathed case ((bug 2059)

2005-10-09  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* text3.C (mathDispatch, dispatch): Dont' record undo steps that don't
	change anything.

2005-10-11  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView_pimpl.C: comment layout change

2005-10-07  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* LyXAction.C:
	* lfuns.h:
	* lyxfunc.C: reimplement LFUN_INSERT_CITATION, which is needed
	by bibliography managers (bug 2071).

2005-10-07  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView_pimpl.C (update): choose arguments to update call so
	that single-par update works most times
	* text3.C (dispatch): carefully tune updating separately for
	whole-screen and current-paragraph
	* rowpainter.C (paintText): 1) replace painting by caching for
	the two extra paragraphs, because we can;
	2) suppress greying out of areas below/above drawn area in case of
	single-par refresh
	* lyxfunc.C (dispatch): remove superfluous update
	* LyXAction.[Ch]: introduce SingleParUpdate

2005-10-05  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (loadLyXFile): ensure that a pointer is
	always initialised before use.

	* text.C (setHeightOfRow): squash warning about comparison
	of signed and unsigned types.

2005-10-03  Martin Vermeer  <martin.vermeer@hut.fi>

	* text.C (cursorX): two fixes involving RtL text drawing

2005-10-03  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* cursor.C (erase): fix 'clever' UI hack. It was activated for all
	items, not only large ones (part of bug 2057)

2005-10-03  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (dispatch): when invoking LFUN_MATH_MACRO with no type
	argument, use "newcommand".

2005-09-28  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* cursor.C (setSelection): do not open collapsable insets;
	the insets do by themselves now (autoopen).

2005-09-28  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* buffer.C: format is up to 244.

2005-09-27  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text.C (redoParagraph): fix calcultation of inset width wrt 
	leftMargin (bug 1957).

	* text3.C (dispatch): leave inset to the right when hitting ESC 
	(bug 2034).

2005-09-23  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text2.C: 
	* text.C: 
	* factory.C:
	* messages.C: include <boost/current_function.hpp> 

2005-09-12  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (sendDispatchMessage): do not update menubar/toolbar
	when command is internal. (bug 1941)

2005-09-20  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text2.C (cursorRight): do not honor boundary when at the end of
	a paragraph. (bug 2010 again)

2005-09-20  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* cursor.C (paste): do nothing if `data' is empty. (bug 2033)

2005-09-19  Martin Vermeer  <martin.vermeer@hut.fi>

	* rowpainter.C (paintText): fix RtL space width display bug (2029)

2005-09-19  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text2.C (setCursor): remove the unused 'boundary' parameter for
	the CursorSlice version; adapt the Cursor version.

	* lyxrc.C (write): 
	* paragraph_pimpl.C (markErased): 
	* cursor.C (bruteFind2, bruteFond3): fix warnings.

2005-09-19  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* rowpainter.C (paintFirst): use a 'labeladdon' for TOP_* labels,
	as is already done for "chapter".

2005-09-16  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (dispatch): LFUN_TEXTCLASS_APPLY: actually set the
	textclass; do not record undo if nothing is changed.

2005-09-16  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text3.C (dispatch): recordUndo in LFUN_PASTESELECTION (#2011).

2005-09-14  Michael Gerz  <michael.gerz@teststep.org>

	* lyxfunc.C: update display after LFUN_ALL_INSETS_TOGGLE

2005-09-13  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView_pimpl.C (setBuffer): when one wants to set the layout
	combox, it is necessary to search for the topmost paragraph in the
	cursor stack (bug 1926)

2005-09-13  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text2.C (cursorEnd, cursorRight): do not set boundary to true at
	end of paragraph. (bug 2010)

2005-09-10  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* text.C (leftMargin): check for inInset == 0

2005-09-10  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text.C (leftMargin): test for insetbase's new neverIndent()
	bool instead of listing each and every inset that does not
	wish par indendation.

2005-09-09  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* buffer_funcs.C (setCounter): put the code to compute enum label
	here (where it belongs).

	* counters.C (enumLabel): move code to buffer_funcs.C.

2005-09-07  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* outputparams.[Ch]: store local_font instead of local_language
	* paragraph.C (simpleTeXOnePar): adapt to the change above

2005-09-08  Martin Vermeer  <martin.vermeer@hut.fi>

	* buffer_funcs.C:
	* counters.[Ch]: clean up special code for Hebrew.

2005-09-08  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (lookupChange): fix code when cursor depth is greater
	than 2.

2005-09-08  Angus Leeming  <leeming@lyx.org>

	* ispell.C:
	* lyxrc.C: correct grammar describing invocation of the
	spellchecker.

2005-08-03  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text.C (read): remove unused variable.
	(readParToken): remove static Change variable (never good in
	recursive settings...); add it as a parameter instead.

	* paragraph_pimpl.C (acceptChange): make debug info conditional.

	* metricsinfo.C (PainterInfo): add new member erased_.

	* rowpainter.C (RowPainter): add erased_ member, initialized from
	PainterInfo. 
	(paintInset): pass erased_ to Inset::draw.

	* lyxfunc.C (lookupChange): new function. Tells whether change 
	tracking is disabled at a given postion.
	(getStatus): disable some actions when in deleted text with change
	tracking. 

2005-08-03  John Levon  <levon@movementarian.org>
	
	* tabular.C (appendColumn, setMultiColumn): adapt to change to
	InsetText::clear().

	* paragraph_pimpl.C (markErased): add bool argument and handle it.
	Also make sure to mark insets recursively.
	(rejectChange, erase): be recursive

	* paragraph.C (markErased): add bool argument.
2005-08-04  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfind.C (findNextChange): tiny cleanup.

	* BufferView_pimpl.C (trackChanges): avoid crash when stopping
	change tracking with the cursor in an inset; make sure the first
	change is not skipped.

2005-09-06  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* CutAndPaste.[Ch]: new methods dirtyTabularStack and 
	tabularStackDirty to work around bug 1919 (tabular needs
	to know whether its own cell paste buffer or the one of 
	texted is newer.
	* CutAndPaste.C: mark tabular_stack_ clean after copy.

2005-08-26  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* text2.C (cursorEnd): check for empty text (fixes bug 1998)

2005-08-19  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* CutAndPaste.C (eraseSelectionHelper): fix bug 1920
	use old deleteion algorithm when changetracking is on.

2005-08-18  Martin Vermeer  <martin.vermeer@hut.fi>

	* messages.C (get): add debug output.

2005-08-02  Martin Vermeer  <martin.vermeer@hut.fi>

	* text.C (cursorX): fix bug 1965: cursor movement at
	line end broken in RtL.
	(drawSelection): fix bug 1970: drawing of single-line 
	selection broken for RtL.

2005-07-31  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	bug 465.

	* dociterator.h (clear, push_back, pop_back): change from
	protected to public.

	* buffer_funcs.C (getItemDepth): renamed from incrementItemDepth
	and changed to just return the value of the item depth; take a
	ParIterator as argument; take the itemdepth at outer nesting level
	into account if necessary; cleanup and comment the code.
	(resetEnumCounterNeeded): renamed from resetEnumCounterIfNeeded
	and changed to just return true if reset is needed; take a
	ParIterator as argument; cleanup and comment the code.
	(setCounter): adapt to above changes.

2005-07-30  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (dispatch): make debug message optional

2005-08-02  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (dispatch): use InsetIncludeMailer for the include
	inset. (bug 1963)

2005-08-02  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView_pimpl.C (updateScrollbar): scrollbar fixes

2005-07-27  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text.C (insertChar):
	* text2.C (deleteEmptyParagraphMechanism): take care whether 
	a blank has been deleted (in change tracking mode) (bug 1254).

2005-07-20  John Levon  <levon@movementarian.org>

	* text2.C (insertStringAsLines): remove old dubious code,
	fixing bug 1939.

2005-07-28  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* MenuBackend.C (expandToc): use Floating::listName() as title of
	the floats submenus.

2005-07-27  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* toc.[Ch]: Do not use translatable strings (bug 1870).

2005-07-20  John Levon  <levon@movementarian.org>

	* tabular.C: fix 1748 - setting multicolumn adds
	  left line to the first cell

2005-07-19  Lars Gullik Bjønnes  <larsbj@lyx.org>

	bug 1920
	* CutAndPaste.C (eraseSelectionHelper): erase all the "middle"
	pars in one go.

2005-07-18  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* messages.C: supress some lyxerr messages

2005-07-18  Juergen Vigna  <jug@lyx.org>

	* text.C (drawSelection): honor boundary when asking for cursorX.

2005-07-17  José Matos  <jamatos@fc.up.pt>

	* tabular.C (recalculateMulticolumns): fix handling of one column
	tables.

2005-07-17  Juergen Vigna  <jug@lyx.org>

	* text.C (Delete, backspace): fixed so that paragraph with the
	same layout can be merged by Delete/Backspace.

2005-07-17  Michael Schmitt  <michael.schmitt@teststep.org>

	* text.C (readParToken): fix spelling.

2005-07-17  Martin Vermeer  <martin.vermeer@hut.fi>

	* text2.C: fix counter update for DEPM problem reported by
	Georg Baum

2005-07-17  Juergen Vigna  <jug@lyx.org>

	* BufferView_pimpl.C (setBuffer): save/restore the
	cursor/selection when switching buffers

	* buffer.h: 
	* buffer.C (saveCursor): add saveDocumentIterators to save the
	cursor when switching buffer.

2005-07-17  Michael Schmitt  <michqel.schmitt@teststep.org>

	* debug.C: fix typo
	* buffer.C: clarify message
	
2005-07-17  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* dociterator.C (DocIterator): fix initialization order

2005-07-17  Juergen Vigna  <jug@lyx.org>

	* text2.C (cursorHome): 
	* text.C (drawSelection, cursorX): 
	* dociterator.C (textRow): add boundary to getRow() call

	* paragraph.C (getRow): implementation of below

	* paragraph.h: add parameter boundary for getRow() function

2005-07-17  José Matos  <jamatos@fc.up.pt>

	* buffer.C:
	* bufferparams.[Ch]:
	* tex-strings.[Ch]: new file format, remove support for a4.sty,
	a4wide.sty and a4widemargins.

2005-07-17  Juergen Vigna  <jug@lyx.org>

	* text2.C (cursorLeft): fix one of error

2005-07-17  Juergen Vigna  <jug@lyx.org>

	* text2.C (getColumnNearX, cursorRight, cursorLeft, cursorHome,
	           cursorEnd):
	more fixes for boundary handling

	* text3.C (dispatch): don't reset cursor if boundary has changed
	on cursor movement.

2005-07-16  Juergen Vigna  <jug@lyx.org>

	* text2.C (getColumnNearX): hopefully got it right now,
	check if we are on column 0 for special case.

2005-07-16  Juergen Vigna  <jug@lyx.org>

	* text2.C (getColumnNearX): handle special case Newline Inset

	* text.C (singleWidth): Just remove bogus check

2005-07-16  Michael Schmitt  <michael.schmitt@teststep.org>

	* funcrequest.C (split): avoid reading uninitialized char c

2005-07-16  José Matos  <jamatos@fc.up.pt>

	* buffer.C:
	* converter.C:
	* lyxrc.C:
	* paper.h:
	* bufferparams.[Ch] (setPaperStuff): remove setPaperStuff and use a
	single papersize variable.

2005-07-16  Juergen Vigna  <jug@lyx.org>

	* text3.C (dispatch): honor boundary when checking if a cursor
	movement has been done

	* text2.C (cursorRight, cursorLeft, cursorUp, cursorDown) 
	(setCursor, setCursorIntern): fix cursor movement with boundary

2005-07-16  Juergen Vigna  <jug@lyx.org>

	* text.C (currentState): output the actual Boundary

2005-07-16  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* factory.C (createInset): fix bad logic for tabular creation

2005-07-16  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* lyx_main.C (init): change some reLyX reference to tex2lyx

2005-07-16  Juergen Vigna  <jug@lyx.org>

	* dociterator.C (DocIterator): initialize boundary

2005-07-16  Juergen Vigna  <jug@lyx.org>

	* text2.C (getColumnNearX): Consider rows without trailing blank.  

2005-07-16  André Pönitz  <poenitz@gmx.net>

	* lyxfont.h: Change order of declarations to give the compiler
	a better chance to inline things

	* lyx_cb.[Ch]: Add 'force' argument to QuitLyX suppressing
	questions on unsaved docs for better scritability

2005-07-16  André Pönitz  <poenitz@gmx.net>

	* paragraph.h (getChar): remove asserts as the same kind of security
	can be achieved by using a suitable standard library implementation
	and the function was in the critical path (25.9% in profiler)

2005-07-16  Juergen Vigna  <jug@lyx.org>

	* cursor.C (bruteFind2):
	* bufferview_funcs.C (coordOffset): 
	* text.C (cursorX,cursorY): Handle cursor position after last char
	in row before a inset which uses a whole row.

2005-07-15  José Matos <jamatos@lyx.org>

	* output_plaintext.[Ch] (writeFileAscii): control reference title
	printing.
	(asciiParagraph): noparbreak was already deal and was incorrectly
	used.

2005-07-15  Juergen Vigna <jug@lyx.org>

	* lyxfunc.C (dispatch): save and restore the cursor after a
	textclass switch.

2005-07-15  Lars Gullik Bjønnes <lgb@tandberg.net>

	* text.C (backspace): bug 806 for empty keepempty paragraphs we
	change the layout to default before letting DEPM do its thing.

	* paragraph_funcs.C (breakParagraph): dont reset the layout on
	keepEmpty paragraphs

	* text.C (setCursorFromCoordinates): add a debug statement

	* text2.C (getColumnNearX): bug 1825 make sure that we don't
	return a pos that is not on the row

	* output_latex.C (TeXDeeper): get rid of potential dereferencing
	of past the end iterator

2005-07-14  André Pönitz  <poenitz@gmx.net>

	* undo.C (recordUndoFullBuffer): implement undo for
	textclass switches

2005-07-14  André Pönitz  <poenitz@gmx.net>

	* cursor.C (setSelection): open insets when selection is set there
	to avoid crashs with cold coord cache

2005-07-14  André Pönitz  <poenitz@gmx.net>

	* trans_mgr.C (insert): move cursor to the right after inserting
	a char.

2005-07-14  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* BufferView_pimpl.C (update): dampen some of the debug blabbering
	* factory.C (readInset): ditto
	* text.C, text2.C: ditto

2005-06-21  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* buffer.C: format incremented to 242. There is no file format per
	se, but the "frenchb" language has been removed from lib/language
	and has to be translated to "french" by lyx2lyx.

2005-07-06  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* cursor_slice.h, dociterator.h: add some documentation
	* cursor_slice.h, dociterator.h (idxSave, idxLoad): remove

2005-07-06  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text.C (leftMargin): do not add identation to display() style
	insets, because they are always centered (bug 1293).

2005-07-05  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text3.C (doDispatch): rewrite LFUN_DATE_INSERT using the brandnew
	formatted_time methods in support/lyxtime.

2005-07-04  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* toc.[Ch]: new method getGuiName, which is used by the frontends 
	to set the toc combo (fixes bug 1870). Make TOC string translatable.

2005-07-01  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* dociterator.[Ch]: implement operator==(StableDocIterator const &, 
	StableDocIterator const &)
	* undo.C (recordUndo): use the above instead of cell.size() comparison
	(fixes bug 1808; instructed by Andrï¿½.

2005-06-29  Martin Vermeer  <martin.vermeer@hut.fi>

	* cursor_slice.h: 
	* dociterator.h: Fix the assert when copying rows/cols in math

2005-06-25  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* BufferView_pimpl.C:
	* LyXAction.C:
	* lfuns.h: reintroduce LFUN_BIBDB_ADD and LFUN_BIBDB_DEL (bug 961)

	* bufferview_funcs.[Ch] (gotoNextInset): rename to findNextInset;
	(findInset): new functions, refactored from goto Inset that return 
	the position of a certain inset without setting the buffer's cursor
	(by Jean-Marc); 
	(gotoInset): rewrite to call findInset and then set the cursor
	(by Jean-Marc).

2005-06-16  Angus Leeming  <leeming@lyx.org>

	* lyxrc.C (output, read): wrap all input and output of paths with
	calls to os::internal_path and os::external_path, respectively.
	(output): wrap bind_file inside quotes.

	* format.C (view): enable the viewer to use the '$$s' placeholder.

2005-06-16  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* LColor.[Ch] (getFromLaTeXName): new

2005-06-16  Martin Vermeer  <martin.vermeer@hut.fi>

	* text.C (readParagraph): fix bug 1904 (GUI affects LaTeX)

2005-06-14  Angus Leeming  <leeming@lyx.org>

	* lyx_main.C (init): ensure that the LyX binary dir is the first
	element in the PATH on non-POSIX builds.

2005-06-11  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* LaTeXFeatures.C (getPackages): solve amsmath-wasysym conflict

2005-06-09  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* rowpainter.C (paintInset, paintHebrewComposeChar)
	(paintArabicComposeChar, paintChars): add a LyXFont argument.
	(paintChars): use getFontSpan to reduce calls to getFont to a
	minimum; use Paragraph::lookupChange instead of isXXXText.
	(paintForeignMark): rename LyXFont argument.
	(paintFromPos): pass a LyXFont object to the various paintXXX
	methods.

	* FontIterator.C (FontIterator, operator++): use
	Paragraph::getFontSpan

	* paragraph.C (getFontSpan): replace getEndOfFontSpan with a
	version that returns the font span as a pair.

2005-06-09  Angus Leeming  <leeming@lyx.org>

	* converter.C (convert): Don't forget "outfile = real_outfile" as
	the final step in a conversion where the input and output file names
	are the same. Otherwise, future conversion steps won't work...

2005-06-09  Angus Leeming  <leeming@lyx.org>

	* lyxsocket.C: remove stub code as it isn't needed by
	MinGW/MinSYS anyway. Let's see if the MSVC people scream...

2005-06-07  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* lyx_main.C (parse_execute): Fix last fix: is_gui = false
	effectively disabled -x

2005-06-06  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* BufferView_pimpl.C (getStatus): enable LFUN_GOTO_NOTE only
	when it actually makes sense.

2005-06-06  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView_pimpl.C: revert to showCursor in connection with
	Lars's front-end stack

2005-06-06  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text.C (redoParagraph): move cursor right after a bibitem
	has been inserted.

	* text3.C: disable LFUN_BIBITEM_INSERT outside Bibliography.

2005-06-02  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* buffer_funcs.C (bufferErrors): fix computation of the end of an
	error range.

2005-05-31  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView.[Ch] (update):
	* BufferView_pimpl.[Ch] (update, metrics):
	* dimension.h (operator==):
	* lyxfunc.C (dispatch):
	* metricsinfo.h (ViewMetricsInfo):
	* rowpainter.C (paintText):
	* lyxtext.h:
	* text.C (redoParagraph):
	* text3.C (dispatch): Make LyX only repaint current paragraph in
	case of character insert --> speedup. Also fix cursor draw
	artifacts

2005-05-31  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* bufferview_funcs.C (gotoInset): fix the wrap-around code to
	avoid a crash (bug 1891)

2005-05-27  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	Fix bug 1892:

	* text2.C (getStringToIndex): constify cur argument.

	* factory.C (createInset/LFUN_TABULAR_INSERT): return 0 if no
	argument has been given
	(createInset/LFUN_INDEX_INSERT): just return a new inset (do not
	try to invoke LFUN_INSET_APPLY).

	* text3.C (dispatch/LFUN_TABULAR_INSERT): open the tabular dialog
	if no inset was created by doInsertInset
	(doInsertInset): return true if an inset has been inserted.

2005-05-23  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* vspace.C (asGUIName): new method. A version of the space
	suitable for showing on screen.

2005-05-20  Michael Schmitt  <michael.schmitt@teststep.org>

	* MenuBackend.C:
	* lyxrc.C: rename "ASCII" to "Plain Text"

2005-05-18  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* buffer_funcs.C (expandLabel): take a Buffer as argument;
	translate the labelstring.
	(setCounter): translate labelstring as needed.

	* output_docbook.C (makeCommand): fix expandLabel invokation

2005-05-14  Michael Schmitt  <michael.schmitt@teststep.org>

	* BufferView.C: fix dialog title

2005-05-18  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* lyx_main.C (priv_exec): fix logic error with help from Angus
	* lyx_main.C (parse_execute): set is_gui = false and remove now
	obsolete comment about a segfault

2005-05-18  Angus Leeming  <leeming@lyx.org>

	* buffer.C (readFile): Quote all file names passed to lyx2lyx.

2005-05-12  Martin Vermeer  <martin.vermeer@hut.fi>

	* tabular.[hC]: added setCellInset to fix tabular paste.

2005-05-11  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* buffer.C (save): check if destination is writable before trying
	to copy a file

2005-05-11  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView_pimpl.C (update): fix processEvents -caused update
	recursion bug

2005-05-10  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* buffer_funcs.C (setCounter): fix test for numbering of
	environments.

	* toc.C (getTocList): use LyXTextClass:min_toclevel to set toc
	depth correctly; use optional argument when it exists

	* lyxtextclass.C: remove unused MaxCounterTags enum
	(Read): compute min_toclevel_ and max_toclevel_ after reading class.
	(max_toclevel, min_toclevel): new methods.

	* MenuBackend.C (expandToc2): fix case where depth is smaller than
	the smallest depth in toc.

	* lyxlayout.[Ch]: add special NOT_IN_TOC toclevel value for
	layouts that should not appear in a table of contents.

2005-05-09  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* cursor.h (undispatched, noUpdate): add comments from Andrï¿½
2005-05-07  Michael Schmitt  <michael.schmitt@teststep.org>

	* lfuns.h:
	* LyXAction.C:
	* BufferView_pimpl.C: rename LFUN_REF_GOTO to LFUN_LABEL_GOTO

2005-05-07  André Pönitz  <poenitz@gmx.net>

	* cursor.[Ch] (leaveInset): new function

2005-05-06  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* lyxfunc.C (dispatch): set update flag for LFUN_INSET_APPLY.

2005-05-04  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (getStatus): disable the spell checker dialog if
	none of USE_[AIP]SPELL are defined.

2005-05-05  Martin Vermeer  <martin.vermeer@hut.fi>

	* tabular.C (setWidthOfCell): remove obsolete comment

2005-05-05  Martin Vermeer  <martin.vermeer@hut.fi>

	* paragraph.C (bibitem):
	* buffer_funcs.C (setCounter):
	* src/text.C (redoParagraph): Ungoose bibliography (bug 940)

2005-05-05  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text3.C (getStatus): immediately return after setOnOff

	* rowpainter.C: fix drawing of appendix start

2005-05-03  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* CutAndPaste.[Ch] (SwitchLayoutsBetweenClasses): rename to
	SwitchBetweenClasses and remove the unused return value.
	Handle character styles, too

2005-05-03  Martin Vermeer  <martin.vermeer@hut.fi>

	* factory.C (createInset): handle undefined character styles

2005-05-02  Angus Leeming  <leeming@lyx.org>

	* buffer.C: protect the #include of utime.h with a preprocessor
	guard.

2005-05-02  Angus Leeming  <leeming@lyx.org>

	* lyx_cb.C: artificially define fork() on Windows as a no-op failing
	function so that auto-saving works, albeit in a blocking manner.

	* Makefile.am: make compilation of the client sub directory, of
	aspell.C, aspell_local.h, pspell.[Ch] and ispell.[Ch] dependent
	on conditionals set at configure time.

	* SpellBase.[Ch]: no longer an abstract base class. Instead,
	it can be compiled in its own right but has no-op functionality.

	* aspell.C, pspell.C: remove preprocessor guards. The files should
	be compiled only if the necessary functionality exists.

	* lyxserver.C, lyxsocket.C: disable on Windows.

2005-05-01  Martin Vermeer  <martin.vermeer@hut.fi>

	* text.C (leftMargin): Fix the parindent use bug (1764)
	by dirty trick

2005-04-28  Michael Schmitt  <michael.schmitt@teststep.org>

	* lyxlayout.C (Read): transform underscores to spaces in CopyStyle
	argument.

2005-04-25  Angus Leeming  <leeming@lyx.org>

	* Bidi.[Ch]:
	* coordcache.[Ch]:
	* ispell.C:
	* lyxserver.C:
	* mover.C:
	* pch.h:
	include <config.h> in .C files, not .h ones.
	add licence blurb.
	protect headers inside preprocessor guards.

2005-04-21  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* FuncStatus.h (StatusCodes): document

2005-04-21  André Pönitz  <poenitz@gmx.net>

	* FuncStatus.h (enabled, onoff): document

2005-04-19  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (cursorToggle): no longer test whether
	any child processes have been reaped before calling
	handleCompletedProcesses().

2005-04-19  Martin Vermeer  <martin.vermeer@hut.fi>

	* text3.C (dispatch): fix, finally fix, the language problem in
	new lyxtexts, without disabling on-the-fly font changes (Helge's
	bug report)

2005-04-19  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text3.C (dispatch): set cursor on double/triple click events
	(bug 1811)

2005-04-14  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (actOnUpdatedPrefs): avoid warning
	(dispatch): update counters and screen after LFUN_TEXTCLASS_APPLY.

	* rowpainter.C (paintFirst): simplify the code a little bit. In
	particular, remove the test for secnumdepth.
	* text.C (setHeightOfRow): only allocate space for chapter number
	when updateCounters provided an actual label, instead of looking
	at secnumdepth directly.

	* lyxlayout.C (LyXLayout): set toclevel to -2 by default.

	* buffer_funcs.C (setCounter): only number LABEL_COUNTER
	paragraphs when secnumdepth is large enough or, for environments,
	when they are not the first in a sequence.

2005-04-17  Angus Leeming  <leeming@lyx.org>

	* buffer.C (makeLaTeXFile): replace code to manipulate a path
	containing space and '~' characters with a call to latex_path().

2005-04-17  Angus Leeming  <leeming@lyx.org>

	* converter.C (convert): protect all args of convertDefault.sh
	script with quotes.

2005-04-11  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (dispatch): change the layout to "Caption" after inserting
	a float.

2005-04-12  Martin Vermeer  <martin.vermeer@hut.fi>

	* text3.C (dispatch): fix language problem in newly created
	textinsets (and main text) in non-english docs

2005-04-13  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* lyxfunc.C (getStatus, dispatch): handle LFUN_INSET_APPLY
	* text3.C (getStatus, dispatch): don't handle LFUN_INSET_APPLY anymore
	* text3.C (getStatus): disable LFUN_INSET_MODIFY

2005-04-12  Martin Vermeer  <martin.vermeer@hut.fi>

	* lyxtext.h:
	* text.C (metrics):
	* text2.C (getFont):
	* rowpainter.C (getFont): Fix metrics bug introduced by inset
	fonts fix

2005-04-11  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* paragraph.C (simpleTeXOnePar): add missing '}' in LaTeX
	output of \item arguments without trailing text.

2005-04-06  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* FontIterator.C (operator*): avoid a copy of the font.

2005-04-10  Martin Vermeer  <martin.vermeer@hut.fi>

	* rowpainter.C (getFont): fix language bug from previous fix

2005-04-10  Martin Vermeer  <martin.vermeer@hut.fi>

	* rowpainter.C (RowPainter, getFont): fix font inside inset
	(bugs 1766, 1809)

2005-04-06  Martin Vermeer  <martin.vermeer@hut.fi>

	* CutAndPaste.C (eraseSelection): more precise fix for bug 1654,
	preventing inserted font, deco, delim insets jumping to start of
	surrounding inset.

2005-03-30  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (dispatch): translate message before sending it to the
	minibuffer.

2005-03-29  Angus Leeming  <leeming@lyx.org>

	* lyx_main.C (priv_exec): call os::internal_path on each file passed
	to LyX on the command line.

2005-03-25  Stephan Witt  <stephan.witt@beusen.de>

	* vc-backend.C: use QuoteName to protect file names wherever
	necessary.

2005-03-27  Martin Vermeer  <martin.vermeer@hut.fi>

	* buffer.[Ch]:
	* BranchList.h: fix bugs 1844,1845: document settings don't
	stick

2005-03-14  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxrc.C (setDefaults, read, output, getDescription): add support
	for tex_allows_spaces.

	* exporter.C (Export): allows files in directory containing spaces
	if tex_allows_spaces is true.

	* buffer.C (makeLaTeXFile): if the document path contains spaces,
	output it in double quotes.

2005-03-22  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* rowpainter.C: use default text height for drawing change tracker
	strikeout lines.

2005-03-21  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* lyx_main.C: fix binding of tabulator key (especially S-Tab).

2005-03-18  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyx_main.C (queryUserLyXDir): fix logic when LyX support
	directory is missing.

2005-03-11  Martin Vermeer  <martin.vermeer@hut.fi>

	* text2.C: fixed the fix, extended to other case.

2005-03-08  Martin Vermeer  <martin.vermeer@hut.fi>

	* text2.C: fix for cursor up/down stuck in math [bug 1792]

2005-03-07  Alfredo Braunstein  <abraunst@lyx.org>

	* text2.C (cursorUp): get rid of a crash
	* text.C (x2pos): add an assert

2005-03-07  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (getStatus): fix warning when assertions are disabled

	* text3.C:
	* lyxfunc.C:
	* dociterator.C: include <boost/current_function.hpp>, which is
	needed when assertions are disabled.

2005-03-05  Johnathan Burchill  <jkerrb@users.sourceforge.net>

	* text2.C: fix for stuck cursor when traversing two
	consecutive spaces. [bug 1255] (pars_[old.pit()].setChange)

2005-02-25  Andreas Vox  <avox@arcor.de>

	* output_docbook.C (makeParagraph): suppress trailing newline
	after a run of paragraphs

2005-02-28  Johnathan Burchill  <jkerrb@users.sourceforge.net>

	* paragraph.C: fix for confused change tracker when pasting
	text that begins with a lineseparator. [bug 1827]
	(setChange(0, Change::INSERTED);)

	* paragraph_funcs.C: fix for lost changes on triple-paste
	in change tracking mode [bug 1827] (par.setChange()).

2005-02-24  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text2.C (updateCounters, setCounter, expandLabel): move to
	buffer_funcs.

	* buffer_funcs.C (updateCounters): turn into a free standing
	function and add a buffer parameter. Remove dead code for tracking
	labelstring change.
	(setCounter): change into a free-standing function which gets a
	dociterator as argument. Use this iterator to fix captions in a
	simple way. When no float is found above the caption, use the
	labelstring of the caption layout as default.

	* text.C (breakParagraph, backspace):
	* text2.C (init, setLayout, changeDepth):
	* text3.C (dispatch):
	* CutAndPaste.C (cutSelection, pasteSelection): pass a buffer to
	updateCounters.

	* dociterator.C (forwardPar): make it much faster by calling
	forwardPos() only when really necessary.

	* output_docbook.C (makeCommand): adapt to expandLabel move.

	* cursor.C: remove unused variable

2005-02-24  Johnathan Burchill  <jkerrb@users.sourceforge.net>

	* paragraph_funcs.C: fix crash when pasting insets in change
	tracking mode [bug 1277] (honour change type in moveItem).

2005-02-23  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* LaTeX.C (scanLogFile): recognize pdfTeX warnings

2005-02-14  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView.C (setCursor): change to use a DocIterator.
	(gotoLabel): use BufferView::setCursor (other part of bug 781).
	(putSelectionAt): adapt to BufferView::setCursor change.

	* bufferview_funcs.C (gotoNextInset, gotoInset): new functions,
	moved here from LyXText and rewritten to use proper cursor
	methods. Fixes bug 1787, 616 and 835.

	* BufferView_pimpl.C (restorePosition): set the cursor correctly
	when inside an inset (part of bug 781).
	(dispatch): adapt to change of BufferView::setCursor.
	(getStatus, dispatch): handle LFUN_GOTOERROR,
	LFUN_GOTONOTE and LFUN_REFERENCE_GOTO.

	* text3.C (getStatus, dispatch): do not handle LFUN_GOTOERROR,
	LFUN_GOTONOTE and LFUN_REFERENCE_GOTO.
	* text3.C (gotoNextInset, gotoInset): removed.

2005-02-20  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyx_main.C (queryUserLyXDir): fix test for rerunning configure

2005-02-15  Angus Leeming  <leeming@lyx.org>

	* rowpainter.C (paintText): Ensure that "paragraphs().size() - 1"
	can be used meaningfully in a comparison.

2005-02-13  André Pönitz  <poenitz@gmx.net>

	* bufferview_funcs.C (coordOffset): improve cursor drawing

2005-02-13  André Pönitz  <poenitz@gmx.net>

	* Cursor.[Ch] (fixIfBroken): new method, try to fix a broken cursor
	* Cursor.C (dispatch): use fixIfBroken
	* lyxfunc.C (getStatus): use fixIfBroken

2005-02-15  Angus Leeming  <leeming@lyx.org>

	* lyx_main.C (error_handler):
	* lyxfunc.C:
	* lyxrc.C (setDefaults):
	s/GetEnv/getEnv/.
	#include "environment.h".

	* lyxsocket.C (LyXServerSocket): s/putenv/setEnv/.

2005-02-15  Angus Leeming  <leeming@lyx.org>

	* lyxserver.C (startPipe): squash MSVC warning "local variable
	'fd' used without having been initialized".

2005-02-14  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* BufferView_pimpl.C: revert accidental commit.

2005-02-14  André Pönitz  <poenitz@gmx.net>

	* dociterator.[Ch]: new member forwardPosNoDescent(),
	which doesn't enter nested insets.
	* text2.C (setFont): use forwardPosNoDescent() instead
	of ForwardPos() (fixes crash on font change).

2005-02-13  Angus Leeming  <leeming@lyx.org>

	* lyx_main.C (init): invoke prependEnvPath to adjust the PATH
	only if lyxrc.path_prefix is not empty.

2005-02-12  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* bufferparams.C (readGraphicsDriver): prevent crash

2005-02-10  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* text2.C (setCounter): check for inInset() == 0

2005-02-09  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView_pimpl.C (dispatch): handle LFUN_GOTO_PARAGRAPH here,
	but use update() to get correct screen display; use convert
	instead of istringstream.
	(getStatus): handle LFUN_GOTO_PARAGRAPH

	* lyxfunc.C (dispatch, getStatus): do not handle
	LFUN_GOTO_PARAGRAPH here.

2005-02-08  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C (dispatch): size() -> depth()

	* text2.C: remove some debug output

	* paragraph.C: ws changes only

	* lyxfunc.C (getStatus): size() -> depth()

	* dociterator.h (clear, push_back, pop_back, internalData,
	operator[], resize, empty): new functions
	Make StableDocIterator and operator== be friends. Don't inherit
	from std::vector use a privat class variable slices_ instead.
	Modify to fit.

	* dociterator.C: update because of not inheriting from std::vector
	anymore. Call explictly to slices_ instead. Use depth() instead of
	size() and top() instead of back()

	* cursor.C: chagne size() -> depth and back() -> top(). Also
	remove some direct operator[](i) calls in favour of foo[i]
	(getFont): remove some dead code

	* bufferview_funcs.C (coordOffset): size() -> depth()

	* buffer.C: ws changes only

	* CutAndPaste.C (eraseSelection): back() -> top()

	* BufferView_pimpl.C (selectionRequested): back() -> top()

	* BufferView.C (setCursor): size() -> depth()

2005-02-08  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C (cursorPrevious): return true if depm changed something
	(cursorNext): ditto
	(dispatch): rename sl to oldTopSlice, remove moving use the new
	NoUpdate func attrib instead. Make sure that needsUpdate is set
	for function that have NoUpdate, but where depm might have changed
	the buffer anyway.

	* text2.C (cursorLeft): make us return true if depm changed
	something
	(cursorRight): ditto
	(cursorUpParagraph): ditto
	(curosrDownParagraph): ditto
	(cursorUp, cursorDown): ditto, make sure to read comments in code
	(deleteEmptyParagraphMechanism): remove an assert, also return
	true if just a single char was deleted.

	* text.C (cursorRightOneWord, cursorLeftOneWord): use a temp
	cursor that we modify, to avoid modifying an active cursor before
	we call setCursor. This allows depm to run. Also return true if
	depm deleted something.

	* lyxtext.h: Make cursorUp, cursorDown, cursorLeft, cursorRight,
	cursorLeftOneWord, cursorRightOneWord, cursorUpParagraph,
	cursorDownParagraph, cursorPrevious and cursorNext, return true if
	something was changed in the buffer because of them (ie. depm run)

	* lyxfunc.C (processKeySym): add BOOST_CURRENT_FUNCTION to some
	debug messages. Make update by default be false. Make sure that
	the result of update is retained throught several calls down to
	dispatch.

	* LyXAction.h: add a new func_attrib: NoUpdate

	* LyXAction.C (init): add noupdate to LFUN_LEFT, LFUN_RIGHT,
	LFUN_DOWN, LFUN_HOME, LFUN_END, LFUN_DOWN_PARAGRAPH,
	LFUN_UP_PARAGRAPH, LFUN_NEXT, LFUN_PRIOR, LFUN_UP, LFUN_WORDRIGHT
	and LFUN_WORDLEFT
	(init): add missing lfuns: LFUN_FINISHED_*, LFUN_MOUSE_*

2005-02-07  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView_pimpl.C: replace all occurences of bv_->cursor(),
	bv_->owner(), bv_->buffer() by direct references to the private
	members.
	(MenuInsertLyXFile): replace bv_->resize() with resizeCurrentBuffer.
	(getStatus): isSavedPosition() is in BufferView::Pimpl.
	(fitCursor): center() is in BufferView::Pimpl.
	(getStatus, trackChanges, dispatch): no need for a temporary buf
	variable
	(fitCursor, workAreaDispatch): use workarea().workheight()

2005-02-07  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* CutAndPaste.C (pasteSelectionHelper): fix a crash

2005-02-03  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* buffer.C: format up to 241.
	* CutAndPaste.C (pasteSelectionHelper): convert newline to paragraph
	break if pasting into ERT
	* lyxfunc.C (getStatus): suppress mathpanel and
	LFUN_DIALOG_SHOW_NEW_INSET in ERT

2005-02-01  Angus Leeming  <leeming@lyx.org>

	* lyxrc.C (getDescription): add a description for RC_PATH_PREFIX.

2005-02-01  Angus Leeming  <leeming@lyx.org>

	* lyx_main.C (init, queryUserLyXDir): use fs::exists() before
	calling fs::is_directory().

2005-01-31  Angus Leeming  <leeming@lyx.org>

	* lyx_main.C (priv_exec): specify explicitly the relative location
	of the top level build directory when run in-place.

2005-01-27  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView_pimpl.C (MenuInsertLyXFile): do breakParagraph on the
	LyXText containing the cursor, not the top-level one.

	* buffer.C (Impl): make sure the toplevel insettext has AutoBreak_
	true.
	(insertStringAsLines): rename par to pit; use temporary variable
	par to hold a Paragraph; do not store par.layout() in a variable,
	since the pointer may die when breaking paragraphs; pass pars to
	breakParagraph() instead of Buffer::paragraphs().

2005-01-31  Asger Ottar Alstrup  <aalstrup@laerdal.dk>

	* lyxlex_pimpl.h: #include <fstream>.

	* BufferView.[Ch] (getLyXText): add a const version.

	* BufferView_pimpl.C: add debug aids.

	* RowList_fwd.h:
	* buffer.h:
	* lyxrow.h:
	* paragraph_funcs.h: add commentary explaining what the class does.


	* coordcache.[Ch]: add lots of commentary.
	(startUpdating, doneUpdating): debug aids.
	(arrays, insets, parPos, getParPos): accessors to private data.

	* cursor_slice.[Ch] (text): add a const version.
	* dociterator.[Ch] (text, innerText): add const versions.

	* lyxtext.h (breakParagraph): change the keep_layout arg to a
	bool.

	* paragraph.C (getRow, pos2ros): add asserts.

	* paragraph.h: add commentary. Lots of.

	* paragraph.[Ch] (metrucs, draw): removed.

	* cursor.C:
	* rowpainter.[Ch]: const-correct changes.

	* text.C: various obvious clean-ups. Removal of ancient cruft.
	Bug fixes, even.

2005-01-31  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* vc-backend.C (find_file): rewrite to use boost.filesystem
	(scanMaster): ditto

	* main.C (main): set default name check for boost.filesystem to
	no check

	* lyxfunc.C (menuNew): rewrite to use boost.filesystem
	(open): ditto
	(doImport): ditto
	(actOnUpdatedPrefs): ditto

	* lyx_main.C (init): rewrite to use boost.filesystem
	(queryUserLyXDir): ditto

	* lyx_cb.C (WriteAs): rewrite to use boost.filesystem
	(getContentsOfAsciiFile): ditto

	* lastfiles.C (readFile): rewrite to use boost.filesystem

	* exporter.C (checkOverwrite): rewrite to use boost.filesystem

	* buffer_funcs.C (readFile): rewrite to use boost.filesystem
	(loadLyXFile): ditto

	* buffer.C (Buffer): adjust for destroydir
	(getLogName): rewrite to use boost.filesystem
	(setFileName): ditto
	(save): use fs::copy_file (from fs_extras)

	* Makefile.am (BOOST_LIBS): add BOOST_FILESYSTEM

	* LaTeX.C (run): rewrite to use boost.filesystem
	(scanAuxFiles): ditto
	(handleFoundFile): ditto

2005-01-28  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* LaTeXFeatures.C (getAvailable): always clear packages_ list.

	* lyx_cb.C (Reconfigure): call LaTeXFeatures::getAvailable()

2005-01-27  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxlayout.[Ch]: change some vars from float to double

	* buffer.C (readFile): make a local var const

	* Several files: use convert<> instead of atoi,strToXXX and friends

2005-01-24  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* LaTeXFeatures.[Ch]: Add a static list packages_ that
	holds the contents of packages.lst. New functions getAvailable
	and isAvailable to parse and check that list, resp.

	* LyXAction.C:
	* lfuns.h:
	* BufferView_pimpl.C: new LFUN_OUTPUT_CHANGES.

	* bufferparams.[Ch]: new param output_changes.

	* Buffer.C: increase file format to 240.
	Use output_changes and isVailable.

	* changes.[Ch]:
	* paragraph.C:
	* paragraph_pimpl.C: Use output_changes and isVailable.

2005-01-23  Angus Leeming  <leeming@lyx.org>

	* output_latex.C: #include "insetbibitem.h", rather than
	forward declare function bibitemWidest.

2005-01-21  Andreas Vox  <vox@isp.uni-luebeck.de>

	* lyx_main.C (init): make it compile on the Mac.

2005-01-20  Angus Leeming  <leeming@lyx.org>

	* lyxfont.C (setLyXFamily, setLyXSeries, setLyXShape, setLyXSize)
	(setLyXMisc): (char string literal) != (char string literal) is
	performing a comparison on the addresses. Convert one operand
	explicitly to string to guarantee expected behaviour.
	From MSVC warning.

2005-01-20  Asger Ottar Alstrup  <aalstrup@laerdal.dk>

	* buffer.C:
	* lyxlex_pimpl.[Ch]: use USE_COMPRESSION guard.

	* output_plaintext.C: remove unneeded #include gzstream.h.

2005-01-20  Angus Leeming  <leeming@lyx.org>

	* SpellBase.h: rename some of the elements of the Result enum.

	* aspell_local.h:
	* ispell.h:
	* pspell.h:
	* aspell.C (check):
	* ispell.C (check):
	* pspell.C (check): ditto

2005-01-20  Asger Ottar Alstrup  <aalstrup@laerdal.dk>

	* buffer.C: add #include <fstream>.

	* lyx_main.C (init): Compile fix.

	* lyxserver.[Ch] (inPipeName, outPipeName): move out of line.

2005-01-20  Angus Leeming  <leeming@lyx.org>

	* mover.h: change commentary to reflect the changed meaning of
	the $$s placeholder.

2005-01-20  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* output_linuxdoc.C (linuxdocParagraphs): silence warning

	* lyxfind.C (MatchString::operator()): remove bogus semicolon

2005-01-20  Angus Leeming  <leeming@lyx.org>

	* output_latex.C (TeXOnePar, TeXEnvironment): prevent crash when
	printing diagnostic data by not dereferecing an iterator past the
	end.

2005-01-19  Asger Ottar Alstrup  <aalstrup@laerdal.dk>

	* buffer.C (readHeader): use "&&" rather than "and".

	* lyxserver.h (inPipeName, outPipeName): make these const.

2005-01-19  Angus Leeming  <leeming@lyx.org>

	* lyx_main.C (error_handler, init): protect SIGHUP with
	#ifdef SIGHUP guards.

2005-01-19  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* LaTeXFeatures.C: rename feature "wasy" to "wasysym".

2005-01-11  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text.C (setHeightOfRow): add a margin at the top and bottom of
	the document (bug 1761)

2005-01-17  Angus Leeming  <leeming@lyx.org>

	* buffer.C (readFile): prepend the name of the "lyx2lyx" script
	with "python ". Workaround for a brain-dead Windows.

2005-01-16  Angus Leeming  <leeming@lyx.org>

	* lyx_main.[Ch] (init): rewrite code to prepend the CWD to the PATH
	for MacOSX and Windows to use prependEnvPath.
	Strip out the hard-coded block to add elements to the PATH for
	MacOSX and replace it with a call to prependEnvPath using the
	contents of LyXRC::path_prefix.
	(queryUserLyXDir): strip out the code to run reconfigure, instead
	returning a boolean indicating the necessity to do so.
	(reconfigureUserLyXDir): contains the code to reconfigure the
	user support directory. Is now called after the various LyXRC data
	files have been read.

	* lyxrc.[Ch]: add path_prefix var and code to read/write it.

2005-01-14  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* converter.[Ch] (convert): take a new parameter try_default. Use
	a default converter (imagemagick) if try_default is true.

2005-01-13  Angus Leeming  <leeming@lyx.org>

	* lyxrc.C (read): use LyXRC::cygwin_path_fix to set the value of
	os::cygwin_path_fix.
	(write): output LyXRC::cygwin_path_fix as necessary.

2005-01-02  Kayvan Sylvan  <kayvan@sylvan.com>

	* lyxrc.h:
	* lyxrc.C (read): Added RC_CYGWIN_PATH_FIX, cygwin_path_fix.

2005-01-12  Angus Leeming  <leeming@lyx.org>

	* lyx_main.C (init): set the PATH variable to include the
	directory containing the LyX binary when running on Mac or Windows.

2005-01-12  Angus Leeming  <leeming@lyx.org>

	* lyx_main.C (init): remove cruft that purports to set the locale
	dir. It doesn't and is not needed anyway.

2005-01-10  Angus Leeming  <leeming@lyx.org>

	* Makefile.am: remove the lyx_main.C special casing.

	* BufferView_pimpl.C:
	* bufferlist.C:
	* exporter.C:
	* lyx_cb.C:
	* lyx_main.C:
	* lyxfunc.C:
	* messages.C: use support/package.h to provide the paths to the
	various directories used by LyX.

2005-01-09  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* CutAndPaste.C (pasteSelectionHelper): fix bug 1332 (preserve the
	layout if pasting into an empty paragraph)

2005-01-07  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* tex-accent.C: add <string>

2005-01-06  José Matos  <jamatos@lyx.org>

	* ParagraphParameters.C (write): put every parameter in its own line.
	* paragraph.C (write): reduce number of consecutive empty lines exported.
	* buffer.C (LYX_FORMAT): increase file format to 239.

2005-01-06  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* everywhere: change support/tostr.h -> support/convert.h

	* tabular.C: make all write_attributes templates, tostr -> convert

	* paragraph.C (simpleLinuxDocOnePar): fix type for ret from getChar
	(emptyTag): and -> &&, and fix type for ret from getChar
	(getFirstWord): fix type for ret from getChar
	(onlyText): and -> &&
	(simpleDocBookOnePar): and not -> && !, fix type for ret from
	getChar

	* toc.C (goTo, action):
	* text3.C (dispatch):
	* text.C (currentState):
	* tex-accent.C (DoAccent):
	* sgml.C:
	* lyxrc.C:
	* lyxfunc.C (menuNew):
	* lyxfinc.C (replace):
	* counters.C (laberItem):
	* bufferview_funcs.C (font2string):
	* bufferparams.C (writeFile):
	* buffer.C (readFile):
	* Spacing.C (set):
	* MenuBackend.C: tostr -> convert

	* LaTeX.C (runMessage): fix format
	(scanAuxFiles): tostr -> convert

	* BufferView_pimpl.C (savePosition): fix format
	(restorePosition): ditto
	(dispatch): ditto

2005-01-06  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* Spacing.[Ch]: New method getValueAsString().

	* Spacing.[Ch]:
	* bufferparams.C:
	* ParagraphParameters.C:
	* lyxlayout.C:
	* text.C:
	* text3.C: store/read spacing value as string.

	* rowpainter.C: change float value (spacing_val) to double.

	* bufferparams.C: add Spacing::Other to spacetranslator (fixes
	broken custom document spacing).

2005-01-05  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxfunc.C (getStatus): moved from lyxfunc.C put into anon
	namespace, also more use of temp references and const

	* cursor.[Ch] (getStatus): move to lyxfunc.C

	* bufferparams.C: reformat slightly

	* bufferview_funcs.C (font2string): constify arg

	* changes.C:
	* converter.C:
	* counters.C:
	* bufferlist.C:
	* buffer_funcs.C: (many funcs): constify arg on function
	definitions, also make more local vars const, also add ASSERTS on
	pointer args.

	* buffer.C (LYX_FORMAT): put const in correct place
	(many funcs): constify arg on function definitions, also make
	more local vars const

	* aspell_local.h: remove "struct" from typdef setup

	* aspell.C (check): make word_ok const
	(nextMiss): simplify slightly
	(error): ditto

2005-01-05  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* lyxrc.[Ch]: store all float values as strings.
	use int (not float) for lyxrc.dpi.

2005-01-04  Angus Leeming  <leeming@lyx.org>

	* lyx_cb.C (Reconfigure):
	* lyx_main.C (queryUserLyXDir):
	to run the <system_lyxdir>/configure correctly on Windows, prefix
	the path to the script with "sh " when generating the string that
	is passed to system().

2005-01-04  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text3.C: reintroduce LFUN_{SUB|SUPER}SCRIPT.

2004-12-29  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxlength.C (asLatexString): get rid of setprecision

2004-12-28  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text2.C (setLayout): remove unused variable endpit.
	(deleteEmptyParagraphMechanism): remove unused variable tmpcursor.

	* paragraph.C (onlyText): remove unused variable style.

	* cursor.C (bruteFind): remove unused variables beg and end.

	* Makefile.am (dist_noinset_DATA): not needed anymore

	* cheaders/*: remove.

2004-12-27  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text3.C: fix LFUN_MATH_MODE.

2004-12-22  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* buffer_funcs.C (countWords): new function. Counts words between
	two iterators.

	* BufferView_pimpl.C (getStatus, dispatch): handle
	LFUN_WORDS_COUNT.

	* LyXAction.C (init):
	* lfuns.h: add LFUN_WORDS_COUNT.

2004-12-19  Angus Leeming  <leeming@lyx.org>

	* buffer.C (save): s/slashify_path/internal_path/.

2004-12-20  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* lyxfind.C (findChange): do not search for end of pars, because
	the change tracker cannot handle this (fixes bug 1719).

2004-12-17  Alfredo Braunstein  <abraunst@lyx.org>

	* paragraph.[Ch] (autoBreakRows): remove

	* lyxtext.h: move autoBreakRows_ flag from InsetText to here.

	* buffer.[Ch] (insertStringAsLines): receive an autobreakrows bool to
	avoid using the paragraph one

	* text2.C (LyXText, insertStringAsLines): adjust

2004-12-16  Angus Leeming  <leeming@lyx.org>

	* bufferlist.C:
	* lyx_main.C:
	* messages.C: remove redundant "using lyx::support::GetEnvPath;"

2004-12-14  Angus Leeming  <leeming@lyx.org>

	* LaTeX.C: (startscript): use os::nulldev() rather than "/dev/null".

	* bufferlist.C (emergencyWrite):
	* lyx_main.C (queryUserLyXDir): use os::homepath(), not
	GetEnvPath("HOME").

2004-12-14  Angus Leeming  <leeming@lyx.org>

	* main.C: (main): no longer pass pointers to os::init.

2004-12-06  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* buffer.C: format up to 239.

2004-12-06  Alfredo Braunstein  <abraunst@lyx.org>

	* undo.C (textUndoOrRedo): simplify logic, fix a crash
	(performUndoOrRedo): set the inset owner of paragraphs (fix a crash)

2004-12-06  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxfunc.C:
	* text3.C: remove selection_possible global flag

2004-12-06  Alfredo Braunstein  <abraunst@lyx.org>

	* text2.C (getSelectionSpan): remove
	(changeDepth, changeDepthAllowed): adjust

2004-12-05  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* Makefile.am (BOOST_LIBS): use boost variables

2004-12-03  José Matos  <jamatos@lyx.org>

	* buffer.C: format up to 238.

2004-12-03  José Matos  <jamatos@lyx.org>

	* tabular.[Ch]: remove setHeaderFooterRows as this code is never called.

2004-12-03  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* cursor.C (goUpDown): remove call to idxUpDown2

2004-12-02  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* tabular.[Ch]: use size_t-like types for cell, row and column
	indices

2004-12-01  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (getStatus): do not lose previous information when
	calling BufferView::getStatus; do not set a default "Command
	disabled" message at the beginning, but just before returning.

2004-11-30  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* cursor.h (getStatus): add better comment from src/cursor.C

2004-11-30  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (getStatus): return false when the lfun is not handled

2004-11-29  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* broken_headers.h: remove

	* Makefile.am (lyx_SOURCES): remove broken_headers.h

2004-11-24  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView.[Ch]: remove top_y, introduce anchor_ref,
	offset_ref accessors

	* BufferView_Pimpl.[Ch]: introduce anchor_ref_, offser_ref_, remove
	top_y_, merge fitcursor with update
	(updateScrollbar, scrollDocView, fitCursor, center, update): new
	coord scheme
	(metrics): introduce
	(workAreaDispatch): adapt to new coord scheme
	(redoCurrentBuffer): remove

	* FontIterator.[Ch]: Use Paragraph & instead of pit_type

	* bufferview_funcs.[Ch]: introduce coordOffset, getPos, status,
	CurStatus enum.

	* coordcache.[Ch]: add paragraph cache and helpers

	* CursorSlice.[Ch]: rename CursorSlice::par to CursorSlice::pit,
	adjust everywhere

	* cursor.[Ch] (getDim): fix, (getPos) use coordOffset
	(targetX, setTargetX): introduce

	* lyxrow.[Ch]: simplify, remove ascent_of_text, y_offset, rename
	baseline -> ascent, as the rest of lyx

	* lyxtext.h: remove redoParagraphs, updateParPositions,
	fullRebreak, redoParagraphInternal. move dist to anon namespace in
	tabular.C (doesn't belong here), remove xo_, yo_ cache, makes it
	have ascent/descent (ascent is ascent of first par)

	* metricsinfo.h: add ViewMetricsInfo struct to use in the metrics
	step of BufferView

	* paragraph.[Ch]: unify dimension handling with the rest of lyx

	* paragraph_funcs.[Ch] (getParsInRange, outerPar): remove.

	* pariterator.C: fix infinite loop introduced in par->pit renaming

	* rowPainter.[Ch]: big rewrite: separate drawSelection from draw
	in insets and LyXText, draw two off-screen paragraphs using
	NullPainter, and adapt to new coord scheme

	* text.C:
	* text2.C:
	* text3.C: adapt lfun handlers to the new coord scheme, which
	means: there's only guaranteed coord information for onscreen pars
	plus one above and one below. This implies that one can do search
	from y coordinates in the range [-1,workHeight]

2004-11-25  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* rename a lot of InsetOld to InsetBase

2004-11-25  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C:
	* lyx_cb.C:
	* lyxfunc.C: s/globbing.h/filefilterlist.h/ in #includes.

2004-11-24  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (getStatus, dispatch): use FuncStatus::message; only
	call BufferView::getStatus if Cursor::getStatus did nothing
	(setStatusMessage, getStatusMessage): removed.

	* FuncStatus.C (message): new methods. Used to provide an error
	message indicating why a command is disabled.
	(clear, |=, FuncStatus): update for message.

2004-11-23  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* lyxfunc.C (dispatch): always call sendDispatchMessage

2004-11-24  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView.C:
	* BufferView_pimpl.C:
	* CutAndPaste.C:
	* FontIterator.C:
	* buffer.C:
	* cursor.C:
	* cursor_slice.[Ch]:
	* dociterator.[Ch]:
	* lyxfind.C:
	* paragraph_funcs.C:
	* pariterator.C:
	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C:
	* undo.C: par->pit renaming

2004-11-23  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* tabular.C (cellstruct): use initialization, store a shared_ptr
	to insettext instead of the insettext directly, adjust to fit.
	(operator=):  new function
	(swap): new function
	(rowstruct): use initialization
	(columnstruct): use initialization
	(ltType): use initialization


	* lyxlength.h (swap): new function

	* LColor.[Ch] (operator=): use the common semantics

2004-11-22  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfind.C (findNextChange): update the bufferview after setting
	the selection.

2004-11-16  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (getStatus): disable LFUN_INSET_OPTARG when the max
	number of InsetOptArgs has already been inserted.

	* output_latex.C (latexOptArgInsets): new method. This outputs all
	the optarg insets, up to the limit defined in the layout file.
	(optArgInset): removed
	(TeXOnePar): call latexOptArgInsets; correctly update texrow

2004-11-16  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* paragraph.C (isLetter): remove special spellchecker-related
	code; return true also for digits
	(isWord, isKomma): remove

	* text.C (cursorRightOneWord, cursorLeftOneWord, getWord):
	* lyxfind.C (MatchString()): use isLetter instead of isWord

2004-11-17  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* pariterator.h (operatir=): comment out un-implemented member
	function.

	* paragraph.h: resolve ambiguity found by gcc 4.0 with the use of a
	static cast.

2004-11-17  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxfont.h: include LColor.h to satisfy concept checks.

2004-11-16  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* pariterator.h: add typdefs for value_type, difference_type,
	pointer and reference to satisfy concept checks. Also add default
	constructor for same reason.

	* pariterator.C (operator++): add post-increment operator to
	satisfy concept checks.

	* lyxtextclasslist.h: include lyxtextclass.h to satisfy concept
	checks.

	* RowList_fwd.h: include lyxrow.h to satisfy concept checks.

	* ParagraphList_fwd.h: include paragraph.h to satisfy concept
	checks. Also rename base_type to BaseType to follow naming
	standard better.

	* FloatList.h: include Floating.h to satisfy concept checks.

2004-11-15  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (getStatus): when the origin of the request is menu or
	toolbar, and the LyXView does not have focus, do as if there was
	no buffer (bug 1720)

	* lyxfunc.C (getStatus, dispatch): propagate the origin of a
	FuncRequest to individual entries of LFUN_SEQUENCE

2004-11-10  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* output_latex.C (TeXOnePar): override runparams.moving_arg
	according to the needprotect value of the current paragraph (bug
	1739)

	* paragraph.C (simpleTeXOnePar): no need to override
	runparams.moving_args here

2004-11-14  John Spray  <spray_john@users.sourceforge.net>

	* vspace.C: fix off-by-one-error, related to fix #1682

2004-11-11  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* buffer.C: format up to 238.

2004-11-11  Edwin Leuven

	* LaTeXFeatures.C: add booktabs package
	* tabular.[Ch] (use_booktabs, setBookTabs, useBookTabs): new members,
	use them in several places

2004-11-11  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* lengthcommon.C: a more general fix for bug 1682

2004-11-11  Alfredo Braunstein  <abraunst@lyx.org>

	* text.C (backspace): fix crash

2004-11-09  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* format.[Ch] (getFormatFromFile): new method
	* exporter.C: s/getFormatFromContents/formats.getFormatFromFile/

2004-11-09  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lengthcommon.C (unitFromString): fix off-by-one error (bug 1682)

2004-11-05  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (dispatch): remove the verbose argument
	(sendDispatchMessage): ditto. Use the origin of the FuncRequest
	instead

	* kbmap.C (defkey): set the origin of func to KEYBOARD

	* MenuBackend.C (MenuItem):
	* ToolbarBackend.C (add): set the origin of func to UI

	* funcrequest.[Ch]: add origin member, which indicates which part
	of LyX requests an action

2004-11-07  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* converter.C (move): don't lie in the error message
	* converter.h (isReachable, move): document

2004-11-07  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* buffer.C: remove unused using lyx::support::atoi
	* paragraph_funcs.C: ditto

2004-11-06  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* bufferlist.C (exists): use bind and equal_to instead of
	compare_memfun
	(getBuffer): ditto
	* lyxtextclasslist.C (NumberOfClass): ditto

	* cursor.C (insert): use for_each instead of explicit for loop

	* bufferlist.C (getFileNames): use std::transform and
	std::back_inserter instead of std::copy and lyx::back_inserter_fun.

	* buffer_funcs.C (bufferErrors): use for_each instead of explicit
	for loop

	* buffer.C (changeLanguage): use for_each instead of explicit for
	loop
	(hasParWithID): implement using getParFromID

	* LaTeXFeatures.C: ws change only

	* CutAndPaste.C (replaceSelectionWithString): Use a temporary var
	to cleanup a bit.

	* BufferView_pimpl.C (trackChanges): use for_each instead of
	expilicit for loop

2004-11-04  André Pönitz  <poenitz@gmx.net>

	* undo.h:
	* undo.C (textUndoOrRedo): fix crash when creating undo information.

	* dociterator.C (asDocIterator): use hard assert again.

2004-11-04  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxlength.C (asLatexString): rewrite so that it does not use
	snprintf anymore

2004-11-02  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (specialChar, dispatch): make sure cursor moves to the
	right after inserting an inset

2004-11-02  José Matos  <jamatos@lyx.org>

	* output_docbook.C (docbook):
	* paragraph.C (getID):
	* sgml.[Ch] (openTag, cleanID): escape characters inside ids to
	garantee that the output is always legal.

	* tabular.C (docbook):
	* outputprams.[Ch]: remove mixed contents.

2004-11-01  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* text2.C (setCounter): prevent endless loop

2004-11-01  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* exporter.C (copyFile): use the mover instead of support::copy()
	* exporter.C (Export): pass format and latex name to copyFile()
	* exporter.h (addExternalFile): document
	* mover.[Ch] (do_copy, do_rename): new methods with 3 arguments

2004-10-31  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text.C (leftMargin): do not indent paragraphs in charstyle insets.

2004-10-30  José Matos  <jamatos@lyx.org>

	* paragraph.[Ch] (onlyText): Checks if the paragraph contains only
	text and no inset or font change. This allows to use CDATA
	sections just for the whole paragraph.

2004-10-30  José Matos  <jamatos@lyx.org>

	* paragraph.C (getFirstWord): remove unused variable.

2004-10-30  José Matos  <jamatos@lyx.org>

	* paragraph.C (getFirstWord): the content should always be escaped
	there.
	(simpleDocBookOnePar):
	* output_docbook.C (makeEnvironment): replace reference to CDATA
	to style pass_thru.

2004-10-30  José Matos  <jamatos@lyx.org>

	* paragraph.C (simpleDocBookOnePar): fix reference to CDATA.

2004-10-30  José Matos  <jamatos@lyx.org>

	* output_docbook.C (makeParagraphs):
	* paragraph.[Ch] (emptyTag): for docbook and company, if the
	standard paragraph has only a given type of content drop the wrapper.

2004-10-29  José Matos  <jamatos@lyx.org>

	* output_docbook.C (makeEnvironment):
	* sgml.C (openTag):
	* paragraph.[Ch] (getID): rename function, and return it enclosed in id="...".

2004-10-29 Andreas Vox  <vox@isp.uni-luebeck.de>

	* sgml.[Ch] (uniqueID): returns a unique id for a given label.
	(cleanID): sanitize any id.

2004-10-29  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* buffer.C, lyxlex_pimpl.C:
	* lyxlex_pimpl.C (setFile):
	s/getExtFromContents/getFormatFromContents/

2004-10-28  José Matos  <jamatos@lyx.org>

	* output_docbook.C (makeEnvironment): move id to broadest possible
	scope.

	* sgml.C (openTag): apply substitution of <> for all attributes.

2004-10-28  José Matos  <jamatos@lyx.org>

	* buffer.C (makeLinuxDocFile, makeDocBookFile):
	* output_docbook.C (makeParagraph, makeEnvironment, makeCommand):
	* output_linuxdoc.C (linuxdocParagraphs): use new openTag and closeTag.

	* sgml.[Ch]: new version for open and closeTag for paragraph and
	for strings. Now they handle the ids of paragraphs.

2004-10-26  Angus Leeming  <leeming@lyx.org>

	* Makefile.am: add mover.[Ch].

	* converter.C (convert, move): use the new Movers to move external
	files to the temp directory.

	* lyx_main.C (init): ensure that the global system_movers data
	is initialised.

	* lyxrc.[Ch]: code to read and write 'copiers' from/to the
	preferences file.

	* mover.[Ch]: new files, defining a Mover as a utility to move an
	external file between directories and, if necessary, manipulate this
	file using a helper script.

2004-10-25  José Matos  <jamatos@lyx.org>

	* output_docbook.C (makeCommand): merge two if's that tested the
	same condition.

2004-10-25  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* sgml.C (escapeString): fix warning in a better way

2004-10-25  José Matos  <jamatos@lyx.org>

	* sgml.C (escapeString): import the require boosts header file for
	tie, and avoid a signed unsigned comparison.

2004-10-25  José Matos  <jamatos@lyx.org>

	* sgml.h: add #include <string>

2004-10-25  José Matos  <jamatos@lyx.org>

	* sgml.[Ch] (escapeString): new function to escape all the string.

2004-10-24  José Matos  <jamatos@lyx.org>

	* paragraph.[Ch] (getFirstWord): new function to get the first
	word. Useful for description.
	(simpleDocBookOnePar): remove depth argument, add another that
	says where to start the paragraph.

	* output_docbook.C (makeParagraph, makeEnvironment, makeCommand):
	use the new functions to fix cleanly the support for descriptions.

2004-10-24  José Matos  <jamatos@lyx.org>

	* buffer.C (makeLinuxDocFile, makeDocBookFile):
	* output_docbook.C (makeParagraph, makeEnvironment, makeCommand):
	* output_linuxdoc.C (linuxdocParagraphs):
	* sgml.[Ch] (openTag): )move paragraph counting code to openTag, and
	add buffer as argument.

2004-10-24  José Matos  <jamatos@lyx.org>

	* output_docbook.C (makeEnvironment, searchEnvironment): place
	CDATA inside paragraphs and fix scope for listitems.

2004-10-24  José Matos  <jamatos@lyx.org>

	* output_docbook.C: remove using statement for stack.

2004-10-23  José Matos  <jamatos@lyx.org>

	* buffer.C (makeDocBookFile): reorganize the comments about lyx.
	* output_docbook.[Ch]: new functions to encapsulate the way lyx exports
	docbook. The new scheme is recursive and makes use of iterators, the
	same as latex export works.
	* paragraph.C (simpleDocBookOnePar): removed coud that does not deal
	directly with the paragraph contents. This code was moved up to
	output_docbook.C (docbookParagraphs).
	* sgml.C (openTag, closeTag): removed unneeded newlines.
	(closeEnvTags) removed.

2004-10-23  André Pönitz  <poenitz@gmx.net>

	* undo.C (textUndoOrRedo):
	* dociterator.C (asDocIterator): work around crash

	* cursor.C (getStatus): replace ASSERT by more verbose error message
	  and manual correction of the problem. Should increase stability
	  while providing more sensible information.

2004-10-18  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (getStatus,dispatch): handle LFUN_(PREVIOUS|NEXT)BUFFER

	* bufferlist.C (previous, next): new methods

	* lfuns.h:
	* LyXAction.C (init): add LFUN_NEXTBUFFER and LFUN_PREVIOUSBUFFER

2004-10-18  Andreas Vox  <vox@isp.uni-luebeck.de>

	* buffer.C (makeDocBookFile): add dsssl stylesheet control
	entities to preamble.

2004-10-18  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* messages.C (Pimpl): strip off translation context information

2004-10-14  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView_pimpl.C (setBuffer): when closing a buffer, make sure
	the cursor is correct (bug 1694)

2004-10-13  José Matos  <jamatos@lyx.org>

	* output_docbook.C (docbookParagraphs): fix closing tags in the
	end of the document.

2004-10-09  José Matos  <jamatos@lyx.org>

	* buffer.C: format up to 237.
	* bufferparams.C (write): use tostr to convert booleans to strings.

2004-10-08  Martin Vermeer  <martin.vermeer@hut.fi>

	* lyxrc.C: add to tooltip about using xindy to prefs (xforms)

2004-10-07  Martin Vermeer  <martin.vermeer@hut.fi>

	* LaTeX.C: implement use of babel language in xindy.

2004-10-05  José Matos  <jamatos@lyx.org>

	* bufferparams.[Ch] (readBullets, readBulletsLaTeX): new methods.
	Add new translators to help reading and writing the lyx file.

2004-10-05  José Matos  <jamatos@lyx.org>

	* ParagraphParameters.C (read):
	* text.C (readParToken): replace nexToken by more appropriate lex
	methods.

2004-10-05  Hartmut Haase  <hha4491@atomstromfrei.de>

	* LaTeX.C (runMakeIndex):
	* lyxrc.[Ch] (read, write, getDescription): make the indexing command
	(usually 'makeindex') configurable.

	* lastfiles.h (maxlastfiles): define the maximum number of 'lastfiles'
	with a variable rather than with a number.

2004-09-27  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* output_latex.C (TeXOnePar): make sure font setting is the first
	thing that gets output (and the last at the end). Should fix bug
	1404.

2004-09-26  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* pch.h: use proper signal include

	* LaTeX.h: Use preferred calling of Boost.Signal
	* buffer.h: ditto

2004-09-26  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* pch.h: dont include <boost/function/function0.hpp>

	* Makefile.am (lyx_SOURCES): remove ShareContainer.h

	* paragraph_pimpl.h: remove usage of ShareContainer

	* paragraph_pimpl.C: remove initialization of ShareContainer.

2004-09-16  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	Fix bug #1666

	* BufferView.C (putSelectionAt): change the semantics when
	backwards == true: now, this just swaps cursor and anchor wrt the
	forward case

	* BufferView.h (putSelectionAt): add some documentation

	* lyxfind.C (findBackwards): rewrite using while(). In particular,
	make sure backwardChar is done at least once (to avoid getting
	stuck)
	(findNextChange): use putSelectionAt in the forward direction
	(operator()): use Paragraph::isWord

2004-09-16  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* Spacing.C (set): c_str fix

2004-09-09  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyx_cb.C (Reconfigure): quote the name of configure script in
	case it contains spaces

2004-09-04  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* client: new dir

	* Makefile.am (SUBDIRS): change order of subdirs and add client dir
	(BOOST_LIBS): use top_buildir when looking for the file

2004-08-30  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* pch.h: do not use include boost/format.hpp, multiple symbols
		will result (gcc bug)


2004-08-23  José Matos  <jamatos@lyx.org>

	* bufferparams.C (readToken): fix reading of the author field.

2004-08-20  José Matos  <jamatos@lyx.org>

	* lyxrc.C: remove support/translator.h inclusion since it is not used.

2004-08-20  José Matos  <jamatos@lyx.org>

	* lyxlex.[Ch] (findToken): remove function.

	* ParagraphParameters.C (findToken):
	* bufferparams.C (findToken): replace call for previous function
	with local copy. This local function has one more argument, the
	read string argument.

2004-08-16  José Matos  <jamatos@lyx.org>

	* ParagraphParameters.C (write):
	* Spacing.C (writeFile):
	* bufferparams.C (writeLaTeX):
	* lyx_cb.C (Reconfigure):
	* paragraph.C (write):
	* tabular.C (write): remove unnecessary space at end of line.


2004-08-16  José Matos  <jamatos@lyx.org>

	* text.C (readParagraph): remove debug message.

2004-08-16  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* tabular.C (asciiBottomHLine, asciiPrintCell, asciiTopHLine): fix
	crash

	* output_plaintext.C (asciiParagraph): set depth correctly

	* outputparams.h: add member depth

	* paragraph_funcs.C (ownerPar): remove.

	* text2.C (setCounter): remove first_pit; comment out some
	non-working code that uses ownerPar

	* BufferView.C (getParentLanguage): remove. Not used anymore, and
	uses ownerPar

2004-08-16  José Matos  <jamatos@lyx.org>

	* text.C (readParToken, readParagraph, read): report all unknown tokens.
	For the same level of importance use the same chanel to report problems.
	(read): add code to deal with \begin_body and \end_body.


2004-08-15  José Matos  <jamatos@lyx.org>

	* lyxlex.C (getString): fix comment, buffer::readBody is now
	buffer:readDocument.

	* tex-strings.C (string_papersize): Default -> default,
	Custom -> custom, for consistency with other options.

2004-08-15  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* pch.h: new file

	* Makefile.am: support pch

2004-08-15  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text.C (readParToken): remove the static LyXFont variable and
	pass it as a parameter instead. This fixes a nasty bug where an
	inset will be inserted with a bad font in some situations
	(readParagraph): adapt

	* text2.C (setCounter): reduce number of calls to pars_[pit]

	* text.C (singleWidth): add an assert, fix a test

	* rowpainter.C (paintText): reduce number of calls to singleWidth

	* paragraph.C (isHfill):
	(isNewline): ws only

2004-08-14  André Pönitz  <poenitz@gmx.net>

	* text.C:
	* text2.C:
	* rowpainter.C:
	* lyxtext.h (several functions): use a Paragraph & argument
	instead of par_type

2004-08-15  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* metricsinfo.h: add a new field ltr_pos to PainterInfo

	* rowpainter.C (paintInset): initialize PainterInfo::ltr_pos

	* text.C (singleWidth): remove useless test

2004-08-14  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* tabular.h: remove bogus comments

	* tabular.C (getDescentOfRow):
	(isPartOfMultiColumn): add assertions

	* lyxlength.C (inPixels): remove #warning

2004-08-14  André Pönitz  <poenitz@gmx.net>

	* paragraph.h: inline getChar()

	* BufferView.h: remove unused declarations

2004-08-14  José Matos  <jamatos@lyx.org>

	* Buffer.[Ch] (readDocument): new name for old readBody.
	* Buffer.C: new file format, new keywords: \begin_document,
	\begin_header, \begin_body, \end_body.

	* bufferparams.C (readToken): replace all calls to lex.nextToken
	by lex.next(). Do the same to eatLine except where really needed.

	* lyxfont.C (lyxWriteChanges): remove whitespaces in the end of
	line when writing to the lyx file.

	* output_plaintext.C (asciiParagraph): fix Bibliography style
	handling.

	* text.C (read): fix end of file handling.

2004-08-14  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* MenuBackend.C (Menu::operator[]): new method to access
	individual menu items
	(Menu::hasFunc): new method. search for an item that corresponds
	to a given func
	(MenuBackend::specialMenu): new method
	(MenuBackend::expand): if a special menu has been set, skip
	entries whose func() appears in this menu

2004-08-14  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* text3.C: use Debug::DEBUG a bit more

	* text.C (leftMargin): try to simplify a tiny bit change var x to
	l_margin. Dont output the wide margins always.
	(rightMargin): no margin in inner texts

	* rowpainter.h (nestMargin): new func
	(changebarMargin): new func
	(rightMargin): new func

	* rowpainter.C (paintDepthBar): changebarMargin and nestMargin is
	now functions.
	(paintLast): ditto

	* factory.C (createInset): modify setDrawFrame

	* cursor.C: use Debug::DEBUG a bit more

2004-08-14  André Pönitz  <poenitz@gmx.net>

	* coordcache.[Ch]:
	* Makefile.am: new files to accomodate an 'external' (x,y)-position
	cache for all insets in (at least partially) visible (top-level)
	paragraphs.

	* BufferView_pimpl.C: reset external coord cache before every update.
	This means the coord cache only contains valid entries.

2004-08-14  Lars Gullik Bjønnes  <larsbj@lyx.org>

	bug 1096
	* BufferView_pimpl.C (getInsetByCode): move function out of class
	and change in to a template in anon namespace. Also fix to do what
	suits us better.

2004-08-13  Lars Gullik Bjønnes  <larsbj@lyx.org>

	bug 1305
	* paragraph_funcs.C (moveItem): use Paragraph::value_type instead
	of char
	(breakParagraph): rename par to par_offset and use a local
	reference. Add code to keep the language over a rebreak.
	(breakParagraphConservative): rename par to par_offset, use a
	local reference
	(mergeParagraph): ditto
	(outerHook): ditto
	(isFirstInSequence): ditto
	(outerFont): rename pit to par_offset

	* paragraph.C: ws change
	* paragraph.h: ditto
	* text3.C: ditto
	* text.C: ditto

2004-08-13  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* paragraph_pimpl.C (simpleTeXSpecialChars): remove special
	treatment for ']'

	* paragraph.C (simpleTeXOnePar): when we have a \item with
	optional argument, enclose the argument with curly brackets (in
	case it contains a closing square bracket)

	* text2.C (editXY):
	* text2.C (editXY):
	* text3.C (checkInsetHit): constify

2004-08-13  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* LyXAction.C (init): mark LFUN_WORD_FIND as working in read-only
	documents (bug 1629)

2004-08-13  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	Fix toggling of collapsable insets with the mouse (bug 1558)

	* lyxfunc.C (dispatch): adapt to Cursor changes

	* BufferView_pimpl.C (workAreaDispatch): adapt to Cursor changes;
	make sure that dispatch is not invoked twice

	* cursor.C (needsUpdate): new method
	(dispatch): return void
	(result): new method, to access the DispatchResult of the cursor.

2004-08-13  José Matos  <jamatos@lyx.org>

	* tabular.C (docbook): close empty tags in XML. Fix bug 1147.

2004-08-13  André Pönitz  <poenitz@gmx.net>

	* cursor.C (macroModeClose): use plainInsert instead of niceInsert.

	* CutAndPaste.C (eraseSelection): fix cursor position after erasing
	  multiple cells

2004-08-12  André Pönitz  <poenitz@gmx.net>

	* text3.C: take out the 'cursor right' form insertInset and only
	do it in those places when it is really needed. Fixes crash on
	C-m...

2004-08-08  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (dispatch): implement LFUN_SAVE_AS_DEFAULT

	* BufferView_pimpl.C (setBuffer): initialize the current font of
	the underlying LyXText

2004-08-05  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* kbsequence.C (print): use UI native formatting for menu
	shortcuts

	* text.C (insertChar): call Paragraph::insertChar with a font
	argument (cosmetic)

	* paragraph.C (insertInset, insertChar): the version that takes a
	LyXFont argument is now a wrapper around the other one (the
	opposite used to be true).

	* paragraph_pimpl.C (insertInset, insertChar): remove the LyXFont
	argument. Font setting is done in Paragraph now.

2004-08-04  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* outputparams.h: add new members intitle and lang.

	* paragraph.C (simpleTeXOnePar): initialize rp.lang and
	rp.intitle. Actually use rp in call to simpleTeXSpecialChars

2004-08-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C (dispatch): remove special handling of button 4 and 5,
	it is now taken care of in the frontend code.

2004-07-25  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* Spacing.h: add <string> (STLPort compile fix)

2004-08-02  Juergen Spitzmueller  <j.spitzmueller@gmx.de>

	* LaTeXFeatures.C: (jurabib) \RequirePackage -> \usepackage

2004-07-25  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxlex_pimpl.C (compare_tags): chagne return type of operator()
	to bool.

	* converter.C (showMessage): inherit from unary_function, make
	operator() const.

	* buffer.C (writeFile): initialize retval

	* InsetList.h: rename private variable list to list_
	* InsetList.[Ch]: adjust accordingly.

2004-07-24  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C, text2.C, text.C, tabular.C, paragraph_funcs.C, paragraph.C:
	* lyxlength.C, lyxgluelength.C, lyxfunc.C, lyxfont.C, lyxfind.C:
	* kbmap.C, funcrequest.C, factory.C, cursor.C, counters.C:
	* bufferview_funcs.C, bufferparams.C, buffer.C, Spacing.C:
	* ParagraphParameters.C, LaTeXFeatures.C: replace
	"support/std_sstream.h" with <sstream>

2004-07-23  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxserver.C (startPipe): use this (pointer) not *this (reference)
	* lyxsocket.C (LyXServerSocket): ditto
	(serverCallback): ditto

2004-07-23  Juergen Spitzmueller  <j.spitzmueller@gmx.de>

	* LaTeXFeatures.C: check release date when loading jurabib.

2004-07-22  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxserver.C (startPipe): call register_socket_callback
	(endPipe): call unregister_socket_callback

2004-07-21  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxsocket.C (LyXServerSocket): reduce max outstanding clients to 3
	(LyXServerSocket): register the callback
	(LyXServerSocket): unregister the callback
	(fd): delete function
	(serverCallback): improve error checking and setup the callbacks.
	(dataCallback): change arg to fd.
	(writeln): new func (copied fro the client socket) used for server
	write to client.
	(LyXDataSocket): simplify
	(~LyXDataSocket): close ann unregiser callback
	(server): delete function
	(fd): delete function
	(readln): small changes, improve some std::string usage
	(writeln): constify a bit

2004-06-24  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* kbmap.C (find1keybinding): new method, only used by LyX/Mac with
	Qt frontend

2004-07-05  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView_pimpl.C (setBuffer): set the layout combox value only
	after it has been populated

2004-06-29  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text2.C (insertInset): move cursor when inserting inset.

2004-06-30  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* kbmap.C (findbindings): a couple of new methods. returns a
	container of kb_sequence objects. The real work is done by the
	private recursive version
	(printbindings): uses findbindings to print out a bracketed list
	of bindings (renamed from findbinding).

	* MenuBackend.C (binding): use kb_keymap::findbindings

	* lyxfunc.C (sendDispatchMessage): use use kb_keymap::printbindings.

2004-07-01  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* buffer.C: up LYX_FORMAT to 235 (needed for the paperpackage fix)

2004-06-29  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* paragraph.C (isWord): return true on insets that report
	isLetter().

	* text.C (getWord): use Paragraph::isWord to decide what is in a
	word and what is not; fix bug 1609.

2004-06-27  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* tex-strings.C: add "none" to string_paperpackages[], fixes
	off-by-one-error in the paperpackage selection.

	* lyxlex.[Ch]:
	* tex-strings.[Ch]: char const * string[n]
	-> char const * const string[]

2004-06-10  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (getStatus): if lyx_gui::getStatus disables the
	command, return early.

2004-06-18  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* debug.h: add DEBUG to enum and fix size of ANY.

	* debug.C: add support for Debug::DEBUG
	(showTags): cast errorTags.level to unsigned int

	* BufferView_pimpl.C (fitCursor): use Debug::DEBUG
	(redoCurrentBuffer): ditto
	(updateScrollbar): ditto
	* cursor.C (dispatch): ditto
	* text2.C (setLayout): ditto
	(setFont): ditto
	(updateCounters): ditto
	(editXY): ditto
	(deleteEmptyParagraphMechanism): ditto

2004-06-09  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* Makefile.am (dist_noinst_DATA): use the dist_ and noinst_
	annotations to cleanup the Makefile slightly.

2004-05-10  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxrc.C: do not set user_email to a default value but use empty
	instead. The entry used to be translated, which does not work
	since at the point where lyxrc is constructed there is no
	translation service available

	* messages.C (getLocaleDir): remove and use directly
	lyx_localedir() instead

2004-06-02  Angus Leeming  <leeming@lyx.org>

	Fix crash caused by dereferencing null pointer 'exportdata' in
	OutputParams by creating a new ExportData variable on the heap,
	storing it in a boost::shared_ptr.
	The crash was triggered when generating an Instant Preview
	of an external inset.

	* Makefile.am: add outputparams.C

	* outputparams.[Ch]: store exportdata as a shared_ptr<Exportdata>.
	(c-tor): allocate memory to it.

	* exporter.C (c-tor): associated changes.

2004-06-01  Angus Leeming  <leeming@lyx.org>

	* output_linuxdoc.C (linuxdocParagraphs): Check that the paragraph
	contains data before calling isInset(0). (Bug 1513.)

2004-06-01  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* exporter.C (checkOverwrite): new method
	* exporter.C (copyFile): new method
	* exporter.C (Export): copy referenced files to the document dir
	* exporter.[Ch]: new class ExportedFile
	* exporter.[Ch]: new class ExportData. Contains currently the
	names of referenced external files
	* outputparams.h: add exportdata member.

2004-05-28  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* Makefile.am (DISTCLEANFILES): add version.C, stamp-version and
	version.C-tmp

2004-05-19  Angus Leeming  <leeming@lyx.org>

	* LaTeXFeatures.C:
	* ToolbarBackend.C:
	* bufferparams.C:
	* lyxfunc.C: small changes due to the introduction of namespace
	lyx::frontend and the moving of namespace biblio to lyx::biblio.

2004-05-18  Alfredo Braunstein  <abraunst@lyx.org>

	* text3.C (dispatch): supress update when only moving the cursor
	* cursor.C (selHandle): remove commented code

2004-05-17  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* paragraph.C (startTeXParParams): correct column count
	* CutAndPaste.C (pasteSelection): remove const_cast
	* output_docbook.C (docbookParagraphs): remove const_cast
	* output_latex.C (TeXEnvironment, TeXOnePar, TeXDeeper): remove
	const_cast and return ParagraphList::const_iterator
	* output_linuxdoc.C (linuxdocParagraphs): remove const_cast
	* output_plaintext.C (writeFileAscii): remove const_cast
	* paragraph.[Ch] (simpleTeXOnePar): make const
	* paragraph_funcs.C (outerPar): use const iterators
	* paragraph_pimpl.C (validate): use const iterators
	* text.C (setHeightOfRow): use const iterators

2004-05-17  Angus Leeming  <leeming@lyx.org>

	* lfuns.h:
	* LyXAction.C (init): new LFUN_INSET_REFRESH.

	* lyxfunc.C (dispatch): in the LFUN_BUFFERPARAMS_APPLY block loop
	over all insets and dispatch LFUN_INSET_REFRESH to any citation insets
	if the citation engine has changed.

2004-05-14  José Matos  <jamatos@lyx.org>

	* buffer.C (makeDocBookFile): add a default Formal Public Identifier
	if the textclass does not provide it. Have it different for sgml and
	xml.
	support the language of document.
	* output_docbook.C (docbookParagraphs):
	* paragraph.[Ch] (getDocbookId): new function that gets the id of the
	first anchor as the id of the paragraph, remove special case code.
	* sgml.C (escapeChar): escape only < & >.

2004-05-14  Angus Leeming  <leeming@lyx.org>

	* bufferparams.h: move biblio::CiteEngine enum here to minimize
	dependencies on src/frontends/controllers/biblio.h. Define a
	CiteEngine_enum wrapper class to enable the enum to be forward
	declared.

2004-05-12  Angus Leeming  <leeming@lyx.org>

	* buffer.C: up LYX_FORMAT to 234.
	* bufferparams.[Ch]: replace the three bools, use_natbib, use_jurabib,
	use_numerical_citations with a single biblio::CiteEngine cite_engine
	variable.
	* LaTeXFeatures.C (getPackages): use BufferParams::cite_engine.

2004-05-13  José Matos  <jamatos@lyx.org>

	* converter.h:
	* converter.C (Converter, readFlags): add xml member.
	* outputparams.h: add XML flavor.
	* buffer.C (makeDocBookFile): add support for the sgml/xml distinction.

2004-05-03  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (dispatch):
	(getStatus): fix handling of LFUN_SEQUENCE

2004-04-29  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* debug.C (showLevel): do not forget the end-of-line marker

2004-04-27  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* kbmap.C (read): do not stop parsing a bind file when an error
	occurs (bug 1575)

2004-04-29  Angus Leeming  <leeming@lyx.org>

	* cursor.C:
	* factory.C:
	* pariterator.C:
	* text2.C: wrap a bunch of #warning statements
	inside #ifdef WITH_WARNINGS blocks.

2004-04-29  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* buffer.C: increment format to 233.

2004-04-28  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C:
	* lyxfunc.C:
	* text3.C:
	s/updateToolbar()/updateToolbars()/
	s/Toolbar.h/Toolbars.h/

2004-04-28  Angus Leeming  <leeming@lyx.org>

	* BufferView.[Ch] (c-tor):
	* BufferView_pimpl.[Ch] (c-tor): no longer receives x,y position.
	No longer passes these data to the WorkArea generator.

2004-04-28  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (c-tor): pass LyXView & to WorkArea generator.

2004-04-26  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* LaTeXFeatures.C, lyx_sty.[Ch]: add \lyxdot macro

2003-09-24  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* output_latex.C (TeXEnvironment): make sure that there is a line
	break before \end{foo} for the last paragraph of a document
	(TeXOnePar): if the paragraph is at the end of the document (or
	inset) and the language has to be reset, then make sure that the
	line break is _before_ the language command, not after (fixes bug
	1225); also make sure that the language reset command is the first
	thing after the paragraph (to ensure proper nesting of
	environments and thus fix bug 1404)

2004-04-21  John Levon  <levon@movementarian.org>

	* ToolbarBackend.h:
	* ToolbarBackend.C: make "name" be a programmatic name
	and a gui_name field.

	* lyxfunc.C: display the minibuffer on M-x

2004-04-18  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* LaTeX.C (runMakeIndex, runBibTeX): quote correctly file name
	(bug 1526)

2004-04-19  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (setBuffer): changed preview interface.

	* lyxrc.[Ch] (preview): no longer a bool. Now an enum with three
	possible values.

2004-04-19  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C:
	* text3.C: fix bug 1569 (insert->label doesn't give suggestion)

2004-04-05  Angus Leeming  <leeming@lyx.org>

	* text.C (redoParagraphs): add call to updateCounters(), thereby
	fixing the missing "Figure #:" label from the caption of a
	figure float.

2004-04-13  Angus Leeming  <leeming@lyx.org>

	* text3.C (dispatch): call Inset::.notifyCursorLeaves when the
	cursor is clicked out of an inset.

2004-04-13  Angus Leeming  <leeming@lyx.org>

	* lyx_main.[Ch] (updateInset): pass it an InsetBase pointer rather
	than an InsetOld one.

2004-04-12  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* format.[Ch]: add editor to Format
	* lyxrc.[Ch]: merge RC_FORMAT and RC_VIEWER. Add editor to Format
	* LyXAction.C, lfuns.h, lyxfunc.C: add lfun LFUN_GRAPHICS_EDIT

2004-04-08  André Pönitz  <poenitz@gmx.net>

	* metricsinfo.h: remove PainterInfo::width member

2004-04-08  Angus Leeming  <leeming@lyx.org>

	* lyx_sty.C (boldsymbol_def): modify so that it outputs
	"\providecommand" rather than "\newcommand", thereby preventing
	clashes with packages that define "\boldsymbol" themselves.
	Eg, beamer.

2004-04-08  Angus Leeming  <leeming@lyx.org>

	* lyxrc.C (read): don't try to set the color of none, inherit, ignore
	thereby squashing an unnecessary warning.

2004-04-01  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* LaTeXFeatures.[Ch]: change buffer_ to a pointer and add accessor
	setBuffer()

2004-04-07  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView.C (setCursor): call redoParagraph (some insets could
	have been opened)
	(putSelectionAt): remove the 'double update' trick

	* BufferView_pimpl.C (fitCursor): call refreshPar
	(workAreaDispatch): remove an uneeded update call
	(dispatch): remove some manual update calls

	* cursor.[Ch]: remove cached_y_, updatePos
	(selHandle): set noUpdate when appropriate

	* lyxfunc.C (dispatch): track if we need an update

	* metricsinfo.[Ch]: PainterInfo receive a Painter & on construction

	* rowpainter.[Ch] (RowPainter): remove superfluous xo_ parameter
	(paintSelection): cheap optimization, do not call cursorX when not
	needed
	(paintPars): change signature
	(refreshPar): add
	(paintText): adjust
	(paintTextInset): adjust

	* text.C: adjust

2004-04-05  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lengthcommon.C: compilation fix: remove explicit array size from
	unit_name[] and friends

2004-04-05  Angus Leeming  <leeming@lyx.org>

	* LyXAction.C (init): set LFUN_DIALOG_UPDATE's atrib flag to NoBuffer.

	* lyxfunc.C (getStatus): enable LFUN_DIALOG_UPDATE if no buffer is
	present only for the preferences dialog.
	(dispatch): handle LFUN_DIALOG_UPDATE for the preferences dialog.

2004-04-05  Angus Leeming  <leeming@lyx.org>

	* lyxrc.[Ch] (write): now takes a 'bool ignore_system_lyxrc' arg
	to enable the frontends to export changes to lyxrc correctly.

	* lyxfunc.C (dispatch): output lyxrc.write("preferences", false).

2004-04-07  André Pönitz  <poenitz@gmx.net>

	* cursor.[Ch] (selClear, adjust): remove math

	* cursor_slice.C: more agressive assert

	* lyxfunc.C:
	* BufferView_pimpl.C: rework mouse event dispatch

	* dociterator.C:
	* paragraph.C:
	* text2.C:
	* text3.C: adjust

2004-04-05  André Pönitz  <poenitz@gmx.net>

	* cursor.[Ch] (valign, halign...): remove unneeded functions

2004-04-05  Angus Leeming  <leeming@lyx.org>

	* lyxlength.[Ch] (unit_name et al.): const-correct.

2004-04-05  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C:
	* buffer.C:
	* counters.C:
	* cursor.C:
	* lyxfunc.C
	* paragraph.C:
	* pariterator.C:
	* text.C:
	* text2.C:
	* text3.C: wrap #warning calls inside #ifdef WITH_WARNINGS blocks.

2004-04-01  Alfredo Braunstein  <abraunst@lyx.org>

	* text3.C (getStatus): add LFUN_BEGINNINGBUF

2004-04-01  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxfind.C: add a couple of inTexted() tests + other small fixes
	* BufferView_pimpl.[Ch] (getStatus)
	* BufferView.[Ch] (getStatus): add
	* lyxfunc.C (getStatus): move lfuns handled in
	BufferView::dispatch to te function above
	* Cursor.C (setSelection): set selection() = true

2004-04-01  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxfunc.C (getStatus): enable LFUN_WORD_{FIND,REPLACE}

2004-03-31  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): Fall through to the generic
	Dialogs::show("preamble").

2004-03-31  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): Fall through to the generic
	Dialogs::show("spellchecker").

2004-03-31  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (getStatus, dispatch): changed invocation of the
	preferences dialog.

2004-03-31  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView.C
	* cursor.[Ch]
	* dociterator.[Ch]:
	* insetiterator.[Ch]:
	* lyxfind.C:
	* lyxfunc.C:
	* pariterator.[Ch]:
	* text2.C:
	* undo.[Ch]: s/DocumentIterator/DocIterator/g

2004-03-31  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView.C (setCursor, putSelectionAt): call edit to open the
	insets where we are putting the cursor.

2004-03-31  Angus Leeming  <leeming@lyx.org>

	* lfuns.h:
	* LyXAction.C: new lfun LFUN_LYXRC_APPLY.

	* lyxrc.[Ch] (read, write): overloaded member functions taking
	a std::[io]stream arguments.

	* lyxfunc.C (getStatus, dispatch): handle LFUN_LYXRC_APPLY.

2004-03-31  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (loadTextclass): new helper function, invoked by two of
	dispatch's case blocks, LFUN_TEXTCLASS_APPLY and LFUN_TEXTCLASS_LOAD.

	* lyxtextclass.C (load): if the text class couldn't be loaded, then
	don't overwrite 'loaded_ = false' with 'loaded_ = true' !

2004-03-31  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): remove the cursor-manipulation code from
	the LFUN_ALL_INSETS_TOGGLE code.

2004-03-30  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): the specialization Dialogs::showDocument
	has died. Fall through to the generic Dialogs::show("document").

2004-03-30  Angus Leeming  <leeming@lyx.org>

	* lfuns.h:
	* LyXAction.C: new lfuns LFUN_LANGUAGE_BUFFER, LFUN_TEXTCLASS_APPLY,
	LFUN_TEXTCLASS_LOAD, LFUN_SAVE_AS_DEFAULT, LFUN_BUFFERPARAMS_APPLY.

	* lyxfunc.C (getStatus, dispatch): define the actions for these
	lfuns. Little more than a cut and pste job from ControlDocument.C

	* lyxtextclass.[Ch] (loaded): accessor for the private bool loaded_.

2004-03-30  Angus Leeming  <leeming@lyx.org>

	* lfuns.h:
	* LyXAction.C (init): new lfuns, LFUN_KEYMAP_TOGGLE,
	LFUN_NEXT_INSET_TOGGLE, LFUN_ALL_INSETS_TOGGLE.

	* lyxfunc.C (dispatch): LFUN_ALL_INSETS_TOGGLE is used to toggle the
	open/closed state of ollapsable insets. Usage:

	all-inset-toggle <state> <name>, where
	<state> == "open" || "closed" || "toggle" and
	<name> is an identifier for a 'type' of inset. Eg "branch", "ert",...

	* lyxtext.h, text2.C (toggleInset): removed.

	* text3.C (dispatch): split the existing LFUN_INSET_TOGGLE in two,
	LFUN_KEYMAP_TOGGLE and LFUN_NEXT_INSET_TOGGLE. LFUN_NEXT_INSET_TOGGLE
	now passes LFUN_INSET_TOGGLE to the found inset.

	* InsetList.[Ch] (insetsOpenCloseBranch): removed. Functionality
	is now invoked as "all-insets-toggle toggle branch".

2004-03-30  Angus Leeming  <leeming@lyx.org>

	* dociterator.C:
	* insetiterator.C:
	* pariterator.[Ch]: added/corrected header blurb.

2004-03-30  Alfredo Braunstein  <abraunst@lyx.org>

	* dociterator.[Ch]: add an inset_ member
	(backwardPos): implemented
	(backwardPos, forwardPos): use inset_ when the stack is empty.
	(doc_iterator_begin, doc_iterator_end): implemented
	* pariterator.[Ch]: adjust, add begin, end
	* insetiterator.[Ch]: adjust, add begin, end
	* cursor.C:
	* document.C:
	* BufferView.C:
	* BufferView_pimpl.C:
	* CutAndPaste.C: adjust

2004-03-29  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* buffer.C: increment file format to 232.
	* LaTeXFeatures.C: add bibtopic package.
	* bufferparams.[Ch]: param \use_bibtopic.

	* lyxrc.[Ch]: add lyxrc bibtex_command
	* LaTeX.C: use rc.bibtex_command instead of hardcoded string.

	* buffer.C: increment file format to 231.

2004-03-28  Alfredo Braunstein  <abraunst@lyx.org>

	* dociterator.C: implement forwardPar
	* iterators.[Ch]: remove, replaced by
	* pariterator.[Ch]: this. derive ParIterator from DocumentIterator
	* BufferView.C:
	* BufferView_pimpl.C:
	* CutAndPaste.C:
	* buffer.C:
	* bufferview_funcs.C:
	* cursor.C:
	* lyxfind.C
	* lyxfunc.C
	* paragraph_funcs.C
	* toc.C:
	* Makefile.am: adjust

2004-03-28  Alfredo Braunstein  <abraunst@lyx.org>

	* CutAndPaste.C (pasteSelection): fix 2 crashes
	(eraseSelection): fix a crash
	* paragraph_funcs.C: remove a warning

2004-03-28  Angus Leeming  <leeming@lyx.org>

	* lfuns.h:
	* LyXAction.C (init): new LFUN_PRINT.

	* lyxfunc.C (getStatus, dispatch): handle LFUN_PRINT.

2004-03-27  Angus Leeming  <leeming@lyx.org>

	* lfuns.h:
	* LyXAction.C (init): new LFUN_EXPORT_CUSTOM.

	* lyxfunc.C (getStatus, dispatch): handle LFUN_EXPORT_CUSTOM.

2004-03-27  Angus Leeming  <leeming@lyx.org>

	* paragraph_funcs.C (moveItem): fix memory leaks, ensure that
	insetlist always contains non-null pointers to insets.

2004-03-26  Angus Leeming  <leeming@lyx.org>

	* src/BufferView_pimpl.C:
	* src/CutAndPaste.C:
	* src/buffer.C:
	* src/iterators.C:
	* src/output_plaintext.C:
	* src/outputparams.h:
	* src/paragraph_funcs.C:
	* src/rowpainter.C:
	* src/text.C:
	* src/text2.C:
	* src/frontends/controllers/ControlErrorList.C:
	* src/frontends/gtk/FileDialogPrivate.C:
	* src/frontends/gtk/GPainter.C:
	* src/frontends/gtk/GToolbar.C:
	* src/frontends/qt2/QRef.C:
	* src/mathed/math_scriptinset.C: squash compiler warnings.

2004-03-26  Angus Leeming  <leeming@lyx.org>

	* ispell.C (LaunchIspell::start):
	* lyx_cb.C (AutoSaveBuffer::start):
	invoke run(DontWait) rather than runNonBlocking().

2004-03-26  Alfredo Braunstein  <abraunst@lyx.org>

	* buffer_funcs.C (readFile): add cancel button to two prompt dialogs

2004-03-26  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* kbsequence.C (print): adjust

	* kbmap.C (printKeySym): rename and change signature
	(printKey): use LyXKeySym::print()

2004-03-26  Martin Vermeer  <martin.vermeer@hut.fi>

	* undo.C: add using std::advance to compile for stlport

2004-03-24  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): remove test code in LFUN_QUIT handler as
	it leads to a crash when no buffer is present.

2004-03-25  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>
            Martin Vermeer  <martin.vermeer@hut.fi>

	* lyxfunc.C (dispatch):
	* bufferparams.C (readToken): use the new LColor::setColor

	* LColor.[Ch] (setColor): new version that takes two strings as
	argument and creates a new color entry if necessary

2003-02-12  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* buffer.C (makeLaTeXFile): if the main latex file that is
	processed is usually a subdocument of some master, then pretend
	for a while that it is actually the master

2003-02-10  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* buffer.C (getLabelList):
	(getBibkeyList): use getMasterBuffer()
	(getMasterBuffer): new method. Returns the main document in the
	case where one is using included documents.

2004-03-25  André Pönitz  <poenitz@gmx.net>

	* Makefile.am:
	* iterators.[Ch]:
	* PosIterator.[Ch]: drop PosIterator, replaced by DocumentIterator

	* ParagraphList_fwd.h: change ParagraphList to a std::vector

	* CutAndPaste.[Ch]: simpler interface by moving some stuff from
	text*.C over here. Rename namespace CutAndPaste to lyx::cap

	* ParameterStruct.h: merge with ParagraphParameters

	* lyxtext.h: remove LyXText::parOffset() and getPar()

	* text3.C: Remove all 'manual' update calls. We do now one per user
	interaction which is completely sufficient.

	* Bidi.C:
	* BufferView.[Ch]:
	* BufferView_pimpl.C:
	* FontIterator.[Ch]:
	* MenuBackend.C:
	* ParagraphParameters.[Ch]:
	* buffer.C:
	* buffer.h:
	* bufferlist.C:
	* cursor.[Ch]:
	* cursor_slice.[Ch]:
	* dociterator.[Ch]:
	* errorlist.[Ch]:
	* factory.C:
	* lfuns.h:
	* lyxfind.C:
	* lyxfunc.C:
	* output_docbook.[Ch]:
	* output_latex.[Ch]:
	* output_linuxdoc.[Ch]:
	* output_plaintext.[Ch]:
	* paragraph.[Ch]:
	* paragraph_funcs.[Ch]:
	* paragraph_pimpl.[Ch]:
	* rowpainter.C:
	* tabular.[Ch]:
	* text.C:
	* text2.C:
	* toc.C:
	* undo.[Ch]: adjust

	* frontends/controllers/ControlDocument.C:
	* frontends/controllers/ControlErrorList.C:
	* frontends/controllers/ControlSpellchecker.C:
	* insets/inset.C:
	* insets/inset.h:
	* insets/insetbase.h:
	* insets/insetbibitem.C:
	* insets/insetbox.C:
	* insets/insetbranch.C:
	* insets/insetcaption.C:
	* insets/insetcharstyle.C:
	* insets/insetcharstyle.h:
	* insets/insetcollapsable.C:
	* insets/insetcollapsable.h:
	* insets/insetert.C:
	* insets/insetfloat.C:
	* insets/insetfoot.C:
	* insets/insetmarginal.C:
	* insets/insetnote.C:
	* insets/insetoptarg.C:
	* insets/insettabular.C:
	* insets/insettext.C:
	* insets/insettext.h:
	* insets/insetwrap.C:
	* mathed/math_mboxinset.C:
	* mathed/math_nestinset.C:
	* mathed/math_scriptinset.C:
	* mathed/math_scriptinset.h:
	* support/types.h:

2004-03-24  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (cursorToggle): use the cursor toggle to
	deal with any child processes that have finished but are waiting to
	communicate this fact to the rest of LyX.

2004-03-24  Angus Leeming  <leeming@lyx.org>

	64-bit compile fixes.

	* errorlist.[Ch] (pos_start, pos_end): store as lyx::pos_type.
	(c-tor): pass lyx::pos_types rather than ints.

	* paragraph.[Ch] (beginOfBody, begin_of_body_): return, store as
	lyx::pos_type.

	* text.C (Delete): compile fix.
	(getPar): ensure that function declaration is the same as that in
	the header file.

2004-03-23  Angus Leeming  <leeming@lyx.org>

	* ispell.C (LaunchIspell):
	* lyx_cb.C (AutoSaveBuffer): change the signature of clone to return
	a boost::shred_ptr rather than a std::auto_ptr.

2004-03-22  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (getStatus): handle read-only buffers correctly;
	handle LFUN_FILE_INSERT_*

	* lyxrc.C (setDefaults, getDescription, output, read):
	* lyxrc.h: remove ps_command

2004-03-22  Angus Leeming  <leeming@lyx.org>

	* lyx_main.C (error_handler, init): remove handler for SIGPIPE.
	Ensure that error_handler is processed once only and that all data
	is saved before attempting to output any warning messages.

	* cursor.[Ch] (nopos_, noPos): remove unused member variable/function.

2004-03-21  Alfredo Braunstein  <abraunst@lyx.org>

	* tabular.C (TeXRow): crash fix (from Kayvan and Andrï¿½

2004-03-19  André Pönitz  <poenitz@gmx.net>

	* cursor.[Ch] (reset): take main text inset as argument

	* BufferView: adjust
	* BufferView_pimpl.C: adjust

	* paragraph.[Ch]: fix completely broken operator=()

2004-03-16  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* LColor.C (getFromLyXName): make sure that the color name is used
	as lowercase.

2004-03-17  Angus Leeming  <leeming@lyx.org>

	* lfuns.h:
	* LyXAction.C (init): remove LFUN_FORKS_KILL.

	* lyxfunc.C (getStatus, dispatch) remove lfuns to show the forks
	dialog and to kill a forked process.

2004-03-17  Alfredo Braunstein  <abraunst@lyx.org>

	* text2.C (setCursorFromCoordinates): fix font problem

2004-03-17  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView_pimpl.C (resizeCurrentBuffer): remove unneeded and
	bogus "rebuild cursor" code

2004-03-11  André Pönitz  <poenitz@gmx.net>

	* buffer.[Ch]: use InsetText instead of LyXText as container for
	the main lyx text.

	* dociterator.[Ch]: drop the BufferView * member which is not needed
	anymore after the change to buffer.C

	* paragraph_funcs.C:
	* text.C:
	* text2.C:
	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]:
	* cursor.[Ch]:
	* cursor_slice.[Ch]: adjust

	* text3.C: fix bug in mathDispatch

2004-03-08  André Pönitz  <poenitz@gmx.net>

	* undo.[Ch]: use 'StableDocumentIterator' as base for
	the Undo struct.

2004-03-07  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* LaTeXFeatures.C:
	* bufferparams.[Ch]: add jurabib support and param.

	* LaTeX.C: add FIXME/comment.

2004-03-05  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* buffer.C: increment file format to 230.

2004-03-04  Alfredo Braunstein  <abraunst@lyx.org>

	* cursor.C (dispatch): avoid infinite loops

2004-03-01  Alfredo Braunstein  <abraunst@lyx.org>

	* rowpainter.C (paintSelection): fix x coordinates

2004-03-01  Alfredo Braunstein  <abraunst@lyx.org>

	* text.C (rowBreakPoint): fix breaking before displayed insets

2004-03-01  André Pönitz  <poenitz@gmx.net>

	* dociterator.[Ch]: new class for the 'iterator part' of Cursor.

	* cursor.[Ch]: adjust, additioally: remove the 'current_' machinery

	* Makefile.am:
	* BufferView.C:
	* BufferView_pimpl.C:
	* buffer.C:
	* lyxfind.C:
	* lyxfunc.C:
	* text.C:
	* text2.C:
	* text3.C: adjust

2004-03-01  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxtext.h:
	* text.C:
	* text2.C:
	* rowpainter.C:
	* BufferView_pimpl.C: rename textwidth -> maxwidth,
	prepareToPrint -> computeRowMetrics and remove textWidth accessor.

2004-03-01  Alfredo Braunstein  <abraunst@lyx.org>

	* Bidi.[Ch] (computeTables): const correctness
	* lyxrow.[Ch]: add RowMetrics class, move there fill_separator,
	fill_hfill, fill_label_hfill and x from Row
	* lyxtext.h: prepareToPrint returns a RowMetrics
	* rowPainter.C: adjust
	* text.C (prepareToPrint): use width, not textWidth. adjust
	(redoParagraphInternal, cursorX): adjust
	* text2.C (getColumnNearX): adjust
	(init): put a default value to the top LyXText::width

2004-03-01  Alfredo Braunstein  <abraunst@lyx.org>

	* FontIterator.[Ch]: move FontIterator from lyxtext.h/text.C to here

2004-03-01  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxtext.h: add FontIterator class

	* text.C (FontIterator, operator*, operator->, operator++): add
	(rowBreakPoint, setRowWidth): adjust (fixing a
	rebreaking bug)

2004-02-25  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView_pimpl.C (workAreaDispatch): allow also
	LFUN_FILE_OPEN, which is used by the drag-and-drop code.

2004-02-27  Alfredo Braunstein  <abraunst@lyx.org>

	* text.C (rowBreakPoint): fix a bug showing with very large insets

2004-02-25  André Pönitz  <poenitz@gmx.net>

	* text3.C:
	* cursor.[Ch]: move some mathed specific code to mathed

2004-02-21  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* lyxrc.C, buffer.C, exporter.C: use always a temp dir, ignore
	use_tempdir in preferences
	* buffer.C (readFile), lyxvc.C (getLogFile): check success of
	tempfile creation
	* lyx_main.C: ensure that tempdir is valid
	* lyxlex.h: correct typo
	* buffer.[Ch] (isMultiLingual), (isUnnamed): make const
	* paragraph.[Ch] (isMultiLingual): make const
	* cursor.[Ch] (openable): make const

2004-02-20  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* text3.C: fixed LFUN_QUOTE and add lfun arguments single/double.

2004-02-20  André Pönitz  <poenitz@gmx.net>

	* dispatchresult.h: rename 'FINISHED' to 'FINISHED_LEFT'

	* cursor.[Ch]: prepare for localized getStatus()

	* lyxtext.h:
	* tabular.C:
	* text.C:
	* text2.C:
	* text3.C:  streamlines the LyXText cursor movement handlers a bit.

2004-02-20  André Pönitz  <poenitz@gmx.net>

	* lyxfunc.[Ch]: rename view_status_message() to viewStatusMessage()

2004-02-16  Alfredo Braunstein  <abraunst@lyx.org>

	* text2.C (setCursorFromCoordinates): switch to absolute coords
	(cursorUp): adjust
	(cursorDown): adjust
	* text3.C (dispatch): adjust

2004-02-16  André Pönitz  <poenitz@gmx.net>

	* cursor.[Ch]: use new '_void_ dispatch(...)' signature (see
	  insets/ChangeLog)

	* cursor_slice.[Ch]: remove unneeded acessor function

	* lyxtext.h: rename rtl() to isRTL()

	* rowpainter.C:
	* tabular.C:
	* text.C:
	* text2.C:
	* text3.C: adjust

2004-02-16  Alfredo Braunstein  <abraunst@lyx.org>

	* rowpainter.C (paintSelection): coord fix

2004-02-15  Georg Baum <Georg.Baum@post.rwth-aachen.de>

	* Spacing.C: compile fix

2004-02-13  Alfredo Braunstein  <abraunst@lyx.org>

	* cursor.C (dispatch): restore current_ before returning

2004-02-13  Alfredo Braunstein  <abraunst@lyx.org>

	* text2.C (cursorUp, cursorDown): fix coords
	(moveUp): fix crash

2004-02-12  André Pönitz  <poenitz@gmx.net>

	* lyxtext.h:
	* text.C:
	* text2.C:
	* text3.C: add Cursor & parameter to most cursor movement functions
	  remove usage of LyXText::cursorRow() and cursorPar()

	* cursor.[Ch]: add textRow() needed members

	* BufferView.C:
	* BufferView_pimpl.C:
	* paragraph.[Ch]:
	* BufferView.C:
	* BufferView_pimpl.C: adjust

2004-02-11  André Pönitz  <poenitz@gmx.net>

	* lyxfunc.C:
	* BufferView.[Ch]:
	* BufferView_pimpl.C: shift undo/redo handling

	* cursor.[Ch]: fix mathed crash

	* lyxfind.C:
	* lyxtext.h: move selectionAsText to Cursor

	* output_latex.C:
	* paragraph.C:
	* text.C:
	* text2.C:
	* text3.C: adjust

	* rowpainter.C: fix excessive drawing

2004-02-06  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]:
	* text3.C: move some text specific LFUN handling

2004-02-06  Alfredo Braunstein  <abraunst@lyx.org>

	* text3.C (checkInsetHit): adjust coords
	* text2.C (getColumnNearX): adjust coords
	(edit): adjust coords
	* text.C (getRowNearY): add two asserts

2004-02-06  Martin Vermeer  <martin.vermeer@hut.fi>

	* converter.C:
	* format.C: add using std::distance to compile on gcc 2.95/stlport

2004-02-04  Martin Vermeer  <martin.vermeer@hut.fi>

	* cursor.[Ch]: workaround gcc 2.95 pointer comparison bug

2004-02-04  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch] (insertInset):
	* BufferView_pimpl.[Ch] (insertInset): remove unneeded return value

	* text2.C:
	* text3.C: adjust

2004-02-03  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView_pimpl.C (dispatch): remove call to Cursor::dispatch
	on the default clause of the switch
	* lyxfunc.C (dispatch): call BufferView::dispatch if the event
	wasn't catched by Cursor::dispatch

2004-02-03  André Pönitz  <poenitz@gmx.net>

	* BufferView.C:
	* cursor.[Ch]: some additional asserts

	* undo.[Ch]: remove LyXText dependency in interface

	* lyxfunc.C: adjust

	* lyxtext.h (firstPar, lastPar): remove dead functions

	* text.C:
	* text2.C:
	* text3.C:
	* paragraph.[Ch]: adjust

2004-02-03  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxfind.C (find): fix argument order in call to ::find

2004-02-02  André Pönitz  <poenitz@gmx.net>

	* cursor.[Ch]: remove direct access to anchor

	* text.C: remove findText() hack

2004-02-02  Alfredo Braunstein  <abraunst@lyx.org>

	* iterators.[Ch] (lockPath): remove in favour of...
	* BufferView.[Ch] (setCursor): this addition
	* BufferView.C (putSelectionAt): adjust
	* undo.C (performUndoOrRedo): adjust
	* lyxfunc.C (dispatch): adjust

2004-02-02  Alfredo Braunstein  <abraunst@lyx.org>

	* iterators.C (lockPath): add a missing slice
	* undo.C (performUndoOrRedo): remove redundant positioning code

2004-02-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* vc-backend.C (scanMaster): ";" -> ';'

2004-01-31  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxtextclasslist.C (less_textclass_avail_desc): inherit from
	std::binary_function

	* lyxtextclass.C (compare_name): rename to...
	(LayoutNamesEqual): ...this

	* lyxlex_pimpl.C (compare_tags): inherit from
	std::binary_function, put back into anon namespace

	* lyxfind.C (MatchString): inherig from std::binary_function
	(findChange): use empty() istead of !size()

	* format.C (FormatNamesEqual): new functor
	(getFormat): use it
	(getNumber): use it
	(add): use it
	(erase): use it
	(setViewer): use it

	* converter.C (compare_Converter): rename to...
	(ConverterEqual): ...this, and fixup a bit.
	(getConverter): use it, and make function const
	(getNumber): use it, and make function const
	(add): use it
	(erase): use it:

	* bufferlist.C: add using boost::bind

	* MenuBackend.C (MenuNamesEqual): new functor
	(hasMenu): use it, and make function const
	(hasSubmenu): use nested bind to get rid of compare_memfun.

2004-01-30  André Pönitz  <poenitz@gmx.net>

	* BufferView_pimpl.C:
	* cursor.C:
	* cursor.h:
	* cursor_slice.[Ch]:
	* lyxfunc.C:
	* lyxtext.h:
	* paragraph_funcs.C:
	* paragraph_funcs.h:
	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C: move some of the edit(x,y) handling to the insets
	some coordinate changes.

2004-01-28  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text.C: add using statements for std::advance and std::distance

	* paragraph.C: add using statement for std::distance

	* lyxfind.C: add using statement for std::advance

	* cursor.C (region): remove std:: from swap
	(openable): use nucleus in stead of operator->

	* BufferView.C: add using statements for std::distance and std::swap

2004-01-27  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* iterators.C: Remove the pimple, move the needed structures to
	the header file. Create accessor for the positions stack.
	(asPosIterator): remove function

	* PosIterator.C (PosIterator): move constructors to top of file
	(PosIterator): reimplement the constructor taking a ParIterator in
	terms of setFrom.
	(setFrom): new function
	(operator!=): inline it

2004-01-26  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxfind.C (replaceAll): use std::advance

	* iterators.h: inherit from std::iterator.

	* PosIterator.C (advance, distance): remove
	* PosIterator.h: interit from std::iterator.

2004-01-26  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]:
	* InsetList.[Ch]:
	* PosIterator.[Ch]:
	* buffer.h:
	* bufferview_funcs.C:
	* cursor.[Ch]:
	* cursor_slice.h:
	* factory.[Ch]:
	* iterators.[Ch]:
	* lyxfind.C:
	* lyxfunc.C:
	* lyxtext.h:
	* output_docbook.C:
	* output_latex.C:
	* output_linuxdoc.C:
	* output_plaintext.C:
	* paragraph.[Ch]:
	* paragraph_funcs.[Ch]:
	* paragraph_pimpl.[Ch]:
	* rowpainter.C:
	* tabular.C:
	* tabular.h:
	* text.C:
	* text2.C:
	* text3.C: more IU:  dumps most of the rest of the mathcursor
    implementation into cursor.[Ch]; "globalize" a bit of it.

2004-01-25  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): Dialogs::showSearch is no more.

2004-01-19  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* LaTeXFeatures.h: add nice_ and nice() const
	* buffer.[Ch]: remove niceFile(), use LaTeXFeatures::nice() instead

2004-01-20  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch]:
	* BufferView_pimpl.C:
	* PosIterator.C:
	* bufferview_funcs.C:
	* cursor.[Ch]:
	* cursor_slice.[Ch]:
	* factory.C:
	* iterators.C:
	* lyx_cb.C:
	* lyxfind.C:
	* lyxfunc.C:
	* lyxtext.h:
	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C:
	* undo.[Ch]: lots of IU. Shift selection stuff from the BufferView to
	  Cursor and mathcursor parts to Cursor and InsetBase.

2004-01-15  André Pönitz  <poenitz@gmx.net>

	* cursor_slice.[Ch]: add a few covienience functions

	* funcrequest.[Ch]: remove BufferView * member

	* BufferView_pimpl.C:
	* cursor.C:
	* factory.[Ch]:
	* lyxfind.[Ch]:
	* lyxfunc.C:
	* lyxtext.h:
	* text3.C:
	* undo.[Ch]: adjust to this and changed signature of Inset::priv_dispatch()

2004-01-14  Alfredo Braunstein  <abraunst@lyx.org>

	* text.C (getWord): fix getWord (and thus LFUN_WORDSEL)
	* text3.C (dispatch): fix LFUN_WORD{RIGHT,LEFT}SEL

2004-01-13  André Pönitz  <poenitz@gmx.net>

	* textcursor.[Ch]:
	* lyxtext.h: hide cursor and selection anchor behind accessor function

	* BufferView.C:
	* BufferView_pimpl.[Ch]:
	* PosIterator.C:
	* bufferview_funcs.C:
	* cursor.h:
	* lyxfind.C:
	* lyxfunc.C:
	* text.C:
	* text2.C:
	* text3.C:
	* undo.C: adjust

	* cursor.h:
	* cursor_slice.[Ch]: some integer type changes for inset unification

	* lyxcursor.[hC]: remove, it's CursorSlice now.

	* Makefile.am:
	* BufferView_pimpl.[Ch]:
	* bufferview_funcs.C:
	* cursor_slice.C:
	* lyxtext.h:
	* text.C:
	* text2.C:
	* text3.C:
	* textcursor.[Ch]: adjust

2004-01-08  Alfredo Braunstein  <abraunst@lyx.org>

	* text2.C (undoSpan): add and use
	* text.C (breakParagraph): use undoSpan (fix bug 578)
	* lyxtext.h: adjust

2004-01-08  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (MenuInsertLyXFile):
	* lyx_cb.C (WriteAs, getContentsOfAsciiFile):
	* lyxfunc.C (menuNew, open, doImport):
	FileFilterList change to the FileDialog open and save functions.

2004-01-07  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* ShareContainer.h: make isEqual and isUnique adaptable

	* CutAndPaste.C: make resetOwnerAndChanges adaptable

2004-01-07  Angus Leeming  <leeming@lyx.org>

	* LyXAction.C:
	* lfuns.h: add LFUN_WORD_FIND and LFUN_WORD_REPLACE.

	* BufferView_pimpl.C (dispatch): act on these LFUNs.

	* lyxfind.[Ch] (find2string, replace2string, find, replace): new
	functions replacing find, replace and replaceAll.

	* lyxfunc.C (dispatch): invoke LFUN_WORD_FIND from a call to
	LFUN_WORDFIND(FORWARD|BACKWARD).

2004-01-07  Alfredo Braunstein  <abraunst@lyx.org>

	* text.C (breakParagraph): remove an outdated #warning

2004-01-07  André Pönitz  <poenitz@gmx.net>

	* lyxfind.C: somewhat clearer logic

	* text.C: prevent crash in cursorX on unitialized row cache

2004-01-07  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxcursor.[Ch] (operator>): add
	* textcursor.C (selStart, selEnd): use std::min and std::max

2004-01-06  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* Chktex.C: include boost/format.hpp

2004-01-05  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* InsetList.C: replace functor MathcIt with adaptable functor
	InsetTablePosLess
	(insetIterator): modify accordingly

	* BranchList.h: move the BranchNamesEqual functor here from...
	* BranchList.C: ... to here

	* BranchList.C: new BranchListEqual fuctor, use it. Remove
	SameName and match.
	(add): replace a finding loop with std::find_if.

2003-12-31  Martin Vermeer  <martin.vermeer@hut.fi>

	* output_docbook.C: moving LatexParam functionality into
	.layout files

2003-12-29  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* buffer.C: increment format to 229.

2003-12-28  Michael Schmitt  <michael.schmitt@teststep.org>

	* LaTeXFeatures.C:
	* lyx_sty.[Ch]: remove minipageindent_def

	* LyXAction.C:
	* factory.C:
	* lfuns.h:
	* lyxfunc.C:
	* text3.C: remove LFUN_INSET_MINIPAGE

2003-12-28  Angus Leeming  <leeming@lyx.org>

	* text3.C (dispatch): output useful info on receipt of LFUN_GETLAYOUT.

2003-12-19  Alfredo Braunstein  <abraunst@lyx.org>

	* text2.C (setParagraph): fix off-by-one crash

2003-12-18  Martin Vermeer  <martin.vermeer@hut.fi>

	* output_docbook.C: header stuff for AGU

2003-12-17  Alfredo Braunstein  <abraunst@lyx.org>

	* text2.C (redoCursor): remove
	* text.C:
	* text3.C:
	* BufferView_pimpl.C: remove calls to redoCursor and
	setCursor(cursor.par(), cursor.pos()) all around

2003-12-15  Angus Leeming  <leeming@lyx.org>

	* buffer.C: up the format to 228.

2003-12-15  André Pönitz  <poenitz@gmx.net>

	* cursor_slice.[Ch]: new class to cover texted and mathed's cursor
	slices

	* Makefile.am:

	* BufferView_pimpl.C:
	* cursor.[Ch]:
	* lyxcursor.[Ch]:
	* rowpainter.[Ch]:
	* lyxtext.h:
	* text.C:
	* text2.C:
	* text3.C: adjust

2003-12-15  Angus Leeming  <leeming@lyx.org>

	* metricsinfo.C (ColorChanger): use LColor::getFromLyXName rather
	than getFromGUIName to manipulate the color.

2003-12-14  Angus Leeming  <leeming@lyx.org>

	* BranchList.[Ch]: minimize the API.
	(Branch::getBranch, getColor): now return a 'const &'.
	(Branch::setSelected) now returns a bool set to true if the
	selection status changes.
	(BranchList::clear, size, getColor, setColor, setSelected,
	allBranches, allSelected, separator): removed.
	(BranchList::find): new functions, returning the Branch with
	the given name.
	(BranchList::add, remove): return a bool indicating that
	the operation was successful.

	* InsetList.C (insetsOpenCloseBranch): much simplified thanks to a
	new InsetBranch::isBranchSlected member function.

	* LColor.[Ch]: mimimize the API.
	(fill): renamed as addColor and made private.
	(setColor, getGUIName, getX11Name, getLaTeXName): the overloaded
	versions of these functions taking a string arg have been removed.

	* bufferparams.C (readToken):
	* lyxfunc.C (dispatch):
	* lyxrc.C (read): changes due to the altered BranchList and
	LColor APIs.

	* factory.C (createInset, readInset): changes due to altered
	InsetBranch c-tor.

2003-12-14  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* factory.C:
	* lyxfunc.C: remove insetminipage. "minipage-insert"
	now produces a frameless minipage box inset.

2003-12-12  Alfredo Braunstein  <abraunst@lyx.org>

	* textcursor.[Ch] (selStart,selEnd): add new methods
	remove selection::start, end, use LyXCursor::operator<
	* lyxcursor.[Ch] (operator<): add
	* BufferView_pimpl.[Ch]: add new struct xsel_cache_
	* BufferView.[Ch] (unsetXSel): add
	* text2.C (clearSelection): use unsetXSel,adjust
	* text.C: adjust
	* text3.C: adjust
	* rowpainter.C: adjust
	* bufferview_funcs.C (put_selection_at): adjust

2003-12-12  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView_pimpl.C: small coord. correction

2003-12-12  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView_pimpl.C (workAreaDispatch): avoid crashing when
	dragging over the splash screen.

2003-12-11  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (dispatch): remove LFUN_INSET_APPLY code
	as it is now handled in LyXText::dispatch.

	* text3.C (doInsertInset): remove a level of nesting.

2003-12-11  Angus Leeming  <leeming@lyx.org>

	* factory.C (createInset): changes due to the changed interface to
	InsetCommandMailer::string2params.

2003-12-10  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): enable all inset dialogs to be opened with
	'dialog-show-new-inset <inset name>'

2003-12-10  Angus Leeming  <leeming@lyx.org>

	* buffer.C: up the format to 227.

	* factory.C: the box inset is now identified simply by 'Box'.

2003-12-10  Angus Leeming  <leeming@lyx.org>

	* buffer.C: up the format to 226.

	* factory.C: the note inset is now identified simply by 'Note'.

2003-12-08  Alfredo Braunstein  <abraunst@libero.it>

	* lyxtext.h, text2.C (setLayout): don't use cursor to iterate,
	when a pit is enough. Standarize a couple of loops.

2003-12-05  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): DIALOG_SHOW now handles "latexlog" and
	"vclog" explicitly, passing the appropriate "<logtype> <filename>"
	data to the re-worked "log" dialog.

2003-12-03  André Pönitz  <poenitz@gmx.net>

	* PosIterator.C:
	* iterators.C:
	* lyxtext.h:
	* output_latex.C:
	* paragraph_funcs.C:
	* text.C:
	* text2.C: use Inset::getText instead of Inset::getParagraph

2003-12-03  André Pönitz  <poenitz@gmx.net>

	* buffer.[Ch]:
	* lyxtext.h:
	* paragraph_funcs.[Ch]: consolidate parts of Buffer::read() and
	InsetText::read() as LyXText::read()

2003-12-02  Angus Leeming  <leeming@lyx.org>

	* lyxlex.[Ch] (operator void const *): add the 'const' to the return
	type. Add a comment in the implementation that the function uses
	the stream's bad() function rather than fail() as the std::streams
	would do.

2003-12-02  André Pönitz  <poenitz@gmx.net>

	* lyxlex.[Ch]: make interface more similar to std::stream

	* lyxlex_pimpl.[Ch]: don't use '__' in identifiers

2003-12-01  Martin Vermeer  <martin.vermeer@hut.fi>

	* lyxtextclass.[Ch]: add latexparam to CharStyle inset

2003-12-01  Michael Schmitt  <michael.schmitt@teststep.org>

	* vspace.[Ch]: remove VSpace::NONE

2003-12-01  André Pönitz  <poenitz@gmx.net>

	* buffer.[Ch]:
	* lyxtext.h: move ParagraphList member to LyXText
	rename LyXText::ownerParagraphs to LyXText::paragraph

	* CutAndPaste.C:
	* bufferview_funcs.C:
	* iterators.[Ch]:
	* lyx_cb.C:
	* paragraph.C:
	* rowpainter.C:
	* tabular.C:
	* text.C:
	* text2.C:
	* text3.C: adjust

	* lyxfunc.C: move LFUN_INSET_TOGGLE handling to insets.

	* undo.C: fix cursor positioning

2003-12-01  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C: fix a crash on exit with
	a buffer open

2003-11-30  Martin Vermeer  <martin.vermeer@hut.fi>

	* BranchList.C: fix setSelected() method.

2003-11-28  André Pönitz  <poenitz@gmx.net>

	* ParagraphParameters.[Ch]:
	* ParameterStruct.h: remove space above/below from Paragraph to
	 InsetVSpace

	* BufferView_pimpl.C:
	* factory.C:
	* lyxfunc.C:
	* lyxtext.h:
	* output_latex.C:
	* paragraph.C:
	* paragraph_funcs.C:
	* rowpainter.[Ch]:
	* text.C:
	* text2.C:
	* text3.C: adjust

2003-11-28  Martin Vermeer  <martin.vermeer@hut.fi>

	* factory.C: Syntax change for CharStyles

2003-11-28  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch]:
	* BufferView.[Ch]:
	* buffer.[Ch]:
	* buffer.[Ch]: move LyXText member

2003-11-28  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch]: make LyXText * text a private member

	* BufferView_pimpl.C:
	* cursor.C:
	* iterators.C:
	* lyx_cb.C:
	* lyxfind.C:
	* lyxtext.h:
	* rowpainter.[Ch]:
	* text.C:
	* text2.C:
	* undo.C: adjust

	* output_plaintext.C: cleanup

2003-11-27  Martin Vermeer  <martin.vermeer@hut.fi>

	* buffer.C:
	* lyxtextclass.[Ch]: parametrize SGML document header

2003-11-27  Martin Vermeer  <martin.vermeer@hut.fi>

	* converter.[Ch]:
	* exporter.C: replace bool-valued Pdflatex() by FLAVOR-valued
	getFlavor().

2003-11-27  Alfredo Braunstein  <abraunst@lyx.org>

	* text2.C (setFont): rework using PosIterator (no more recursive)
	(setCharFont): no more needed
	(setLayout): no more selection cursors fiddling (done by redoCursor)
	* text.C: cursorRight(bv)->cursorRight(true) (TODO: find and
	destroy remaining ones)

2003-11-26  Alfredo Braunstein  <abraunst@lyx.org>

	* bufferview_funcs.[Ch]: split changeDepthAllowed from changeDepth
	* lyxtext.h: ditto
	* text2.C: same thing + updateCounters fix + redoCursor also adjusts
	selection cursors
	* lyxfunc.C: adjust
	* text3.C: adjust + re-allow multi par depth changes
	* textcursor.C: simplify a bit

2003-11-25  Martin Vermeer  <martin.vermeer@hut.fi>

	* src/buffer.C:
	* src/lyxlayout.C:
	* src/lyxlayout.h:
	* src/lyxtext.h:
	* src/output_docbook.C:
	* src/output_latex.C:
	* src/paragraph.C:
	* src/paragraph.h:
	* src/sgml.C:
	* src/sgml.h:
	* src/text2.C: Introducing a number of tags parametrizing various
	XML formats that we may want to support

2003-11-25  André Pönitz  <poenitz@gmx.net>

	* InsetList.[Ch] (begein, end): inline as suggested by profiler

	* lyxtext.h (leftMargin/rightMargin): simplify interface

	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C: adjust

2003-11-24  Georg Baum  <Georg.Baum@post.rwth-aachen.de>

	* lyxfunc.C (dispatch): propogate the bibtex databases from the
	master file to any child files. Fixes bug 546.

2003-11-24  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxfind.C (findNextChange): remove unneeded bv->text->init call

2003-11-24  André Pönitz  <poenitz@gmx.net>

	* rowpainter.C: simplification

	* text2.C (updateCounters): remove call to redoParagraph on
	changed labels as this is far too expensive.

2003-11-24  Alfredo Braunstein  <abraunst@lyx.org>

	* converter.C (convert): fix a crash: this function gets
	called with buffer == 0 from importer code.

2003-11-22  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C (cursorPrevious): make sure that we do not compare
	iterators form different containers.
	(cursorNext): ditto

	* rowpainter.C (paintSelection): make sure that we do not compare
	iterators from different containers.

	* text3.C (dispatch): [PRIOR] make sure that we do not compare
	iterators from different ParagraphList containers.
	[NEXT] ditto

	* text2.C (LyXText): change order of initialization slightly
	(operator=): new function. copy all variables except cache_par_
	(moveUp): make sure that we do not compare iterators from
	different ParagraphList constainers.
	(moveDown): ditto

	* text.C (firstPar): new function
	(lastPar): new function
	(endPar): new function

	* lyxtext.h: move things around and group public functions, public
	variables, private functions, private variables

2003-11-21  Michael Schmitt  <michael.schmitt@teststep.org>

	* factory.C: change call to InsetERT constructor to avoid
	additional invocation of method status
	* text2.C (toggleInset): remove redundant update() call
	* InsetList.[Ch] (insetsOpenCloseBranch): Pass Buffer reference
	instead of a Bufferview pointer

2003-11-21  André Pönitz  <poenitz@gmx.net>

	* rowpainter.C: simplification

2003-11-21  Alfredo Braunstein  <abraunst@lyx.org>

	* text3.C (dispatch): make possible to extend a word/row selection
	with the mouse

2003-11-21  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxtext.h: x0_,y0_ -> xo_,yo_
	* text2.C (cursorUp, cursorDown): adjust + some cursorRow use
	* text3.C (checkInsetHit): fix coordinates using absolute xo_,yo_
	* rowpainter.C (paintRows): paint full paragraphs

2003-11-20  Alfredo Braunstein  <abraunst@lyx.org>

	* text2.C (cursorUp, cursorDown): small fix (insettext::edit takes
	screen coordinates)

2003-11-20  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxtext.h: add x0_, y0_
	* text3.C (cursorPrevious, cursorNext): rewrite (using x0_, y0_)
	* text2.C (cursorDown, cursorUp): rewrite (using x0_, y0_)

2003-11-18  Alfredo Braunstein  <abraunst@lyx.org>

	* text2.C (setCursorIntern): move the x_target update here *
	* text3.C: change some bv() to true/false in calls to
	cursorUp/Down/Right/Left
	* cursor.C: use helper function.

2003-11-17  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView_pimpl.C: send LFUN_MOUSE_MOTION to the cursor
	* paragraph_funcs.[Ch]: correct comment
	* rowpainter.C: do not paint selections away from bv->cursor()
	Fix a long standing selection painting bug.
	* text3.C: generalize mouse-selection code to LyXTexts other that
	top one
	* textcursor.C: do not use y coords if we can use par offsets

2003-11-17  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxfunc.C (dispatch): add a missing Cursor::updatePos (fix
	cursor position after e.g. inset insert)

2003-11-16  Alfredo Braunstein  <abraunst@lyx.org>

	* lyxfind.C (replace): adjust to locking removal + some
	code simplification

2003-11-14  Alfredo Braunstein  <abraunst@lyx.org>

	* cursor.C (dispatch): dispatch to BufferView::dispatch at the end
	of the path

2003-11-14  Martin Vermeer  <martin.vermeer@hut.fi>

	* lyxlayout.[Ch]:
	* output_docbook.C: XML sanitation: new layout
	parameters InnerTag and CommandDepth

2003-11-13  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView_pimpl.C:
	* factory.C:
	* text3.C: Fix the insertion and modification of button-style
	insets

2003-11-13  André Pönitz  <poenitz@gmx.net>

	* InsetList.[Ch]: remove deleteLyXText

	* paragraph.[Ch]: cache beginOfBody position

	* Bidi.C:
	* text.C:
	* text2.C:
	* text3.C: remove superfluous update() calls

	* vspace.C: cleanup

2003-11-13  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView_pimpl.C (fitCursor): call screen().fitCursor()
	* BufferView.C (fitLockedInsetCursor): remove
	* cursor.[Ch] (getDim): add
	* text.C (getRowNearY): add faster version
	* text3.C: remove some update calls

2003-11-12  Martin Vermeer  <martin.vermeer@hut.fi>

	* LaTeXFeatures.C:
	* LyXAction.C:
	* MenuBackend.C:
	* MenuBackend.h:
	* dispatchresult.h:
	* factory.C:
	* lfuns.h:
	* lyxfunc.C:
	* lyxtextclass.C:
	* lyxtextclass.h:
	* text3.C: The Character Style /XML short element patch.

2003-11-11  Martin Vermeer  <martin.vermeer@hut.fi>

	* text3.C:
	* factory.C: Small step to solving 'unable to insert some insets'
	problem

2003-11-11  Alfredo Braunstein  <abraunst@lyx.org>

	* cursor.[Ch] (updatePos): new function for updating the y
	position of the tip inset
	* bufferview_funcs.C (put_selection_at):
	* BufferView_pimpl.C (workAreaDispatch): rationalise update calls

2003-11-11  André Pönitz  <poenitz@gmx.net>

	* text.C: remove big comment on invalid Paragraph pointers as it is
	not valid anymore

2003-11-11  André Pönitz  <poenitz@gmx.net>

	* text_funcs.[Ch]: merge with ...

	* text.C: ... this

	* lyxtext.h:
	* text2.C:
	* text3.C: adjust

	* Makefile.am: remove text_funcs.[Ch]

2003-11-11  Alfredo Braunstein  <abraunst@libero.it>

	* cursor.C (getPos): return absolute cached y coord

	* BufferView_pimpl.C (fitCursor): new simplistic code
	(workAreaDispatch): add a fitCursor call

2003-11-10  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]: merge update() and updateInset()

2003-11-10  André Pönitz  <poenitz@gmx.net>

	* lfuns.h: new LFUN_FINISHED_LEFT, LFUN_FINISHED_RIGHT,
	LFUN_FINISHED_UP, LFUN_FINISHED_DOWN used in dispatch to
	indicate that the cursor needs to leave an inset

	* lyxtext.h: remove inset locking

	* cursor.[Ch]: re-implement functionality provided by inset locking

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]:
	* LyXAction.C:
	* bufferview_funcs.[Ch]:
	* factory.C:
	* funcrequest.[Ch]:
	* iterators.C:
	* lyx_cb.C:
	* lyxfind.C:
	* lyxfunc.C:
	* text.C:
	* text2.C:
	* text3.C:
	* undo.C: adjust

2003-11-07  Alfredo Braunstein  <abraunst@libero.it>

	* PosIterator.[Ch]: replace the stack with a vector, add inset
	accesor
	* iterators.[C]: adjust

2003-11-06  Alfredo Braunstein  <abraunst@libero.it>

	* lyxfind.C (replaceAll): mark the buffer dirty if something was
	replaced
	* paragraph_funcs.C (readParToken): put the correct id in the
	error item, not the id of the top paragraph

2003-11-06  Alfredo Braunstein  <abraunst@libero.it>

	* iterators.[Ch] (ParIterator): new PosIterator-based ctor
	* bufferview_funcs.C (put_selection_at): use the above

2003-11-05  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (deleteEmptyParagraphMechanism): fix n-th crash

2003-11-05  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* output_linuxdoc.h:
	* output_plaintext.h:
	* output.h:
	* output_docbook.h: add #include statements

2003-11-05  José Matos  <jamatos@lyx.org>

	* output_docbook.[Ch]:
	* output_latex.[Ch]:
	* output_linuxdoc.[Ch]:
	* output_plaintext.[Ch]: New files for output formats.
	* output.[Ch]: New file for helper functions.

	* buffer.[Ch]:
	* paragraph_funcs.[Ch]: output functions moved to new files.

	* outputparams.h: rename of latexrunparams.h

	* LaTeX.[Ch]:
	* buffer.[Ch]:
	* bufferlist.[Ch]:
	* converter.[Ch]:
	* exporter.C:
	* paragraph.[Ch]:
	* paragraph_funcs.[Ch]:
	* paragraph_pimpl.[Ch]:
	* tabular.[Ch]: rename ascii to plaintext
	and LatexRunParams to OutputParams.

2003-11-05  Alfredo Braunstein  <abraunst@libero.it>

	* iterators.[Ch] (text): require bv argument
	* undo.C (recordUndo):
	* lyxfunc.C (dispatch):
	* bufferview_funcs.C (put_selection_at): adjust

2003-11-05  Joï¿½ Luis M. Assirati  <assirati@fma.if.usp.br>

	* lyxsocket.C: export variables XEDITOR and LYXSOCKET

2003-11-05  Alfredo Braunstein  <abraunst@libero.it>

	* lyxfunc.C (dispatch): make LFUN_GOTO_PARAGRAPH work with deep
	nestings

2003-11-04  André Pönitz  <poenitz@gmx.net>

	* cursor.[Ch]: restructure

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]: new Cursor cursor_ member

	* iterators.[Ch] (asCursor): remove

	* lfuns.h: remove LFUN_INSET_EDIT

	* lyxfunc.C:
	* tabular.C:
	* text.C:
	* text2.C:
	* text3.C: use Inset::edit() instead of dispatch(LFUN_INSET_EDIT)

2003-11-04  Alfredo Braunstein  <abraunst@libero.it>

	* lyxfind.[Ch]: complete overhaul
	* BufferView_pimpl.C:
	* lyxfunc.C: adjust
	* paragraph.[Ch] (insert): add

2003-11-04  Alfredo Braunstein  <abraunst@libero.it>

	* BufferView.[Ch]:
	* lyxtext.h:
	* text.C: remove dead spellcheck code

2003-11-04  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* dispatchresult.h: add a val setter

	* cursor.C (dispatch): use a tempvar for data_[i]

2003-11-04  Alfredo Braunstein  <abraunst@libero.it>

	* PosIterator.[Ch]: compile fix

2003-11-04  Alfredo Braunstein  <abraunst@libero.it>

	* text.C (cursorPar): deactivate the cursor cache

2003-11-03  Alfredo Braunstein  <abraunst@libero.it>

	* undo.C (performUndoOrRedo): fix cursor positioning with lockPath

2003-11-03  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C (dispatch): adjust for new DisptchResult semantics.

	* lyxfunc.C (dispatch): handle update when return from
	Cursor::dispatch, adjust for new DispatchResult semantics.

	* dispatchresult.h: drop NOUPDATE from dispatch_result_t. Make
	DispatchResult(true) mean to not update. Add class functions for
	setting dispatched and update, as well as reading.

	* cursor.C (dispatch): don't handle update here

2003-11-03  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* trans_mgr.h: store t1_ and t2_ in scoped_ptr
	* trans_mgr.C: adjust

	* paragraph_funcs.C (readParToken): exception safety

	* lyxvc.h: store the vcs pointer in a scoped_ptr
	* lyxvc.C: adjust

	* lyxsocket.C (serverCallback): exception safety

	* lyx_cb.C (AutoSaveBuffer): make it return a auto_ptr

	* ispell.C (clone): make it return a auto_ptr

	* factory.C (createInset): exception safety
	(readInset): exception safety

	* bufferlist.C (newBuffer): exception safety

	* Thesaurus.C (Thesaurus): use initialization for aik_

	* MenuBackend.C (expandToc): exception safety.

2003-11-03  André Pönitz  <poenitz@gmx.net>

	* buffer.C:
	* buffer.h:
	* bufferview_funcs.C: remove getInsetFromId()

	* lyxcursor.[Ch]:
	* BufferView.[Ch]: move x_fix from LyXCursor to BufferView

	* lyxfunc.C:
	* text2.C:
	* text3.C: adjust

2003-11-03  Alfredo Braunstein  <abraunst@libero.it>

	* PosIterator.C (distance, advance): new
	* bufferview_funcs.[Ch] (put_selection_at): new
	* iterators.[Ch] (lockPath): new

2003-11-02  Alfredo Braunstein  <abraunst@libero.it>

	* iterators.[Ch] (asPosIterator): added
	* buffer.[Ch] (pos_iterator_begin, pos_iterator_end): added
	* PosIterator.[Ch]: added

2003-11-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C:
	* lyxfunc.C:
	* cursor.C (dispatch):
	* BufferView_pimpl.C (dispatch): adjust for DispatchResult changes

	* dispatchresult.h: remove UNDISPATCHED, DISPATCHED and
	DISPATCHED_NOUPDATE from dispatch_result_t, add NONE. Add a
	contructor, add a class function dispatched. Remove operator>=

2003-11-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* debug.C: only use the default constructor for debugstream
	(lyxerr) here.

	* main.C (main): include debug.h and setup the lyxerr streambuf
	here.

2003-10-31  José Matos  <jamatos@lyx.org>

	* paragraph_funcs.C (addDepth, asciiParagraph): move from buffer.C

	* buffer.[Ch] (writeFileAscii, makeLinuxDocFile, makeDocBookFile):
	* paragraph.[Ch] (simpleLinuxDocOnePar, simpleDocBookOnePar, asString):
	* paragraph_funcs.[Ch] (linuxdocParagraphs, docbookParagraphs):
	* paragraph_pimpl.C (simpleTeXSpecialC):
	* tabular.[Ch] (linuxdoc, docbookRow, docbook, ascii):
	add LatexRunParams argument.

	* exporter.C (Export): change call accordingly.

	* latexrunparams.h: add new member to take care of the other backends.
2003-10-30  José Matos  <jamatos@lyx.org>

	* buffer.C (makeLinuxDocFile, makeDocBookFile):
	* paragraph_funcs.[Ch] (linuxdocParagraphs, docbookParagraphs):
	factorise code for paragraph output.
	* buffer.[Ch]:
	* paragraph.[Ch] (simpleLinuxDocOnePar, simpleDocBookOnePar):
	move functions.

2003-10-29  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C (dispatch):
	* lyxfunc.C (dispatch):
	* cursor.C (dispatch):
	* BufferView_pimpl.C (dispatch): explict DispatchResult ctor fallout.

	* dispatchresult.h: make the dispatch_result_t ctor explicit

2003-10-29  Martin Vermeer  <martin.vermeer@hut.fi>

	* sgml.[Ch]:
	* buffer.C: small refactoring of docbook stuff

2003-10-29  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* dispatchresult.h: remove FINISHED_POP as FINISHED has the same
	meaning.

2003-10-29  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* dispatchresult.h: rename DISPATCHED_POP to FINISHED_POP, remove
	operator dispatch_result_t, and operators for == != and >=

	* cursor.C (dispatch): adjust for operator dispatch_result_t
	removal. comment out call to update

	* BufferView_pimpl.C (dispatch): dont implicit covert to bool

2003-10-29  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C:
	* text2.C:
	* text.C:
	* lyxtext.h:
	* lyxfunc.C:
	* cursor.C:
	* BufferView_pimpl.C: dispatch_result -> DispatchResult changes.
	(dispatch):

	* dispatchresult.h: new file, DispatchResult broken out of
	insets/insetbase.h

	* Makefile.am (lyx_SOURCES): add dispatchresult.h

2003-10-28  Alfredo Braunstein  <abraunst@libero.it>

	* text.C (rowBreakPoint): put a hack inside #if 0

2003-10-28  André Pönitz  <poenitz@gmx.net>

	* lyxtext.h:
	* metricsinfo.C:
	* paragraph_funcs.C:
	* rowpainter.C:
	* text.C:
	* text2.C: general cleanup (lots of small stuff)

2003-10-28  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (cursorEnd): simple fix to the "end key goes to one
	before the end on last row" bug

2003-10-27  Alfredo Braunstein  <abraunst@libero.it>

	* text.C (backspace): fix the "zombie characters"

2003-10-27  Alfredo Braunstein  <abraunst@libero.it>

	* lyxfunc.C (dispatch): small fix to toc navigation inside branches

2003-10-27  André Pönitz  <poenitz@gmx.net>

	* lfuns.h: new LFUN_REPEAT, LFUN_INSERT_LINE, LFUN_INSERT_PAGEBREAK

	* factory.C: handle new InsetPagebreak, InsetLine

	* ParagraphParameters.h: remove [line|pagebreak]_[above|below]
	and move handling into new InsetPagebreak, InsetLine

	* BufferView_pimpl.C:
	* LyXAction.C:
	* ParagraphParameters.C:
	* ParameterStruct.h:
	* lyxfunc.C:
	* lyxtext.h:
	* paragraph.C:
	* paragraph.h:
	* paragraph_funcs.C:
	* paragraph_pimpl.C:
	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C: adjust

2003-10-27  Alfredo Braunstein  <abraunst@libero.it>

	* text.C:
	* lyxrow_funcs.[Ch]:
	* Bidi.C:
	* paragraph.C:
	* lyxtext.h:
	* rowpainter.C:
	* text2.C:
	* text3.C: remove lastPos uses in favour of Row::endpos

2003-10-27  Alfredo Braunstein  <abraunst@libero.it>

	* undo.C (performUndoOrRedo): fix two crashes by setting a
	cursor by hand and reordering some calls. Use bv->lockInset instead
	of inset->edit because the latter loses cursor information

2003-10-25  Alfredo Braunstein  <abraunst@libero.it>

	* text.C (prepareToPrint): fix linebreak rowbreaking as suggested
	by Martin
	(rowBreakPoint): fix width. change point to point + 1.
	Add a missing check.

2003-10-25  Martin Vermeer  <martin.vermeer@hut.fi>

	* MenuBackend.C:
	* lyxfunc.C: fix (at least partly) the problems
	with the Nav menu and headers inside branch insets
	reported by Kayvan

2003-10-24  Alfredo Braunstein  <abraunst@libero.it>

	* paragraph.C (getChar): add strong asserts

	* lyxrow_funcs.C (lastPos): remove hideous hack

	* text.C (addressBreakPoint, rowBreakPoint): put endpos in place
	(fill): adjust to that (avoid an infinite loop)

2003-10-23  Alfredo Braunstein  <abraunst@libero.it>

	* text3.C (cursorPrevious, cursorNext): fix 2 "dontlikes"

2003-10-23  André Pönitz  <poenitz@gmx.net>

	* RowList_fwd.h: change list<> to vector<> to gain speed
	after suggestion from Alfredo

2003-10-23  Alfredo Braunstein  <abraunst@libero.it>

	* lyxtext.h: move the bidi stuff from here...
	* text.C: and here
	* text2.C: and here
	* Bidi.[Ch]: ... to here

2003-10-23  André Pönitz  <poenitz@gmx.net>

	* lyxtext.h:
	* text.C (isLastRow, isFirstRow): new functions

	* paragraph.h: new width cache member

	* rowpainter.C: replace RowList::iterator with Row & where possible

	* lyxfunc.C: replace several view()->text with a single call

	* toc.C: fix 'unused' warning

2003-10-23  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxlex_pimpl.C (setFile,setStream): be sure to use correct types
	when woring with stream::pos_type
	* paragraph_pimpl.C (simpleTeXSpecialChars): ditto

2003-10-22  André Pönitz  <poenitz@gmx.net>

	* lyxtext.h:
	* text.C: use Row & instead of RowList::iterator

	* lyxrow.h: rename end() to endpos()

	* rowpainter.C:
	* text.C:
	* text2.C: adjust

2003-10-22  Angus Leeming  <leeming@lyx.org>

	* buffer.[Ch] (fully_loaded): new member function, returning true
	only when the file has been loaded fully.
	Used to prevent the premature generation of previews and by the
	citation inset to prevent computation of the natbib-style label.

	* buffer_funcs.C (newFile): set Buffer::fully_loaded once the
	templates are all set up.

	* factory.C (createInset): remove call to InsetCitation::setLoadingBuffer.

2003-10-22  Martin Vermeer  <martin.vermeer@hut.fi>

	* text.C: fixed an "oops" in the "is a bit silly"
	bug fix

2003-10-21  André Pönitz  <poenitz@gmx.net>

	* FuncStatus.[Ch]: small stuff, whitespace

	* lyxfont.[Ch]: operator<<() for debug reasons

	* lyxfunc.C:
	* lyxrow_funcs.C:
	* lyxtext.h: whitespace, spelling

	* paragraph.C: naming of variables

	* text.C:
	* text2.C: small stuff


2003-10-21  Martin Vermeer  <martin.vermeer@hut.fi>

	* text.C: (1) finish off the inset display() work;
	(2) fix the "is a bit silly" bug (accessing char
	past end of par).

2003-10-20  Martin Vermeer  <martin.vermeer@hut.fi>

	* text.C: re-introduce display() for insets, fixing the
	various bugs (stretch of line above, math inset
	positioning, ...)

2003-10-20  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text.C (rightMargin): remove spurious semicolon

	* lengthcommon.C: add empty unit_name* entries for UNIT_NONE (bug
	1415)

2003-10-18  Martin Vermeer  <martin.vermeer@hut.fi>

	* text3.C: fix one crash due to wrong cursor def

2003-10-17  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* vc-backend.C (scanMaster): make the regex static

	* LaTeX.C (scanAuxFile): make the regexs static

	* text3.C (doInsertInset, dispatch, dispatch):
	* text2.C (cursorUp, cursorDown):
	* text.C (selectNextWordToSpellcheck):
	* BufferView_pimpl.C (dispatch):
	* lyxfunc.C (dispatch):  localDispatch -> dispatch

2003-10-14  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxsocket.C: include <cerrno>

2003-10-17  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxfunc.C (dispatch): remove textcache stuff

	* bufferlist.C (release): remove textcache stuff
	(closeAll): ditto

	* TextCache.C: delete file
	* TextCache.h: delete file

	* Makefile.am (lyx_SOURCES): delete TextCache.C and TextCache.h

	* BufferView_pimpl.C (buffer): remove textcache stuff, add a
	delete of the bv_->text.
	(resizeCurrentBuffer): remove texcache stuff
	(workAreaResize): ditto

2003-10-16  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxfunc.C (getStatus): also set flag disabled if it is a unknown
	action.

2003-10-16  André Pönitz  <poenitz@gmx.net>

	* lyxrow.[Ch]:
	* paragraph.h:
	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C: speed up by storing y positions per paragraph plus per-row
	offset instead of having a 'full' y position in the row.

2003-10-15  André Pönitz  <poenitz@gmx.net>

	* iterators.[Ch]:
	* iterators.[Ch]:
	* undo.[Ch]: make undo aware of inner insets

2003-10-14  Angus Leeming  <leeming@lyx.org>

	* lyx_main.[Ch]: make LyX a singleton class, accessible though the new
	static member functions LyX::ref() and LyX::cref.
	(lastfiles): new accessor functions for the new lastfiles_ member var.
	(addLyXView, views_): add a new LyXView to the list of views_.
	(updateInset): loop over all LyXViews to call their own updateInset
	member function, returning a pointer to the Buffer owning the inset.

	* BufferView_pimpl.C (loadLyXFile):
	* MenuBackend.C (expandLastfiles):
	* bufferlist.C (MenuWrite, QuitLyX):
	lastfiles is no longer a global variable.
	Access through LyX::ref().lastfiles(), LyX::cref().lastfiles().

	* boost.C (emergencyCleanup): LyX::emergencyCleanup is no longer a
	static function. Access through LyX::cref().emergencyCleanup().

2003-10-14  André Pönitz  <poenitz@gmx.net>

	* iterators.[Ch]: new direct access to innermost LyXText and Inset

	* undo.[Ch]: restoring part of 'undo in insets'

	* Makefile.am:
	* undo_funcs.[Ch]: merge with undo.[Ch]

	* tabular.C: small cleansing stuff

2003-10-14  Alfredo Braunstein  <abraunst@libero.it>

	* paragraph_funcs.C (readParToken): report unknown insets as error
	boxes. Use the outer paragraph as location (also for unknown
	tokens).

	* factory.C (readInset): do not abort on reading an unknown inset.
	Eat it and return 0.

2003-10-13  Angus Leeming  <leeming@lyx.org>

	* lyx_main.C (LyX): remove call to setDisplayTranslator().

	* lyxrc.C: displayTranslator is now a function,
	declared in GraphicsTypes.h.

2003-10-13  Joao Luis Meloni Assirati <assirati@fma.if.usp.br>

	* format.C: new placeholder $$a to pass the socket address.

	* bufferlist.[Ch]: new function getBufferFromTmp.

	* lyxfunc.C: Modification of LFUN_GOTOFILEROW so that it can handle
	  files in the temporary dir.

2003-10-13  Joao Luis Meloni Assirati <assirati@fma.if.usp.br>

	* lyxsocket.[Ch]: new files. A simple local socket interface for lyx.

	* Makefile.am: add lyxsocket.[Ch].

	* lyx_main.C (error_handler): handle SIGPIPE.

2003-10-13  André Pönitz  <poenitz@gmx.net>

	* BufferView_pimpl.C:
	* lyxtext.h:
	* text.C:
	* text2.C:
	* text3.C:
	* undo_funcs.[Ch]: use paroffset_type instead of
	  ParagraphList::iterators to prevent multiple conversion
	  (and get a more robust interface)

2003-10-13  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxfunc.C (dispatch): RESULT -> dispatch_result
	* lyxtext.h: ditto
	* text3.C (dispatch): ditto

2003-10-13  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* LaTeX.C (handleFoundFile): move the static to smaller scope,
	move the onlyfile, use onlyfile instead of foundfile in a couple
	of places.

	* DepTable.C (update): flush the error stream a bit more

2003-10-13  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxserver.C (callback): adjust

	* lyxfunc.C (getStatus): add a missing brace in commented code
	(ensureBufferClean): reindent
	(dispatch): delete version taking a string

2003-10-11  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* LaTeX.C (deplog): move found file handlig from here...
	(handleFoundFile): .. to new function here.
	(deplog): make sure to discover several files mentioned on the
	same log line.

2003-10-10  André Pönitz  <poenitz@gmx.net>

	* lyxfunc.C:
	* lyxtext.h:
	* tabular.C:
	* text.C:
	* text2.C:
	* text3.C: fix some of the tabular crashes

2003-10-09  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* MenuBackend.C (binding): put debug message into Debug::KBMAP

	* lyxlex_pimpl.C (setFile): put debug messages into Debug::LYXLEX.

2003-10-09  André Pönitz  <poenitz@gmx.net>

	* lyxcursor.h: use paroffset_type instead of ParagraphList::iterator

	* BufferView.C:
	* BufferView_pimpl.C:
	* bufferview_funcs.C:
	* lyx_cb.C:
	* lyxcursor.C:
	* lyxfind.C:
	* lyxfunc.C:
	* lyxtext.h:
	* text.C:
	* text2.C:
	* text3.C:
	* text_funcs.[Ch]:
	* textcursor.[Ch]:
	* undo_funcs.C: adjust

2003-10-08  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (incrementItemDepth): new function, use a backtracking
	algorithm to discover the correct item depth.
	(resetEnumCounterIfNeeded): new function, use a backtracking
	algorithm to discover if counter reset is needed.
	(setCounter): use them. Simplify a bit. Add different labels for
	different item depths for itemize.

	* paragraph.C (Paragraph): remove initialization of enumdepth
	(operator=): ditto

	* paragraph.h: get rid of enumdepth, and use itemdepth both for
	enumerate and itemize. Change the type of itemdepth to signed char.

2003-10-08  André Pönitz  <poenitz@gmx.net>

	* lyxtext.h: make the paragraphs_ a pointer instead a ref to make the
	  thing assignable.
	* text.C:
	* text2.C: adjust

	* tabular.[Ch]: fix crash after 'row-insert'

2003-10-08  Angus Leeming  <leeming@lyx.org>

	Fix doxygen warnings.

	* CutAndPaste.[Ch] (availableSelections). Now returns a const vector.
	Remove CutAndPaste:: prefix from header file declaration.

	* LColor.h (fill): remove LColor:: prefix from declaration.

	* buffer.C (readParagraph, simpleLinuxDocOnePar, simpleDocBookOnePar):
	use lyx::depth_type rather than Paragraph::depth_type so that
	header file and .C file match.

	* converter.h (intToFormat): remove Converters:: prefix from declaration.

	* Spacing.h: \file Spacing.h -> \file src/Spacing.h
	* aspell.C: \file aspell_local.C -> \file aspell.C
	* gettext.C: \file gettext.C -> \file src/gettext.C
	* gettext.h: \file gettext.h -> \file src/gettext.h
	* lyxfont.C: \file lyxfont.C -> \file src/lyxfont.C
	* lyxfont.h: \file lyxfont.h -> \file src/lyxfont.h
	* text.C: \file text.C -> \file src/text.C

	* toc.C: move comment so that doxygen is not confused.

2003-10-07  Angus Leeming  <leeming@lyx.org>

	* factory.C (createInset): InsetExternal::Params -> InsetExternalParams

2003-10-07  Jürgen Spitzmüller <j.spitzmueller@gmx.de>

	* aspell.C:
	* aspell_local.h: add forgotten std::string's.

2003-10-07  Martin Vermeer <martin.vermeer@hut.fi>

	* LaTeXFeatures.C:
	* LyXAction.C:
	* factory.C:
	* lfuns.h:
	* lyxfunc.C:
	* text3.C: The Box patch. Fancybox support, minipage, parbox

2003-10-07  Martin Vermeer <martin.vermeer@hut.fi>

	* CutAndPaste.h:
	* DepTable.h:
	* FloatList.h:
	* LaTeXFeatures.h:
	* ParagraphParameters.h:
	* TextCache.h:
	* Thesaurus.h:
	* bufferlist.h:
	* exporter.h:
	* importer.h:
	* lastfiles.h:
	* lyxfind.h:
	* lyxfont.h:
	* lyxlex.h:
	* lyxtextclasslist.h:
	* messages.h:
	* paragraph.h:
	* paragraph_pimpl.C:
	* textcursor.h: add <string> and other small fixes to make Lars'
	std::string patch compile with STLport.

2003-10-06  Angus Leeming  <leeming@lyx.org>

	* LColor.h: Add missing #include <string>.

2003-10-06  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* All most all file in all subdirs: Make <string> be the prefered
	way of getting to std::string, add using declarations.

2003-10-06  André Pönitz  <poenitz@gmx.net>

	* metricsinfo.C: initialize LyXFont before changing attribute.
	(fixes the 'math in \emph is upright' bug)

2003-10-06  André Pönitz  <poenitz@gmx.net>

	* tabular.[Ch]: saner reinitialization, ret rid of LyXTabular::owner_

2003-10-06  Martin Vermeer  <martin.vermeer@hut.fi>

	* graph.C:
	* paragraph_pimpl.C: Small fixes to build using STLport

2003-10-02  André Pönitz  <poenitz@gmx.net>

	* lyxfunc.C:
	* text3.C: move handling of LFUN_DEPTH *; fix #1360

2003-10-01  André Pönitz  <poenitz@gmx.net>

	* factory.C: assert early

2003-09-26  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyx_main.C: remove the global debug object

	* debug.h: adjust for new debugstream

	* debug.C: adjust for new debugstream and keep the global debug
	object here.

2003-09-22  Angus Leeming  <leeming@lyx.org>

	* paragraph_pimpl.h: add #include "lyxfont.h". Needed by earlier versions
	of g++ which otherwise complain that the scoped_ptr destructor can't delete
	an incomplete class LyXFont.

2003-09-22  Martin Vermeer  <martin.vermeer@hut.fi>

	* factory.C: bug fix in branches

2003-09-22  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxfunc.C (processKeySym): adjust
	(dispatch): adjust
	(dispatch): change arg name from ev to func, adjust
	(sendDispatchMessage): ditto

	* lyx_main.C (defaultKeyBindings): adjust keybindings
	(deadKeyBindings): ditto

	* kbsequence.C (addkey): return a FuncRequest

	* kbmap.h (kb_key): struct var FuncRequest instead of int action.

	* kbmap.C (bind): take a FuncRequest as arg, adjust
	(read): adjust
	(lookup): adjust
	(defkey): change to take a FuncRequest as arg, adjust
	(findbinding): take a FuncRequest as arg, adjust.

	* funcrequest.h (operator=): added

	* funcrequest.C (FuncRequest): default kb_action changed from
	LFUN_UNKNOWN_ACTION to LFUN_NO_ACTION

	* buffer.C (dispatch): simplify
	(dispatch): adjust to take a FuncRequest as arg, adjust

	* boost.C (assertion_failed): change assertion message slightly

	* ToolbarBackend.C (read): simplify

	* MenuBackend.C (binding): adjust call to findbinding, add a
	message if no binding is found.
	(read): simplify
	(expandToc): correct by adding a empty FuncRequest

	* LyXAction.C: include <boost/assert.hpp>
	(isPseudoAction): delete function
	(LookupFunc): change name to...
	(lookupFunc): this. change return type to FuncRequest.
	(getActionName): take kb_action as arg, simplify
	(funcHasFlag): add an assert, simplify.

2003-09-21  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* toc.C (action): return a FuncRequest, simplify

	* lyxfunc.C (processKeySym): adjust
	(getStatus): delete version that takes an int.
	(getStatus): adjust
	(dispatch): delete version that takes action as int
	(dispatch): adjust
	(sendDispatchMessage): simplify and adjust

	* funcrequest.C (getArg): take unsigned int as arg

	* ToolbarBackend.C (read): adjust
	(add): delete version that takes func as a string.
	(getIton): take a FuncRequest as arg

	* MenuBackend.h (MenuItem): store a FuncRequest instead of an int
	action.

	* MenuBackend.C (MenuItem): add a new construct that only takes a
	Kind, simplify the constructor use for submenus.
	(add): adjust
	(expandLastfiles): adjust
	(expandDocuments): adjust
	(expandFormats): adjust
	(expandFloatListInsert): adjust
	(expandFloatInsert): adjust
	(expandToc2,expandToc,expandPasteRecent,expandBranches): adjust

	* LyXAction.h: remove typdefs pseudo_map, arg_item and arg_map.
	Remove class variables lyx_pseudo_map and lyx_arg_map

	* LyXAction.C (searchActionArg): delete function
	(getPseudoAction): delete function
	(retrieveActionArg): delete function
	(LookupFunc): make it return kb_action, simplify.
	(getActionName): simplify

	* factory.C (createInset): fix new bug

2003-09-19  Angus Leeming  <leeming@lyx.org>

	* CutAndPaste.C (pasteSelection): remove fudge used to set the
	masterFilename_ parameter in the include inset.

	* factory.C (createInset): changes due to the changes to InsetInclude.

2003-09-19  Juergen Spitzmueller  <j.spitzmueller@gmx.de>

	* paragraph.C: use appropriate alignment tags inside floats (bug 1290)

2003-09-18  Angus Leeming  <leeming@lyx.org>

	* buffer.C:
	* BufferView.C: pass the buffer when calling Inset::getLabelList,
	Inset::fillWithBibKeys.
	* tabular.[Ch] (getLabelList): receive, pass on a Buffer const & arg.

2003-09-18  Angus Leeming  <leeming@lyx.org>

	* LaTeXFeatures.[Ch]: append a '_' to the names of all private member
	variables.
	(ctor): pass and store a 'Buffer const &'
	(buffer): new member function.

	* buffer.C (makeDocBookFile, makeLinuxDocFile, makeLaTeXFile): pass
	'*this' to the LaTeXFeatures ctor.

2003-09-18  Angus Leeming  <leeming@lyx.org>

	* LColor.h:
	* lyxfont.C:
	* lyxfont.h:
	* lyxtext.h:
	* text.C: rename EnumLColor as LColor_color.

2003-09-18  Angus Leeming  <leeming@lyx.org>

	* cursor.[Ch]: use the dispatch_result wrapper class DispatchResult to
	remove #include "insets/insetbase.h" from cursor.h.

2003-09-18  Angus Leeming  <leeming@lyx.org>

	* paragraph.[Ch] (insetAllowed): use the InsetOld::Code wrapper class
	InsetOld_code to remove #include "inset.h".

	* iterators.C: add #include "insets/inset.h"

2003-09-16  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView.C: remove more locking stuff that apparently doesn't
	do anything sensible.

2003-09-16  André Pönitz  <poenitz@gmx.net>

	* paragraph.[Ch]:
	* paragraph_pimpl.[Ch]: un-pimpl Paragraph::(Pimpl::)text for a >10%
	  performance boost.

2003-09-16  Angus Leeming  <leeming@lyx.org>

	* lyxfont.h (LyXFont_size): a wrapper class for LyXFont::FONT_SIZE.

	* paragraph.[Ch] (highestFontInRange): use LyXFont_size as function
	arg/return type.

	* paragraph.h: remove #include "lyxfont.h". Forward declare
	LyXFont_size.

2003-09-16  Angus Leeming  <leeming@lyx.org>

	* paragraph.C (IsInsetChar): new function in namespace anon, moved out
	of support/textutils.h.
	(isWord): move the contents of support/textutils.h's IsWordChar here.

	* buffer.C:
	* lyxfind.C:
	* rowpainter.C:
	* text.C:
	* text2.C: add #include "paragraph.h".

	* rowpainter.C:
	* text.C: replace IsInsetChar(c) with a direct test of Paragraph::META_INSET.

2003-09-16  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* main.C:
	* lyx_main.C:
	* lyx_cb.C:
	* buffer.C:
	* LaTeX.C: use namespace alias for lyx::support::os

2003-09-16  Angus Leeming  <leeming@lyx.org>

	* bufferparams.C:
	* bufferview_funcs.C:
	* factory.C:
	* lyxfunc.C:
	* paragraph_pimpl.C:
	* rowpainter.C:
	* text.C: add #include "LColor.h".

2003-09-16  Angus Leeming  <leeming@lyx.org>

	* lyxfont.[Ch]: (setFamily, setSeries, setShape, setSize, setEmph,
	setUnderbar, setNoun, setNumber, setColor, setLanguage): no longer
	return LyXFont &.
	Store the FontBits::color variable as an int rather than as an
	LColor::colorso that we can move LColor.h out of the lyxfont.h header
	file.

	* rowpainter.C (paintAppendixStart, paintPageBreak, paintLengthMarker):
	LyXFont::setColor, decSize no longer return a LyXFont &, so cannot
	string calls together.

	* lyxrc.C: add #include "LColor.h".

2003-09-15  Angus Leeming  <leeming@lyx.org>

	* bufferparams.[Ch]: store the pimpl_ as a copied_ptr, rather than as
	a cow_ptr.

2003-09-15  Angus Leeming  <leeming@lyx.org>

	* LColor.h: add an EnumLColor wrapper for LColor::color.

	* lyxfont.[Ch] (color, setColor, realColor):
	* lyxtext.h, text.C (backgroundColor):
	pass EnumLColor args to/from the functions, rather than LColor::color
	ones.

	* lyxfont.h:
	* lyxtext.h: forward declare EnumLColor.

	* lyx_main.C: add #include "LColor.h".

2003-09-15  Angus Leeming  <leeming@lyx.org>

	* .cvsignore: add lyx-gtk.

2003-09-15  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* Chktex.C
	* LaTeX.C
	* LaTeXFeatures.C
	* ParagraphParameters.C
	* Spacing.C
	* buffer.C
	* bufferparams.C
	* bufferview_funcs.C
	* chset.C
	* counters.C
	* funcrequest.C
	* lyxfont.C
	* lyxgluelength.C
	* lyxlength.C
	* paragraph.C
	* paragraph_funcs.C
	* text3.C
	* vc-backend.C: remove usage of STRCONV

2003-09-15  Angus Leeming  <leeming@lyx.org>

	* rowpainter.C (paintLengthMarker, paintPageBreak, paintAppendixStart):
	explicitly define the color passed to the painter.

2003-09-15  Angus Leeming  <leeming@lyx.org>

	* bufferparams.C (BufferParams): reorder member initializers to avoid
	compiler warning.

2003-09-15  Alfredo Braunstein  <abraunst@libero.it>

	* CutAndPaste.C (pasteSelection): remove an outdated #warning
	* text.C (updateRowPositions): remove an unusual nop

2003-09-12  André Pönitz  <poenitz@gmx.net>

	* BufferView_pimpl.C:
	* Bullet.C:
	* layout.h:
	* lyxfunc.C:
	* lyxlayout.[Ch]:
	* lyxtextclass.C:
	* rowpainter.C:
	* text.C:
	* text2.C:
	* Counters.[Ch]: finish the 'automatic counters' job

2003-09-12  Juergen Spitzmueller  <j.spitzmueller@gmx.de>

	* aspell.C: include <boost/assert.cpp> (compile fix)

2003-09-10  Rob Lahaye  <lahaye@snu.ac.kr>

	* boost.C (assertion_failed): use lyx::support::abort instead of
	assert.

2003-09-10  Angus Leeming  <leeming@lyx.org>

	* Makefile.am (lyx_SOURCES): replace ParagraphList.h and RowList.h
	with their _fwd progeny.

2003-09-09  Angus Leeming  <leeming@lyx.org>

	134 files throughtout the source tree: replace 'using namespace abc;'
	directives with the appropriate 'using abc::xyz;' declarations.

2003-09-09  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* boost.C (emergencyCleanup): moved here from LAssert.c
	(assertion_failed): new function, called by BOOST_ASSERT

	* several files: change Assert to BOOST_ASSERT

2003-09-09  Angus Leeming  <leeming@lyx.org>

	* buffer.[Ch]: Add an Impl class and move Buffer's member
	variables into it. As a result move several header files out of
	buffer.h.

	Add header files to lots of .C files all over the tree as a result.

2003-09-09  Angus Leeming  <leeming@lyx.org>

	* buffer.[Ch]: make Buffer's member variables private. Add
	accessor functions.

	Lots of changes all over the tree as a result.

2003-09-08  Angus Leeming  <leeming@lyx.org>

	* graph.C: #include <config.h>.

2003-09-08  Angus Leeming  <leeming@lyx.org>

	* BranchList.C:
	* BufferView.C:
	* BufferView_pimpl.C:
	* CutAndPaste.C:
	* DepTable.C:
	* LaTeX.C:
	* LaTeXFeatures.C:
	* LyXAction.C:
	* MenuBackend.C:
	* TextCache.C:
	* aspell.C:
	* buffer.C:
	* bufferlist.C:
	* changes.C:
	* chset.C:
	* converter.C:
	* counters.C:
	* debug.C:
	* graph.C:
	* ispell.C:
	* lyx_cb.C:
	* lyxfind.C:
	* lyxfunc.C:
	* lyxlex_pimpl.C:
	* lyxrc.C:
	* lyxrow.C:
	* paragraph.C:
	* rowpainter.C:
	* texrow.C:
	* text.C:
	* text2.C:
	* toc.C: remove redundant using directives.

2003-09-07  Angus Leeming  <leeming@lyx.org>

	* LaTeXFeatures.h: remove #include "support/types.h".
	* ToolbarBackend.h: remove #include <algorithm>.
	* changes.h: remove #include <ctime>.
	* debug.h: remove #include <iosfwd>.
	* graph.h: remove #include "support/std_string.h".
	* lyx_main.h: remove #include <csignal>.
	* lyxlex_pimpl.h: remove #include <fstream>.
	* sgml.h: remove #include <algorithm>, <utility>.
	* toc.h: remove #include "support/std_ostream.h".
	Add #include <iosfwd>.

2003-09-07  Angus Leeming  <leeming@lyx.org>

	* vspace.[Ch] (length): returns a const & to a LyXGlueLength.

	* converter.h: forward declare LatexRunParams.
	* encoding.h: remove #include "lyxrc.h".
	* lyxtext.h: remove #include "LColor.h".
	* lyxtextclass.h: remove #include "support/types.h".
	* trans.h: remove #include "tex-accent.h".
	* trans_mgr.h: remove #include "tex-accent.h".
	* insets/inset.h: remove #include "support/types.h", <vector>.
	* insets/insetcollapsable.h: remove #include "LColor.h".
	* insets/insetinclude.h: remove #include "dimension.h".
	* insets/insetlatexaccent.h: remove #include "dimension.h".
	* insets/insetoptarg.h:: remove #include "insettext.h".
	* insets/insettext.h: remove #include "dimension.h",
	<boost/shared_ptr.hpp>

	* insets/renderers.h: add #include "dimension.h".
	* insets/updatableinset.h: add #include "support/types.h".

	* many .C files: Associated changes.

2003-09-06  Angus Leeming  <leeming@lyx.org>

	* Bullet.[Ch]: factorize all those #ifdef ENABLE_ASSERTIONS to just
	one, inside testInvariant.

	* PrinterParams.C: new file.
	* PrinterParams.[Ch]: move the function bodies out of line.

2003-09-06  Angus Leeming  <leeming@lyx.org>

	* ParagraphParameters.h: forward declare ParameterStruct rather than
	including its header file.
	(depth): moved out-of-line.

2003-09-06  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.h:
	* kbmap.h:
	* kbsequence.h:
	* lyxfunc.h: forward declare LyXKeySym rather than
	#include "frontends/LyXKeySym.h".

	* BufferView_pimpl.C:
	* kbmap.C:
	* kbsequence.C:
	* lyxfunc.C: associated changes.

2003-09-06  Angus Leeming  <leeming@lyx.org>

	* BufferView.[Ch] (ChangeInsets): moved to BufferView_pimpl.[Ch].
	As a result, can remove the #include "insets/inset.h" from BufferView.h

2003-09-06  Angus Leeming  <leeming@lyx.org>

	* BufferView.[Ch] (ChangeInsets): moved to BufferView_pimpl.[Ch].
	As a result, can remove the #include "insets/inset.h" from BufferView.h

2003-09-06  Angus Leeming  <leeming@lyx.org>

	* buffer_funcs.C:
	* buffer.h:
	* bufferlist.C:
	* BufferView.C:
	* bufferview_funcs.C:
	* BufferView_pimpl.C:
	* CutAndPaste.C:
	* lyx_cb.C:
	* lyxfunc.C:
	* paragraph.h:
	* ParagraphParameters.C:
	* tabular.C:
	* text3.C:
	* toc.C:
	* undo_funcs.C:
	* frontends/controllers/ControlDocument.C:
	* insets/insetcaption.C: rearrange the #includes into some sort of
	coherent order.

	* buffer.h: remove #includes ErrorList.h, undo.h

2003-09-06  Angus Leeming  <leeming@lyx.org>

	* support/types.h: add a 'depth_type' typedef, used to store the
	nesting depth of a paragraph.

	* paragraph.h:
	* ParameterStruct.h: use this lyx::depth_type typedef rather than
	defining explicitly.

	* buffer.h:
	* paragraph_funcs.h:
	* ParagraphParameters.h:
	* sgml.h: use lyx::depth_type rather than Paragraph or
	ParameterStruct's depth_type.

	* buffer.h
	* paragraph_funcs.h: no need to #include paragraph.h anymore.

	* BufferView.C:
	* BufferView_pimpl.C:
	* CutAndPaste.C:
	* ParagraphParameters.C:
	* buffer_funcs.C:
	* bufferlist.C:
	* bufferview_funcs.C:
	* lyx_cb.C:
	* lyxfunc.C:
	* tabular.C:
	* text3.C:
	* toc.C:
	* undo_funcs.C:
	* frontends/LyXView.C:
	* frontends/controllers/ControlDocument.C:
	* frontends/controllers/ControlErrorList.C:
	* insets/insetbibitem.C:
	* insets/insetbranch.C:
	* insets/insetcaption.C:
	* insets/insetcollapsable.C:
	* insets/insetenv.C:
	* insets/insetert.C:
	* insets/insetfloat.C:
	* insets/insetfoot.C:
	* insets/insetfootlike.C:
	* insets/insetnewline.C:
	* insets/insetquotes.C:
	* insets/insettabular.C:
	* insets/insettext.C:
	* insets/insetwrap.C: must now explicitly #include "paragraph.h".

	* frontends/controllers/ControlChanges.C: #include "changes.h".

2003-09-06  Angus Leeming  <leeming@lyx.org>

	* ParagraphList_fwd.h: new file, forward-declaring Paragraph rather
	than #including paragraph.h.

	* ParagraphList.h:
	* RowList.h: deleted. Superfluous.

	* CutAndPaste.h:
	* iterators.h:
	* lyxcursor.h:
	* lyxtext.h:
	* text_funcs.h:
	* undo.h:
	* undo_funcs.h:
	* insets/inset.h:
	* insets/insettext.h: use ParagraphList_fwd.h rather than
	ParagraphList.h.

	* paragraph.h: don't forward declare ParagraphList.

	* buffer.h:
	* paragraph_funcs.h: #include ParagraphList_fwd.h and paragraph.h
	rather than ParagraphList.h. paragraph.h is still needed for the
	Paragraph::depth_type parameters.

	* textcursor.h: enable it to compile stand-alone in light of the
	above changes.

	* bufferview_funcs.C:
	* iterators.C:
	* lyxfunc.C:
	* lyxrow_funcs.C:
	* paragraph.C:
	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C:
	* text_funcs.C:
	* textcursor.C:
	* undo.C:
	* frontends/controllers/ControlParagraph.C:
	* frontends/controllers/ControlTabular.C:
	* insets/insetmarginal.C:
	* insets/insetminipage.C:
	* insets/insetnote.C:
	* insets/insetoptarg.C: add header files needed to compile again.

2003-09-06  Angus Leeming  <leeming@lyx.org>

	* RowList_fwd.h: new file, forward-declaring Row rather than
	#including lyxrow.h.

	* lyxrow_funcs.h:
	* lyxtext.h:
	* paragraph.h:
	* insets/insettext.h: use it instead of RowList.h

	* bufferview_funcs.C:
	* lyxfunc.C:
	* lyxrow_funcs.C:
	* paragraph.C:
	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C: #include "RowList.h".

2003-09-05  Angus Leeming  <leeming@lyx.org>

	* factory.C (createInset):
	* vspace.C (c-tor): replace sscanf call with an istringstream.
	* ispell.C: re-add missing HP/UX headers.
	* lyxserver.C: re-add missing  os2 headers.

2003-09-05  Martin Vermeer  <martin.vermeer@hut.fi>

	* BranchList.C:
	* graph.C:
	* ispell.C:
	* lastfiles.C:
	* lyx_cb.C:
	* lyxserver.C:
	* texrow.C:
	* text3.C: re-add missing system headers, needed for 2.95.2.

2003-09-05  Angus Leeming  <leeming@lyx.org>

	Changes most place everywhere due to the removal of using directives
	from support/std_sstream.h.

2003-09-05  Angus Leeming  <leeming@lyx.org>

	Replace LString.h with support/std_string.h,
	Lsstream.h with support/std_sstream.h,
	support/LIstream.h with support/std_istream.h,
	support/LOstream.h with support/std_ostream.h.

	Changes resulting throughout the tree.

2003-09-05  Angus Leeming  <leeming@lyx.org>

	* sgml.h: ensure that the header file can be compiled stand-alone.
	* *.C: strip out redundant #includes. (320 in total.)

2003-09-04  Angus Leeming  <leeming@lyx.org>

	* LaTeXFeatures.C (getMacros): move the output of the preamble_snippets
	here (from getPackages).

	* debug.[Ch]: add a new EXTERNAL tag.

2003-09-04  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* text2.C (cursorEnd): simplify
	(setCursor): adjust
	(getColumnNearX): adjust

	* text.C (computeBidiTables): adjust
	(fill): adjust

	* rowpainter.C (paintChars): adjust
	(paintSelection): adjust
	(paintChangeBar): adjust
	(paintText): adjust

	* lyxrow_funcs.C (lastPrintablePos): remove, all users now call
	lastPos instead.
	(numberOfSeparators): adjust

2003-09-03  Martin Vermeer  <martin.vermeer@hut.fi>

	* LyXAction.C:
	* box.[Ch]:
	* lfuns.h:
	* lyxfunc.C:
	* text3.C: Restricts the mouse click functionality
	of insets like bibtex, include, toc and floatlist to the visible
	button, and allows the use of LFUN_INSET_SHOW_DIALOG to bring
	up the dialogs. Cursor has to be in front of the inset (i.e.
	start of row) for this to function.

2003-09-04  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* bufferview_funcs.C (currentState): output row information

2003-09-04  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* bufferview_funcs.C (currentState): output paragraph position

2003-09-04  Angus Leeming  <leeming@lyx.org>

	* FloatList.h: move out #include "Floating.h".
	* LaTeX.h: move out #include "DepTable.h".
	* LyXAction.h: move out #include "funcrequest.h".
	* buffer.h: move out #include "author.h", "iterators.h".
	* bufferparams.h: move out #include "LaTeXFeatures.h", "texrow.h".
	* lyx_main.h: move out #include "errorlist.h".
	* lyxfunc.h: move out #include "FuncStatus.h".
	* lyxtext: move out #include "lyxcursor.h".
	* paragraph_pimpl.h: move out #include "counters.h".

2003-09-03  Angus Leeming  <leeming@lyx.org>

	* LaTeXFeatures.[Ch]: replace the externalPreambles string with a
	preamble_snippets list, enabling us to add snippets to the preamble
	only if the snippet was not there already.

2003-09-04  Angus Leeming  <leeming@lyx.org>

	* Chktex.C, converter.C, lyx_cb.C: add #include "support/lyxlib.h".

2003-09-03  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxfunc.C (dispatch): if fitCursor did something be sure to
	update

2003-09-03  Martin Vermeer  <martin.vermeer@hut.fi>

	* BranchList.C: point fix, earlier forgotten

2003-09-02  Angus Leeming  <leeming@lyx.org>

	* box.C (contains): renamed from 'contained' after a fantastic
	amount of hot air.

2003-09-02  John Levon  <levon@movementarian.org>

	* BufferView.C:
	* lyxcursor.h:
	* lyxcursor.C:
	* lyxfunc.C:
	* lyxfunc.h: remove cursor.i[x]y(), it no longer differs

2003-09-02  John Levon  <levon@movementarian.org>

	* text2.C: simplification of cursorEnd(), including partial
	fix for bug 1376

2003-09-02  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* buffer.C (readFile): add a space

2003-09-02  Alfredo Braunstein  <abraunst@libero.it>

	* BufferView_pimpl.C (update): remove bogus fitCursor() call

2003-09-02  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* buffer.C (readFile): new function, take a filename and a
	ParagraphList::iterator
	(readFile): adjust
	(readFile): adjust, make it private. don't use setStream, make
	lyx2lyx use a temporary file. Some simplificaton. Make the Alerts
	always contain the filename.

	* BufferView.C (insertLyXFile): simplify and make it work for
	gzipped files.

2003-08-30  John Levon  <levon@movementarian.org>

	* Makefile.am: fix dist (from Kayvan)

2003-08-28  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* most files: change to use const Buffer refs

2003-08-27  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch]: remove getParentText, implement getParentLanguage
	on top of ownerPar().

2003-08-27  John Levon  <levon@movementarian.org>

	* funcrequest.C: properly initialise POD members

2003-08-27  Alfredo Braunstein  <abraunst@libero.it>

	* lyxtext.h (top_y): move top_y from here
	* text.C:
	* text2.C:
	* text3.C:
	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]: to here
	* frontends/screen.C:
	* insets/insettabular.C:
	* insets/insettext.C: adjust
	* rowpainter.[Ch] (paintRows): remove LyXText & argument

2003-08-27  Alfredo Braunstein  <abraunst@libero.it>

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch] (updateInset): add an InsetOld * argument

2003-08-26  André Pönitz  <poenitz@gmx.net>

	* paragraph_func.[Ch] (outerPar): new function

	* paragraph.C:
	* paragraph_funcs.C:
	* paragraph_funcs.h:
	* paragraph_pimpl.C:
	* text2.C: remove Inset::par_owner

2003-08-25  Martin Vermeer  <martin.vermeer@hut.fi>

	* lyxrow_funcs.C:
	* lyxtext.h:
	* text.C:
	* text2.C: eliminates the needFullRow/display() stuff
	altogether, putting the logic in metrics/draw in the insets.

2003-08-25  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (redoParagraphInternal, redoParagraphs):
	* text.C (redoParagraph): add a call to	updateRowPositions at the
	end of each 'metrics-like' call. Remove all others.
	(getRow): remove the 'y-computing' version.
	(getRowNearY): do not compute nor return the real y. Solve the
	'y < 0' problem and simplify.

2003-08-22  Angus Leeming  <leeming@lyx.org>

	* *.[Ch]: clean-up of licence and author blurbs.
	Also move config.h out of a few .h files and into a few .C files.

2003-08-22  André Pönitz  <poenitz@gmx.net>

	* lyxrow.[Ch]: add x_ and *fill_ members

	* lyxtext.h:
	* text.C:
	* rowpainter.C:
	* text2.C: adjust/remove prepareToPrint() calls

2003-08-22  André Pönitz  <poenitz@gmx.net>

	* lyxrow.[Ch]: add  end_ member

	* lyxrow_funcs.C: use LyXRow::end_

	* lyxtext.h (singleWidth): add LyXFont parameter

	* rowpainter.C:
	* text2.C: adjust LyXText::singleWidth() calls

	* text.C (redoParagraph): simplify row breaking logic


2003-08-19  André Pönitz  <poenitz@gmx.net>

	* funcrequest.C: initialize button_ member

	* text3.C:
	* rowpainter.[Ch]: interface consolidation

2003-08-18  André Pönitz  <poenitz@gmx.net>

	* BufferView.C:
	* BufferView_pimpl.C:
	* lyxfind.C:
	* paragraph_funcs.C:
	* rowpainter.C:
	* text3.C: remove LyXScreen::draw() and fitCursor calls

	* BranchList.h: remove spurious semicolons

	* MenuBackend.C: fix branchlist related crash

2003-08-17  Martin Vermeer  <martin.vermeer@hut.fi>

	* BranchList.[Ch]:
	* InsetList.[Ch]:
	* LColor.[Ch]:
	* LyXAction.C:
	* Makefile.am:
	* MenuBackend.[Ch]:
	* bufferparams.[Ch]:
	* factory.C:
	* lfuns.h:
	* lyxfunc.C:
	* text3.C: implements the 'branch inset'
	idea. This allows the output of various versions of a document
	from a single source version, selectively outputing or suppressing
	output of parts of the text.
	This implementation contains a 'branch list editor' in a separate
	tab of the document settings dialog. Branches are user definable
	and have a "display colour" to distinguish them on-screen.

	ColorHandler was somewhat cleaned up.
	(1) make possible a dynamically growing LColor list by allowing
	the graphic context cache to grow along (vector);
	(2) eliminate an IMHO unnecessary step in colour allocation.

2003-08-15  Kayvan A. Sylvan <kayvan@sylvan.com>

	* BufferView_pimpl.C: compile fix

2003-08-15  André Pönitz  <poenitz@gmx.net>

	* rowpainter.C: remove extra metrics calls

	* lyxtext.h: merge the two constructors into a single one,
	  pass reference to owner's par list

	* BufferView_pimpl.C:
	* text.C:
	* text2.C: adjust

2003-08-15  André Pönitz  <poenitz@gmx.net>

	* lyxrow_funcs.[Ch]:
	* lyxtext.h:
	* paragraph.h:
	* paragraph_funcs.C:
	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C:
	* text_funcs.C: split LyXText::rowlist_ into individual
	Paragraph::rows_ chunks

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]:
	* lyxfind.C:
	* lyxtext.h:
	* text3.C: remove toggleSelection()

2003-08-12  Michael Schmitt  <michael.schmitt@teststep.org>

	* bufferlist.C: beautify two alerts (shorter text of buttons)
	* buffer.C: Remove redundant ' ' from message
	* tabular.h:
	* tabular.C: rename LYX_VALIGN_CENTER" to LYX_VALIGN_MIDDLE";
	rename M_VALIGN_CENTER to M_VALIGN_MIDDLE;
	rename VALIGN_CENTER to VALIGN_MIDDLE

2003-08-11  André Pönitz  <poenitz@gmx.net>

	* lyxtext.h (getPar):
	* text.C: new function

2003-08-11  André Pönitz  <poenitz@gmx.net>

	* Makefile.am:
	* tracer.[Ch]: remove unneeded files

	* InsetList.[Ch]: remove resizeInsetsLyXText()

	* lyxtext.h:
	* text.C:
	* text2.C:
	* text3.C: merge insertParagraphs() and appendParagraph()
	remove breakAgain(), update()

	* BufferView_pimpl.[Ch]:
	* bufferview_funcs.[Ch]:
	* lyxfunc.C:
	* paragraph.[Ch]:
	* rowpainter.C:
	* tabular.C: adjust after text & InsetList changes.

2003-08-08  André Pönitz  <poenitz@gmx.net>

	* text.C (insertChar, backspace): replace rowlist fiddling
	with rebreak of full par

	* lyxtext.h:
	* text.C (breakAgainOneRow, redoHeightOfParagraph,
	checkParagraph, updateInset): removed

2003-08-07  André Pönitz  <poenitz@gmx.net>

	* paragraph.C:
	* text3.C: merge some LFUN handlers, remove dead code

2003-08-06  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* .cvsignore: add lyx-xforms, lyx-qt, version.C-tmp and stamp-version

2003-08-05  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (DEPM): fix part of bug 1255 and 1256

2003-08-05  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView_pimpl.C (workAreaDispatch): change to use
	LyXView::dispatch instead of BufferView::Pimpl::dispatch for lfuns
	that are no mouse related.

2003-08-05  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]:
	* bufferview_funcs.C:
	* text2.C:
	* text3.C: rip out "deep update"

	* textcursor.[Ch] (last_sel_cursor): remove unused member

2003-08-04  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]:
	* ParagraphParameters.C:
	* bufferview_funcs.C:
	* lyx_cb.C:
	* lyxfind.C:
	* lyxfunc.C:
	* text.C:
	* text2.C:
	* text3.C: replace "complicated" BufferView::update(...) calls with
	simpler ones.

	* BufferView.[Ch]: remove now unneeded BufferView::UpdateCodes

2003-08-02  Kayvan Sylvan  <kayvan@sylvan.com>

	* Makefile.am (lyx_SOURCES): add paper.h

2003-08-02  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* Makefile.am: move things around so that both lyx-qt and
	lyx-xforms can be built (according to --with-frontend). Then lyx
	is a symbolic link to lyx-[firstfrontend]

2003-08-02  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* Always use std::endl with lyxerr

2003-08-01  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* BufferView_pimpl.C: _Always_ use std::endl with lyxerr

2003-08-01  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]:
	* lyxfunc.C:
	* text3.C: merge BufferView::repaint() and BufferView::update()

2003-08-01  José Matos  <jamatos@lyx.org>

	* buffer.[Ch]: file_format is no longer a buffer data element.

2003-08-01  André Pönitz  <poenitz@gmx.net>

	* BufferView.C:
	* lyxtext.h:
	* text.C:
	* text2.C: make redoParagraph more independent of current cursor

	* lyxtext.h (need_update, needUpdate, postPaint, clearPaint):
	* text.C:
	* text2.C: remove unneeded members

2003-07-30  André Pönitz  <poenitz@gmx.net>

	* paragraph.[Ch] (copyIntoMinibuffer): removed unused function

	* paragraph.[Ch] (cutIntoMinibuffer, insertFromMinibuffer):
	  create a single function...

	* paragraph_funcs.C (moveItem): ... here.

	* text.C:
	  lyxtext.h (LyXText::workWidth(InsetOld*)) remove. unused.

2003-07-30  Martin Vermeer  <martin.vermeer@hut.fi>

	* LColor.[Ch]: Add comment and greyedout logical colors.

2003-07-30  André Pönitz  <poenitz@gmx.net>

	* tabular.C: don't use Assert too heavily. This crashes where it
	  shouldn't

2003-07-30  Alfredo Braunstein  <abraunst@libero.it>

	* lyxfunc.C (dispatch): do not mark the buffer dirty if the action
	is disabled (bug 1232)

2003-07-30	Martin Vermeer  <martin.vermeer@hut.fi>

	* factory.C: limited 'arg' scope

2003-07-30	Martin Vermeer  <martin.vermeer@hut.fi>

	* factory.C: fixed Note submenu issues

2003-07-30	Martin Vermeer  <martin.vermeer@hut.fi>

	* factory.C: submenu for Note/Comment/Greyedout

2003-07-29  Alfredo Braunstein  <abraunst@libero.it>

	* lyx_main.C (LyX):
	* BufferView_pimpl.C (loadLyXFile): fix to bugs 1287 and 1297 + ws

2003-07-29  Martin Vermeer  <martin.vermeer@hut.fi>

	* LaTeXFeatures.C:
	* lyx_sty.[Ch]:h: Implement a newenvironment in preamble for
	greyedout. Patch provided by Jürgen Spitzmüller.

2003-07-29  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* kbmap.C (read): fix error message when reading bind files

2003-07-29  Angus Leeming  <leeming@lyx.org>

	* BufferView.[Ch] (ChangeCitationsIfUnique): This function most
	certainly does not do what it purports to do. I am doing it, and
	us, a favour by killing it.

2003-07-28  José Matos  <jamatos@lyx.org>

	* buffer.C (readBody, do_writeFile):
	* paragraph.C(readParagraph): \end_document replaces \the_end.

2003-07-29  André Pönitz  <poenitz@gmx.net>

	* BufferView.[Ch]:
	* BufferView_pimpl.[Ch]:
	* lyxfunc.C:
	* text2.C:
	* text3.C:
	* textcursor.[Ch]: remove toggleToggle & Co

2003-07-28  José Matos  <jamatos@fep.up.pt>

	* buffer.C (readParagraph):
	* params_func (readParToken, readParagraph):
	* paragraph.C (write): \layout -> \begin_layout.

2003-07-28  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxlex_pimpl.C (setFile): clean up slightly.

	* bufferparams.h: add compressed var

	* buffer_funcs.C (readFile): adjust for Lexer change
	(newFile): ditto + simplify

	* buffer.C (writeFile): handle writing of compressed files

	* buffer.[Ch] (readFile): begin Lexer here, remove one argument.
	Check if the file is compressed and set a bufferparm if so.

	* Makefile.am (lyx_LDADD): remove explicit -lz

2003-07-28  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* buffer.C (do_writeFile, makeLaTeXFile, makeLinuxDocFile,
	makeDocBookFile): put the real LyX version in the first line of
	the file

	* version.h:
	* version.C.in: remove lyx_docversion

	* tabular.C (write_attribute): add a template-based version to
	write enums properly

2003-07-28  André Pönitz  <poenitz@gmx.net>

	* lyxtext.h:
	* text.C:
	* text2.C:
	* text3.C: use doubles again for x-coordinates. They are needed.

2003-07-28  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* messages.C (getLocaleDir): use lyx_localedir()

	* lyxlex_pimpl.C (setFile): compress stuff

	* buffer.C (writeFile): add some compression stuff
	(do_writeFile): new func, dont call expliti close... will this
	breake anything?

	* Makefile.am (lyx_LDADD): add -lz

2003-07-28  José Matos  <jamatos@fep.up.pt>

	* buffer.C: increment file format.
	* paragraph_funcs (readParagraph, readParToken):
	* paragraph.C (readParagraph): add \end_layout.

2003-07-27  Angus Leeming  <leeming@lyx.org>

	* Makefile.am: remove special casing for configure-time setting of
	LYX_DIR, TOP_SRCDIR and LOCALEDIR.

	* lyx_main.C (init): remove all Jean-Marc's magic setting of
	system_lyxdir, build_lyxdir and user_lyxdir into the support lib.

2003-07-26  André Pönitz  <poenitz@gmx.net>

	* paragraph_func.[Ch]:
	* paragraph.C (realizeFont): inline it whereever it is used

	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C: remove Buffer * parameter from a bunch of get*Font functions


2003-07-26  André Pönitz  <poenitz@gmx.net>

	*	lyxtext.h:
	* text.C:
	* text2.C: get rid of LyXText::need_break_row

2003-07-27  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* toc.[Ch]: put namespace toc inside namespace lyx

	* MenuBackend.C (expandToc2): adjust for lyx::toc
	(expandToc): ditto

	* lyxfunc.C (dispatch): adjust for lyx::find

	* lyxfind.[hC]: get rid of namespace lyxfind introduce namespace
	lyx::find instead. Reorganize a bit.
	(LyXReplace): rename to replace
	(LyXFind): rename to find

	* BufferView_pimpl.C (trackChanges): adjust for lyx::find
	(dispatch): ditto

2003-07-26  André Pönitz  <poenitz@gmx.net>

	* text.C (setHeightOfRow): restrict scope of temporary variable

	* paragraph_funcs.C (readParToken): remove USE_CAPTION  compatibility
	  code (never has been used?)

2003-07-27  Asger Alstrup  <alstrup@local>

	* text.C (fill): Optimise algorithm to exploit that we can reuse
	the LyXFont for many characters.
	(setHeightOfRow): Same thing.
	(rowBreakPoint): Same thing.

2003-07-26  Asger Alstrup  <alstrup@local>

	* text2.C (metrics): change a brain-dead algorithm to a smarter one.

	* text.C (singleWidth): Spurious font copying in hot-spot
	singleWidth avoided. Reorder tests for arabic for efficiency.

	* text.C (fill): handle empty paragraphs better.

2003-07-27  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* ispell.C:
	* encoding.h: add includes

	* lyxrc.C: remove reading of bind files

	* lyx_main.C (init): setup bindings and menus only if we have a
	gui.

	* kbmap.C (read): new method. Do the actual reading of bind
	files.

	* converter.C (dvipdfm_options):
	* bufferparams.C:
	* lyxrc.C (read):
	(output): adapt PAPER_* enums.

	* lyxrc.h: include paper.h instead of bufferparams.h (mucho lighter)

	* bufferparams.h: remove paper-related enums from there

	* paper.h: New file. A trivial header file to hold paper-related
	enums. It should later expand to contain many paper-related
	horrors access.

	* lyxrc.C: declare extern displayTranslator

2003-07-27  José Matos  <jamatos@fep.up.pt>

	* tabular.[Ch] (linuxdoc): add support for tables and figures
	(linuxdoc).

2003-07-27  José Matos  <jamatos@fep.up.pt>

	* buffer.[Ch] (makeLaTeXFile): changed name of arguments for
	consistency in both functions.
	* bufferlist.C (updateIncludedTeXfiles): change client to comply.

2003-07-26  Asger Alstrup  <alstrup@local>

	* rowpainter.C (paintRows): Change algorithm to work directly on
	the insets rather than asking every character in the document
	whether its an inset.

2003-07.26  Alfredo Braunstein  <abraunst@libero.it>

	* buffer.C (openFileWrite): factorize some code

2003-07-26  Angus Leeming  <leeming@lyx.org>

	* lyx_cb.C:
	* lyx_main.[Ch]: replace occurances of system_tempdir with
	os::getTmpDir().

2003-07-25  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* rename Inset to InsetOld

2003-07-25  Asger Alstrup  <alstrup@diku.dk>

	* undo_funcs.h: Removed setCursorParUndo to simplify things a bit.
	Renamed setUndo family to recordUndo. Renamed FINISH to ATOMIC
	which I think is a bit clearer. EDIT is gone, since it was
	premature optimisation, and broken for mathed anyway.
	* undo_funcs.C (performUndoOrRedo): Cleaned up and made it work
	with cursor positioning in insets as well (math insets still do not
	work, but that's a different story anyway.) It mysteriously
	crashes sometimes with undo in the first paragraph, but I'm fairly
	confident that this is a compiler bug.

2003-07-25  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph.C (Paragraph): adjust for new clone return type
	(operator==): ditto
	(copyIntoMinibuffer): ditto

2003-07-25  Asger Alstrup  <alstrup@lyx.org>

	* undo_funcs.C (textHandleUndo): Fix undo crash in first paragraph
	by not having a special case, and always doing a full rebreak of
	the document after undo.

2003-07-23  Angus Leeming  <leeming@lyx.org>

	* factory.C (createInset): InsetExternal::setParams now takes a
	Buffer const * arg.

2003-07-23  Angus Leeming  <leeming@lyx.org>

	* factory.C (createInset): changed interface to the external and
	graphics mailers' string2params functions.

2003-07-23  Angus Leeming  <leeming@lyx.org>

	* factory.C (createInset): pass a
	Buffer const * parameter to InsetExternalMailer's string2params.

2003-07-22  John Levon  <levon@movementarian.org>

	* Thesaurus.h: include the right aiksaurus header

2003-07-21  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* MenuBackend.C (expand): check menu shortcuts unconditionally

2003-07-21  Angus Leeming  <leeming@lyx.org>

	* factory.C (createInset): pass a
	buffer_path parameter to InsetGraphicsMailer's string2params.

2003-07-21  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (buffer):
	* buffer.C (d-tor):
	* lyx_main.C (LyX):
	* lyxfunc.C (dispatch):
	* lyxrc.C (setDefaults, read, output): use namespace lyx::graphics
	rather than the grfx shortcut.

2003-07-21  André Pönitz  <poenitz@gmx.net>

	* rowpainter.C: remove unused variables

	* tabular_funcs.C:
	* tabular_funcs.h: move to tabular.C
	* Makefile.am: adjust

	* tabular.[Ch]: basic optical cleaning

	* author.h: pass references, not values

2003-07-18  André Pönitz  <poenitz@gmx.net>

	* lyxtext.h:
	* metricsinfo.C:
	* metricsinfo.h:
	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C: two-phase drawing for InsetText and InsetTabular
	some float -> int changes.

2003-07-18  Alfredo Braunstein  <abraunst@libero.it>

	* lyx_main.C: fix the fix

2003-07-18  Alfredo Braunstein  <abraunst@libero.it>

	* lyx_main.C: fix a crash in batch mode if no files specified
	* converter.C: ws

2003-07-17  Alfredo Braunstein  <abraunst@libero.it>

	* format.[Ch] (papersize): moved to BufferParams
	* converter.[Ch] (dvips_options): moved to BufferParams
	(dvipdfm_options): moved to anon namespace
	* bufferparams.[Ch]: added above functions.

2003-07-17  André Pönitz  <poenitz@gmx.net>

	* lyxtext.h:
	* rowpainter.C:
	* text2.C: don't call inset->update() anymore

	* metricsinfo.[Ch]: add convenience constructor

2003-07-16  André Pönitz  <poenitz@gmx.net>

	* lyxcursor.[Ch]:
	* lyxfunc.[Ch]:
	* text.C:
	* text2.C: replace the LyXCursor::irow_ member with
	 on-demand computation of the value

2003-07-16  John Levon  <levon@movementarian.org>

	* lyxfunc.C: support LFUN_INSET_SETTINGS for Note

2003-07-15  André Pönitz  <poenitz@gmx.net>

	* text.C:
	* text2.C: remove no more needed refresh_row

2003-07-15  André Pönitz  <poenitz@gmx.net>

	* lyxtext.h:
	* rowpainter.C:
	* text2.C:
	* text3.C: refresh_status tristate -> need_update bool

2003-07-15  Alfredo Braunstein  <abraunst@libero.it>

	* lyxtext.h (init): remove reinit argument (act as if always true)
	* text2.C: adjust to that

2003-07-14  Juergen Spitzmueller  <j.spitzmueller@gmx.de>

	* bufferview_funcs.[Ch]: introduce function replaceSelection()
	* text3.C: use it to delete selections in some cases
	(bugs 441, 673, 702, 954).

2003-07-14  André Pönitz  <poenitz@gmx.net>

	* rowpainter.[Ch]: reduce interface

2003-07-14  André Pönitz  <poenitz@gmx.net>

	* BufferView_pimpl.C:
	* text2.C: adjust after removing unused BufferView * argument

2003-07-14  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (init): fix a crash fired on resize

2003-07-11  Alfredo Braunstein  <abraunst@libero.it>

	* buffer.[Ch]: added new closing signal
	* BufferView_pimpl.[Ch]: connect/disconnect to new signal
	* lyxfunc.C: removed BufferView::buffer(0) call now handled in
	BufferView::Pimpl via the closing the signal

2003-07-10  Alfredo Braunstein  <abraunst@libero.it>

	* buffer.[Ch]: take out all bv-related from buffer
	* BufferView.C:
	* BufferView_pimpl.[Ch]: connect to new signals
	* CutAndPaste.C: removed useless asserts
	* bufferview_funcs.[Ch] (resizeInsets): moved from buffer
	* lyxvc.[Ch]:
	* vc-backend.[Ch]:
	* lyxfunc.C: moved view-related funciontality from vc here
	* paragraph.C: removed outdated comments
	* text.C: ws

2003-07-10  André Pönitz  <poenitz@gmx.net>

	* BufferView_pimpl.C:
	* tabular.h:
	* tabular_funcs.C:
	* text.C:
	* text2.C: remove InsetText::InnerCache, clean up consequences

2003-07-07  Adrien Rebollo  <adrien.rebollo@gmx.fr>

	* ispell.C: fix two typos in error messages

2003-07-08  Martin Vermeer  <martin.vermeer@hut.fi>

	* Extend Note inset to other forms of annotation like Comment
	and Greyedout. Right button click gives dialog.

	Files modified or added (+):

	* insetnote.[Ch]
	* FormNote.[Ch]      +
	* ControlNote.[Ch]   +
	* form_note.fd       +
	* Makefile.am in frontends/xforms, frontends/xforms/forms,
	frontends/controllers
	* xforms/Dialogs.C
	* factory.C

2003-07-01  Juergen Spitzmueller  <j.spitzmueller@gmx.de>

	* aspell.C: add missing namespace lyx::support

2003-07-07  Alfredo Braunstein  <abraunst@libero.it>

	* BufferView.[Ch] (newFile): Add
	* BufferView_pimpl.[Ch] (newFile, connectBuffer, disconnectBuffer): Add
	* LaTeX.[Ch] (message): added this signal and use it
	* buffer.[Ch] (busy, message): added these signals and use them
	* buffer_funcs.[Ch]: rename parseErrors to bufferErrors
	* converter.C:
	* exporter.C:
	* format.C:
	* importer.C: use buffer signals instead of direct bv calling
	* lyx_cb.[Ch] (ShowMessage): removed
	* lyx_main.C:
	* lyxfunc.C:
	* paragraph_funcs.C:
	* text2.C: use buffer signals

2003-07-04  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* introduce namespace lyx::graphics

2003-07-02  André Pönitz  <poenitz@gmx.net>

	* BufferView_pimpl.C (workAreaDispatch): tell the FuncRequest who we are

2003-07-01  André Pönitz  <poenitz@gmx.net>

	* text.C:
	* text2.C:
	* text3.C:
	* text_funcs.[Ch]:
	* textcursor.h:
	* lyxtext.h: shuffle pure paragraph/cursor related cursor movement from
	  text*.C to text_func.C

2003-07-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* introduce namespace lyx::support

2003-06-30  André Pönitz  <poenitz@gmx.net>

	* Chktex.C:
	* funcrequest.C:
	* lyxtext.h:
	* text.C: re-enable --with-included-string

2003-06-28  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* textcursor.C: add <config.h>

	* text.C (getWord): remove const from word_location arg

	* lyxvc.C (getLogFile): fix const type order

	* lyxtext.h: remove const from word_location arg, add arg name

	* lyxlayout.h: currect type on labeltype.

	* importer.C: correct \file

	* converter.C (intToFormat): use std:: on ret val, ws changes

	* bufferlist.h: correct \file

	* buffer.C (makeLinuxDocFile): fix const type order
	(makeDocBookFile): ditto
	(fillWithBibKeys): use std:: on stdlib args.

	* CutAndPaste.C: fix authors.
	(availableSelections): use std:: on return vector

2003-06-27  André Pönitz  <poenitz@gmx.net>

	* BufferView_pimpl.C:
	* bufferview_funcs.C:
	* lyxcursor.C:
	* lyxcursor.h:
	* lyxfunc.C:
	* lyxtext.h:
	* rowpainter.C:
	* text.C:
	* text2.C:
	* text3.C: remove LyXCursor::row_ member

	* lyxtext.h:
	* text.C: rename fullRebreak() to partialRebreak() and implement
	  a fullRebreak() that really bereks fully

	* textcursor.h: new struct for cursor-related data

2003-06-26  Alfredo Braunstein  <abraunst@lyx.org>

	* lyx_main.C (LyX): get full path of document loaded on the
	command line

2003-06-26  André Pönitz  <poenitz@gmx.net>

	* lyxcursor.[Ch]: move rarely used operator==,!= out of line
	  remove unused/broken operator>,<,>=.

	*	text.C: remove only use of broken operator<= in an Assert().

2003-06-24  Alfredo Braunstein  <abraunst@lyx.org>

	* BufferView.[Ch] (getErrorList): removed unneeded forward declare,
	moved errorlist_.clear to showErrorList

2003-06-24  Alfredo Braunstein  <abraunst@lyx.org>

	* converter.C (scanLog, runLaTeX):
	* buffer.C (makeLinuxDocFile, makeDocBookFile, runChkTeX):
	move the bv->showErrorList call to the callers
	* lyxfunc.C: i.e. here...
	* text2.C: and here
	* BufferView.[Ch] (setErrorList, resetErrorList): both removed
	* exporter.[Ch] (Backends, BufferFormat): the first was moved to anon
	namespace, the second to...
	* buffer_funcs (BufferFormat, parseErrors): added
	* errorlist.C (ErrorList(TeXErrors const &)): removed

2003-06-24  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* ToolbarBackend.C (getIcon): complain when icon cannot be found

2003-06-24  "Garst R. Reese" <reese@isn.net>

	* debug.C: fix typo

2003-06-23  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyx_main.C (init): honor LYX_DIR_14x and LYX_USERDIR_14x

	* version.C.in: change docversion to 1.4

2003-06-22  Alfredo Braunstein  <abraunst@libero.it>

	* buffer.C: fix a bug just introduced

2003-06-21  Alfredo Braunstein  <abraunst@libero.it>

	* buffer.[Ch]: added the parseError signal and use it, removed
	sgmlError
	* BufferView.[Ch] (addError): moved to ...
	* BufferView_pimpl.[Ch] (addError, loadLyXFile): ... here. Attach
	to the Buffer::parseError signal to catch (guess what) parse errors
	* lyx_main.[Ch] (printError,LyX): added gui-less parsing error feedback

2003-06-19  Alfredo Braunstein  <abraunst@libero.it>

	* bufferlist.[Ch] (loadLyXFile, readFile, newFile): removed the
	ability to create a buffer and to return an existing one from
	the list. Moved these functions to...
	* buffer_funcs.[Ch]: added
	* BufferView.[Ch] (loadLyXFile): added
	* BufferView_pimpl.[Ch] (loadLyXFile): Added. Does the guessing
	job removed from bufferlist::loadLyXFile.
	* buffer.C (setReadOnly): make it work without view
	(i.e added an if (users))

2003-06-19  Angus Leeming  <leeming@lyx.org>

	* lfuns.h:
	* LyXAction.C (init):
	* lyxfunc.C (getStatus, dispatch): remove 14 LFUNs, replacing them
	with LFUN_DIALOG_SHOW <name> <data>.

2003-06-19  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* CutAndPaste.C (availableSelections): small compilation fix for
	ancient (gcc 2.9x) compilers

2003-06-18  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C (cursorNext): add tmp var

	* text2.C (updateCounters): for function calling out of for clause
	(replaceSelectionWithString): ditto
	(insertStringAsParagraphs): ditto
	(getColumnNearX): add tmp var
	(setCursorFromCoordinates): add tmp var
	(cursorDownParagraph): add tmp var
	(deleteEmptyParagraphMechanism): add tmp var

	* text.C (insertChar): add tmp var

	* rowpainter.C (paintDepthBar): add tmp var

	* CutAndPaste.C (availableSelections): potentially check all
	paragraphs in a cut to fill the shown strings.

2003-06-18  André Pönitz  <poenitz@gmx.net>

	* kbmap.[Ch]: use vector<> instead of list<>

2003-06-17  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* text3.C (dispatch): handle arg to LFUN_PASTE, call
	pasteSelection with index

	* text2.C (pasteSelection): modify, call pasteSelection with index

	* paragraph.C (asString): reimplement version with no interval to
	call the one with interval.

	* lyxtext.h: add index arg to pasteSelection

	* MenuBackend.C (MenuItem): handle PasteRecent
	(Menu::read::Menutags): add md_pasterecent
	(read): handle it
	(expandPasteRecent): new function
	(expand): use it

	* MenuBackend.h: add PasteRecent to MenuItem::Kind

	* CutAndPaste.C: get rid of some stale comments. Add typdefe for
	the limited stack
	(availableSelections): new function

2003-06-17  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): s/showMathPanel/show("mathpanel")/

2003-06-17  Angus Leeming  <leeming@lyx.org>

	* lfuns.h:
	* LyXAction.C (init): new LFUN_DIALOG_SHOW.

	* lyxfunc.C (dispatch): invoke it.

2003-06-16  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* iterators.C (operator++, ParPosition): reintroduce some
	const_cast for the benefit of older compilers.

2003-06-13  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text3.C (dispatch): do not modify clipboard when doing
	LFUN_BACKSPACE, LFUN_BACKSPACE_SKIP, LFUN_DELETE or
	LFUN_DELETE_SKIP on a selection selection

2003-06-16  André Pönitz  <poenitz@gmx.net>

	* BufferView.C:
	* buffer.C:
	* buffer.h:
	* paragraph.C:
	* tabular.[Ch]: IU of clone() and getLabelList();

2003-06-13  André Pönitz  <poenitz@gmx.net>

	* tabular.h: compactification

2003-06-12  André Pönitz  <poenitz@gmx.net>

	* tabular.C:
	* tabular.h:
	* tabular_funcs.h: some renaming plus whitespace

2003-06-12  André Pönitz  <poenitz@gmx.net>

	* BufferView.C:
	* BufferView_pimpl.C:
	* CutAndPaste.C:
	* buffer.C:
	* iterators.[Ch]:
	* lyxfunc.C:
	* text.C:
	* toc.C: Return a Paragraph & for ParIterator::operator*()

2003-06-11  John Levon  <levon@movementarian.org>

	* lyx_main.C:
	* ToolbarBackend.h:
	* ToolbarBackend.C: add "Toolbars" section and
	put the flags there

2003-06-10  Angus Leeming  <leeming@lyx.org>

	* lfuns.h:
	* LyXAction.C (init): new LFUN_EXTERNAL_EDIT.

	* lyxfunc.C (dispatch): invoke it.

2003-06-11  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* main.C: protect <ios> with HAVE_IOS
	(main): protect sync_with_stdio with HAVE_IOS

2003-06-10  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* text2.C (cutSelection): adjust
	(pasteSelection): adjust

	* messages.C: handle get of empty string

	* main.C (main): use sync_with_stdio(false)

	* lyxfunc.C (dispatch): adjust

	* lyx_cb.[Ch] (MenuWrite): remove unneeded BufferView arg
	(WriteAs): remove unneeded BufferView arg.

	* bufferparams.h: use correct types on papersize, papersize2 and
	paperpackage.

	* bufferparams.C (readToken): adjust for type
	(writeLaTeX): add missing cases to switch.

	* bufferlist.C (quitWriteBuffer): adjust
	(close): adjust

	* buffer.C (asciiParagraph): remove some commented code.

	* CutAndPaste.C: remove current_view extern variable.
	(cutSelection): add BufferParams arg.
	(eraseSelection): add BufferParams arg.
	(pasteSelection): add Buffer const & arg

2003-06-07  John Levon  <levon@movementarian.org>

	* buffer.C:
	* paragraph_funcs.C:
	* paragraph_pimpl.C:
	* text.C:
	* text2.C:
	* paragraph.h:
	* paragraph.C: allow InsetERT to freely space lines,
	and some consolidation of code

2003-06-06  José Matos  <jamatos@fep.up.pt>

	* buffer.C (makeDocBookFile): fix bug #821

2003-06-06  Alfredo Braunstein  <abraunst@libero.it>

	* BufferView_pimpl.C (dispatch): use Dialogs::visible

2003-06-04  Angus Leeming  <leeming@lyx.org>

	* buffer.C: bump format to 224.

2003-06-05  André Pönitz  <poenitz@gmx.net>

	* text2.C (redoParagraphs): remove two const_cast<>

2003-06-04  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* ParagraphList.h: remove last remnants of NO_STD_LIST

2003-06-03  Angus Leeming  <leeming@lyx.org>

	* factory.C (createInset): small change to the way InsetExternal's params
	are set.

2003-06-04  André Pönitz  <poenitz@gmx.net>

	* buffer.h: use Undo directly instead of shared_ptr<Undo>

	* paragraph_pimpl.h:
	* paragraph.[Ch]: some Inset -> UpdatableInset changes

	* undo.[Ch]: use ParagraphList instead of vector<Paragraph>

	* undo_funcs.C: make some simple cases of undo work again

2003-06-03  John Levon  <levon@movementarian.org>

	* ispell.C: HPUX doesn't have sys/select.h
	(from Albert Chin)

2003-06-03  John Levon  <levon@movementarian.org>

	* CutAndPaste.C: update tabular and include inset
	buffer references

	* buffer.h:
	* paragraph.h:
	* paragraph.C: remove owningBuffer(), don't pass Buffer
	to clone()

	* factory.C: insetGraphicsParams changed

2003-06-02  John Levon  <levon@movementarian.org>

	* LyXAction.C:
	* factory.C:
	* lfuns.h:
	* lyxfunc.C:
	* text3.C: remove insetparent

2003-06-02  John Levon  <levon@movementarian.org>

	* buffer.h:
	* buffer.C: fix inset_iterator.end(), move out of line
	(bug 1149)

2003-06-01  John Levon  <levon@movementarian.org>

	* text3.C: use a proper cut/paste when doing inset
	insert (from Jürgen Spitzmüller)

2003-06-01  John Levon  <levon@movementarian.org>

	* factory.C: accept "\bibtex" not "\BibTeX" (bug 1018)

2003-05-30  André Pönitz  <poenitz@gmx.net>

	* rowpainter.C: unify second drawing phase

2003-05-29  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* trans_mgr.C: remove one case of current_view

	* text2.C (cursorBottom): delete NO_STD_LIST stuff

	* paragraph_funcs.h: remove paragraph.h include

	* paragraph.h: delete NO_STD_LIST stuff

	* paragraph.C (Paragraph): delete NO_STD_LIST stuff

	* buffer.h: remove paragraph.h include

	* ParagraphList.C: delete file

	* Makefile.am (lyx_SOURCES): remove ParagraphList.C

	* toc.C (getTocList): adjust

	* paragraph_pimpl.C (validate): adjust

	* paragraph_funcs.C (optArgInset): use const_iterator, adjust

	* paragraph.C (Paragraph): adjust
	(getPositionOfInset): use const_iterator, adjust
	(bibitem): use const_iterator, adjust
	(setInsetOwner): adjust

	* iterators.C (operator++): adjust

	* InsetList.[Ch]: Replace selfmade iterator with standard
	vector::iterator also introduce const_iterator. Remove getPos,
	getInset and setInset from InsetTable. Adjust accordingly.

	* BufferView.C (lockInset): adjust
	(ChangeInsets): adjust

	* tabular.[Ch]: delete commented same_id functions

2003-05-28  John Levon  <levon@movementarian.org>

	* lyxfunc.C: fix LFUN_ESCAPE (bug 1055)

2003-05-28  André Pönitz  <poenitz@gmx.net>

	* metricsinfo.[Ch]: remove 'fullredraw' member

2003-05-28  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* lyxtextclass.C (operator): remove caching.

2003-05-27  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C: adjust

	* text2.C (cursorBottom): adjust
	(setCounter): use ParagraphList::find, adjust

	* text.C (workWidth): use ParagraphList::find, adjust

	* lyxcursor.C (LyXCursor): adjust

	* buffer.C (inset_iterator): adjust

	* ParagraphList.h: make iterator(value_type) private, make
	ParagraphList a friend of iterator.

	* ParagraphList.C (find): new function

	* BufferView_pimpl.C (resizeCurrentBuffer): adjust

2003-05-27  André Pönitz  <poenitz@gmx.net>

	* dimension.[Ch]: a -> asc, d -> des, w -> wid

2003-05-27  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfont.C (latexWriteStartChanges): fix character count for \noun

2003-05-26  John Levon  <levon@movementarian.org>

	* LyXAction.C: LFUN_ESCAPE should be ReadOnly

2003-05-26  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* remove same_id from function signatures, adjust.

2003-05-25  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* undo_funcs.C (createUndo): use the id functions directly, adjust.

	* paragraph_pimpl.C (Pimpl): get rid of same_ids parameter

	* paragraph.C (Paragraph): get rid of same_ids parameter

	* ParagraphList.C (insert): adjust
	(push_back): adjust

2003-05-24  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph_funcs.C (breakParagraph): adjust
	(breakParagraphConservative): adjust

	* buffer.C (readParagraph): adjust

	* ParagraphList.C (insert): take a reference instead of a pointer
	(insert): adjust

	* paragraph.[Ch] (id): new function

	* bufferlist.C (newFile): adjust

	* ParagraphList.C (ParagraphList): adjust
	(assign): adjust
	(push_back): take a reference instead of a pointer.

	* paragraph.h: add NO_STD_LIST define, remove NO_NEXT define.

	* paragraph.C: remove all NO_NEXT node add some NO_STD_LIST parts
	instead.

	* ParagraphList.h: degenerate to std::list if NO_STD_LIST is not
	set else use old code.

	* ParagraphList.C: remove all NO_NEXT code and only compile this
	code of NO_STD_LIST is set.

2003-05-23  Alfredo Braunstein  <abraunst@libero.it>

	* BufferView_pimpl.C:
	* TextCache.C:
	* TextCache.h:
	* bufferlist.C:
	* errorlist.h:
	* format.C:
	* format.h:
	* graph.C:
	* lyxfunc.C:
	* lyxrc.C:
	* graphics/GraphicsConverter.C:
	* graphics/PreviewLoader.C: header adjustment

2003-05-23  Angus Leeming  <leeming@lyx.org>

	* LaTeXFeatures.[Ch] (useBabel): new method.
	* bufferparams.C (writeLaTeX): use it.

2003-05-23  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* ParagraphList.h (set): remove unused function.

2003-05-23  André Pönitz  <poenitz@gmx.net>

	* BufferView.C:
	* BufferView_pimpl.C:
	* buffer.C:
	* buffer.h:
	* lyxfunc.C:
	* undo_funcs.C: setUndo reworked

	* iterators.[Ch]: add access to topmost ParagraphList

	* lyxtext.[Ch] (workWidth): add a const

2003-05-23  Alfredo Braunstein  <abraunst@libero.it>

	* texrow.[Ch] (increasePos): remove function
	* exporter.C (export): removed unused var and outdated comment

2003-05-23  Angus Leeming  <leeming@lyx.org>

	* latexrunparams.h: rename fragile as moving_arg.
	* paragraph.C (simpleTeXOnePar): ditto.
	* paragraph_pimpl.C (simpleTeXSpecialChars): ditto.

2003-05-23  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* undo_funcs.C (textHandleUndo): comment out next/previous stuff
	(createUndo): ditto
	(textUndoOrRedo): comment out a currently unused var.

	* paragraph.h (NO_NEXT): enable NO_NEXT

	* lyxfunc.C (dispatch): remove LFUN_REMOVEERRORS

	* lfuns.h: remove LFUN_REMOVEERRORS and adjust lfun numbers.

	* exporter.C (Export): adjust for removeAutoInsets removal.

	* buffer.C (runChktex): adjust for removeAutoInsets removal.

	* LyXAction.C (init): remove LFUN_REMOVEERRORS

	* BufferView.[Ch] (removeAutoInsets): delete function

2003-05-22  Angus Leeming  <leeming@lyx.org>

	* latexrunparams.h: add a free_spacing variable.

	* paragraph.[Ch] (simpleTeXOnePar): further fragile clean-up; no need
	to pass moving_arg, as the data is stored in runparams.fragile.

	* paragraph_funcs.C (TeXOnePar): no longer pass free_spacing arg
	to Inset::latexOptional or to simpleTeXOnePar.

	* paragraph_pimpl.C (simpleTeXSpecialChars): no longer pass
	free_spacing arg to Inset::latexOptional.

	* tabular.[Ch] (TeXLongtableHeaderFooter, TeXRow): no longer have
	free_spacing arg.

2003-05-22  Angus Leeming  <leeming@lyx.org>

	* latexrunparams.h: add fragile and use_babel variables.

	* bufferparams.[Ch] (writeLaTeX): return use_babel.
	* buffer.C (makeLaTeXFile): store this returned value in
	runparams.use_babel, thus passing it to the inset::latex methods.

	* paragraph.C (simpleTeXOnePar): no need to pass 'moving_arg' to
	simpleTeXSpecialChars as it is now stored in runparams.fragile.

	* paragraph_funcs.[Ch] (TeXOnePar, latexParagraphs): TeXOnePar no
	longer has a fragile arg, as it is stored in runparams.fragile.

	* paragraph_pimpl.[Ch] (simpleTeXSpecialChars): no longer has a
	moving_arg parameter as the data is stored in runparams.fragile.

	* tabular.[Ch] (TeXLongtableHeaderFooter, TeXRow): no longer have
	a fragile parameter as the data is stored in runparams.fragile.

2003-05-22  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph.C (Paragraph): initialize next_par_ and prev_par_

2003-05-22  Angus Leeming  <leeming@lyx.org>

	* latexrunparams.h: add a 'bool nice' which defaults to false.

	* buffer.[Ch] (makeLaTeXFile): remove the nice parameter as it is
	now encapsulated within runparams.

	* bufferlist.C (updateIncludedTeXfiles):
	* exporter.C (Export): ensuing change to the calls to makeLaTeXFile.

2003-05-22  Angus Leeming  <leeming@lyx.org>

	* latexrunparams.h: new file containing struct LatexRunParams.
	* Makefile.am: add new file.

	* LaTeX.[Ch] (c-tor, run):
	* buffer.[Ch] (makeLaTeXFile):
	* bufferlist.[Ch] (updateIncludedTeXfiles):
	* converter.C (convert, scanLog):
	* converter.[Ch] (runLaTeX):
	* exporter.C (Export):
	* paragraph.[Ch] (simpleTeXOnePar):
	* paragraph_funcs.C (TeXEnvironment, TeXOnePar, TeXDeeper):
	* paragraph_funcs.[Ch] (latexParagraphs):
	* paragraph_pimpl.[Ch] (simpleTeXSpecialChars):
	* tabular.[Ch] (TeXLongtableHeaderFooter, TeXRow, latex):
	pass around a LatexRunParams parameter.

2003-05-22  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph.[Ch]: remove unused constructor

	* ParagraphList.C (erase): new function, taking two iterators

2003-05-22  André Pönitz  <poenitz@gmx.net>

	* undo_funcs.C: remove duplicated code

	* iterator.[Ch]: operator=

2003-05-22  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* tabular.C (SetMultiColumn): ws changes

	* rowpainter.C (paintFirst): get rid of a ->previous

	* lyx_cb.C (getPossibleLabel): parlist simplification

	* BufferView.C (ChangeInsets): simplify slightly.

2003-05-20  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* LyXAction.C: new lfun space-insert, kill protected-space-insert
	* lfuns.h: new LFUN_SPACE
	* lyxfunc.C: protected space has a new lfun
	* paragraph_funcs.C: read new space insets
	* text3.C:
	* factory.C: handle new space insets

2003-05-22  André Pönitz  <poenitz@gmx.net>

	* BufferView.C:
	* BufferView_pimpl.C:
	* buffer.[Ch]:
	* lyxfunc.C:
	* undo_funcs.C: return a ParIterator from getParFromID.

	* iterators.[Ch]: add two const's

2003-05-21  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* toc.C (getTocList): adjust

	* iterators.[Ch]: rework for parlist

	* buffer.C (par_iterator_begin): adjust
	(par_iterator_end): adjust

	* CutAndPaste.C (SwitchLayoutsBetweenClasses): adjust

	* BufferView.C (removeAutoInsets): adjust
	(ChangeInsets): adjust

2003-05-21  Alfredo Braunstein  <abraunst@libero.it>

	* text.C (top_y): fix bug 1110

2003-05-08  Alfredo Braunstein  <abraunst@libero.it>

	* errorlist.[Ch]: added
	* buffer.C:
	* BufferView.[Ch]:
	* BufferView_pimpl.C:
	* CutAndPaste.[Ch]: get rid of InsetError users, use ErrorList
	instead

2003-05-08  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* Makefile.am: ensure that lyx is relinked upon changes to the
	various "convenience" libs.

2003-05-20  Angus Leeming  <leeming@lyx.org>

	* Makefile.am (lyx_SOURCES): move format.[Ch] and graph.[Ch] so that
	files are compiled in alphabetical order again.

	* gettext.h: #ifndef _GETTEXT_H_ -> #ifndef GETTEXT_H.

2003-05-19  Angus Leeming  <leeming@lyx.org>

	* gettext.[Ch]: remove "char const * _(char const *)".

2003-05-19  André Pönitz  <poenitz@gmx.net>

	* dimension.[Ch]: promote from mathed/dimension.[Ch]

	* Makefile.am:
	* BufferView.C:
	* DepTable.h:
	* LaTeXFeatures.C:
	* buffer.C:
	* lyxfont.C:
	* lyxlex.h:
	* paragraph_funcs.C: dimensions() instead of ascend/descend/width

2003-05-19  André Pönitz  <poenitz@gmx.net>

	* buffer.C:
	* lyxlayout.[Ch]:
	* lyxtextclass.[Ch]:
	* paragraph.C:
	* paragraph_funcs.[Ch]:
	* text2.C:
	* text3.C: more insetenv work

2003-05-16  Alfredo Braunstein  <abraunst@libero.it>

	* ParagraphParameters.C (params2string): small bug fixed

2003-05-16  André Pönitz  <poenitz@gmx.net>

	* debug.C:
	* bufferview_funcs.C: patch from Kornel Benko to prevent
	  crash when _(...) is called twice in a statement

2003-05-16  André Pönitz  <poenitz@gmx.net>

	* BufferView.C:
	* lyxfunc.C:
	* text.C:
	* text2.C:
	* text3.C:
	* undo_funcs.C: edit() -> LFUN_INSET_EDIT

2003-05-14  Alfredo Braunstein  <abraunst@libero.it>

	* lyx_main.C (init): remove spurious static_cast

2003-05-14  André Pönitz  <poenitz@gmx.net>

	* BufferView.C: fix format string

2003-05-12  Alfredo Braunstein  <abraunst@libero.it>

	* BufferView.[Ch] (insertErrors): removed
	* BufferView.[Ch] (showErrorList): added
	* buffer.C (runChkTeX):
	* converter.C (scanLog): call showErrorList instead of inserterrors

2003-05-13  André Pönitz  <poenitz@gmx.net>

	* BufferView_pimpl.C:
	* buffer.C:
	* bufferview_func.C:
	* MenuBackend.C:
	* lyxfunc.C:
	* lyxrc.C:
	* tex-accent.C:
	* text3.C:
	* toc.C:
	* tabular_funcs.h: tostr() from its own header

	* ParagraphParameters.C:
	* ToolbarBackend.C:
	* bufferparams.C:
	* format.C:
	* lyxlex_pimpl.C:
	* text3.C: STRCONV()

2003-05-12  André Pönitz  <poenitz@gmx.net>

	* BufferView.C:
	* BufferView_pimpl.C:
	* CutAndPaste.C:
	* LaTeX.C:
	* LaTeXFeatures.C:
	* ParagraphParameters.C:
	* buffer.C:
	* bufferlist.C:
	* bufferparams.C:
	* bufferview_funcs.C:
	* converter.C:
	* counters.C:
	* debug.C:
	* exporter.C:
	* format.C:
	* importer.C:
	* lyx_cb.C:
	* lyx_main.C:
	* lyxfont.C:
	* lyxfunc.C:
	* lyxvc.C:
	* paragraph.C:
	* paragraph_funcs.C:
	* tabular.C:
	* tabular_funcs.C:
	* text2.C:
	* text3.C:  boost::format -> bformat  all over the place


2003-05-09  André Pönitz  <poenitz@gmx.net>

	* LColor.[Ch]: Pimpl the #include <map> away

2003-05-09  John Levon  <levon@movementarian.org>

	* bufferlist.C: never remove emergency saves

2003-05-08  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* Makefile.am: better lib building

2003-05-07  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* texrow.[Ch]: remove dependency on Paragraph and just store a id
	instead.
	* paragraph_pimpl.C (simpleTeXBlanks): adjust
	(simpleTeXSpecialChars): adjust
	(simpleTeXSpecialChars): adjust
	* paragraph.C (simpleTeXOnePar): adjust
	* buffer.C (makeLaTeXFile): adjust

	* Makefile.am (BOOST_LIBS): allow boost as system lib.

	* text2.C (changeDepth): parlist cleanup
	(getColumnNearX): ditto

	* rowpainter.C (getLabelFont): parlist cleanup

	* bufferlist.C (newFile): parlist cleanup

	* CutAndPaste.C (eraseSelection): parlist cleanup

	* BufferView_pimpl.C (trackChanges): parlist cleanup
	(dispatch): ditto

	* BufferView.C (lockInset): parlist cleanup.
	(ChangeInsets): ditto

2003-05-06  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* CutAndPaste.h: Update file header.

	* CutAndPaste.C: Update file header.
	Store the parts cut out of the Document in a limited_stack.
	(copySelection): adjust
	(pasteSelection): new function, takes the index in the limited stack.
	(nrOfParagraphs): adjust
	(SwitchLayoutsBetweenClasses): Change to take a ParagraphList&,
	simplify error inset insertion.
	(checkPastePossible): adjust

2003-05-06  John Levon  <levon@movementarian.org>

	* text2.C: don't cast wrap inset to float

2003-05-05  André Pönitz  <poenitz@gmx.net>

	* iterator.C:
	* undo_funcs.C: use getParagraphs() instead of getFirstParagraph()

	* buffer.[Ch]: new function hasParWithId() to help to get rid of a
	  few naked Paragraph *.

2003-05-02  Michael Schmitt  <michael.schmitt@teststep.org>

	* bufferparams.C: Output warning if a document with missing
	TeX document class is loaded
	* exporter.C: Disable TeX exports if the document class is missing
	* lyxtextclass.C:
	* lyxtextclass.h:
	* lyxtextclasslist.C: Handle new textclass.lst format; new method
	isTeXClassAvailable()

2003-05-03  John Levon  <levon@movementarian.org>

	* BufferView.h:
	* BufferView.C: remove showLockedInsetCursor(), showCursor(),
	explicit cursor show/hide

	* BufferView_pimpl.h:
	* BufferView_pimpl.C: hide cursor before dispatching. Show cursor
	after a cursor move lfun. Simplify cursorToggle(). Remove show/hideCursor().

	* lyxfunc.C: hide cursor before dispatching.

	* lyx_cb.C:
	* lyxfind.C:
	* text.C:
	* text3.C: remove explicit cursor hides

2003-05-02  André Pönitz  <poenitz@gmx.net>

	* buffer.[Ch]: two instances of Paragraph * -> ParagraphList::iterator

	* undo_funcs.C:
	* undo.[Ch]: rely on std::vector<Paragraph *> instead of manually
	  linked lists

	* text2.C: tiny whitespace

2003-05-02  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* undo_funcs.C: almost only ws changes.

	* ParagraphList.C (splice): just return if pl is empty.

2003-05-02  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* ParagraphList.C (splice): new function.

	* CutAndPaste.C (pasteSelection): use it

2003-05-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* CutAndPaste.C (pasteSelection): remove the last next and
	previous from this file.

2003-05-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* CutAndPaste.C (pasteSelection): more clean up, user proper
	ParagraphList functions for pasteing.

	* ParagraphList.C (insert): new function, three arg insert

2003-05-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* ParagraphList.C (insert): new function, three arg insert

	* CutAndPaste.C (pasteSelection): work on the simple_cut_clone,
	not on paragraphs.

2003-05-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* CutAndPaste.C (pasteSelection): copy paragraphlist the nice way.

2003-05-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* CutAndPaste.C (pasteSelection): remove some unneeded code.

2003-05-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* CutAndPaste.C (resetOwnerAndChanges): new helper functor
	(copySelection): clean up a bit.
	(pasteSelection): use make_pair

	* ParagraphList.C (ParagraphList): implement copy constructor
	(operator=): implement, base on copy constructor.
	(assign): new func

	* paragraph.C (erase): return a bool

	* paragraph_pimpl.C (erasePos): remove function, move contents...
	(erase): ... here. Return a bool.
	(erase): call erase instead of erasePos.

2003-04-30  Alfredo Braunstein  <abraunst@libero.it>

	* ParagraphList.h: define PitPosPair
	* CutAndPaste.C (copySelection, pasteSelection): big rework, use
	ParagraphList, fix a bug on pasting multiple pars
	* text2.C: change interface to C&P

2003-04-30  André Pönitz  <poenitz@gmx.net>

	* undo_func.C: revert part of yesterday's patch 2

2003-04-30  John Levon  <levon@movementarian.org>

	* LColor.C: s/tabular/table/

2003-04-30  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C (dispatch): do not convert iterator -> pointer
	* undo_funcs.C (setCursorParUndo): ditto
	* text_funcs.C (transposeChars): ditto

	* text2.C (setLayout): ws changes only

	* text.C (breakParagraph): do not convert iterator -> pointer
	(insertChar): ditto
	(acceptChange): ditto
	(rejectChange): ditto
	(changeCase): ditto
	(Delete): ditto
	(backspace): ditto

	* BufferView.C (lockedInsetStoreUndo): do not convert iterator ->
	pointer

2003-04-29  Alfredo Braunstein  <abraunst@libero.it>

	* text3.C (gotoInset): YABG (yet another bad getChar)

2003-04-29  André Pönitz  <poenitz@gmx.net>

	* paragraph.h: make operator= private unimplemented as long as
	  it is unusable

	* ParagraphList.C: whitespace

	* paragraph.[Ch]:
	* paragraph_pimpl.[Ch]:
	* paragraph_funcs.C:
	* CutAndPaste.C:
	* undo_funcs.C: whitespace + Paragraph *  -> Paragraph (const) &

	* text2.C:
	  undo_funcs.[Ch]: Paragraph * -> ParagraphList::iterator

2003-04-29  Alfredo Braunstein  <abraunst@libero.it>

	* CutAndPaste.[Ch] (cutSelection): big rework, some bugs fixed
	* paragraph.[Ch] (erase):
	* paragraph_pimpl.[Ch] (erase): change return type and value
	* text2.C (cutSelection): some rework

2003-04-28  John Levon  <levon@movementarian.org>

	* bufferlist.C: changes for unsaved changes dialog

2003-04-28  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* bufferlist.C (newFile): set language (messages_) for new
	documents also.

	* buffer.C (readFile): ws changes only.

2003-04-28  André Pönitz  <poenitz@gmx.net>

	* undo_funcs.C:
	* lyxfunc.C:
	* buffer.[Ch]:
	* BufferView_pimpl.C:
	* BufferView.C: getParFromID related ParagraphList::iterator changes

2003-04-28  André Pönitz  <poenitz@gmx.net>

	* tabular.[Ch]: part of Lars' Paragraph * -> ParagraphList::iterator
	  Changes

2003-04-28  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* messages.C: remove one more localedir class variable.

2003-04-28  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* messages.C (getLocaleDir): singleton generation function
	(Pimpl): use it.
	(Messages): add a default constructor.

	* main.C (main): do not setup localedir here, do not call
	gettext_init.

	* gettext.C (_): use it.
	(gettext_init): delete funciton

2003-04-27  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* gettext.C (getLyXMessages): new singleton generating function.

	* buffer.C (updateDocLang): adjust

	* Makefile.am (messages.o): add target
	(main.o): remove target

2003-04-27  John Levon  <levon@movementarian.org>

	* bufferlist.C:
	* lyx_cb.C:
	* lyxfunc.C:
	* lyxvc.C: specify cancel button in Alert::prompt

2003-04-26  John Levon  <levon@movementarian.org>

	* text3.C:
	* lyxfunc.C:
	* lfuns.h:
	* LyXAction.C: add LFUN_INSET_SETTINGS

	* lyxfunc.C: don't enable tabular-feature when there's
	just any locking inset

2003-04-26  John Levon  <levon@movementarian.org>

	* bufferlist.C: re-add Cancel to buffer close question

	* lyxfunc.C: fix import UI a bit

2003-04-25  John Levon  <levon@movementarian.org>

	* gettext.C: remove the broken asserts for now

2003-04-25  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* messages.C: make case where setlocale cannot comply work better.

	* buffer.C (updateDocLang): new function
	(changeLanguage): use it
	(readFile): use it

	* text2.C (setCounter): use B_ a bit.

	* lyxlayout.C (Read): be sure to trim the label strings.

	* messages.C (Messages): fix typo in comment

	* buffer.C (readFile): set message_ after file is loaded.
	(makeDocBookFile): remove double return
	(changeLanguage): reset message_ upon language change.
	(B_): new func, use this to get translated buffer strings.

	* main.C: add myself and Jean Marc as authors.

2003-04-24  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* messages.[hC]: pimplify Messages, and three different pimpls to be
	used in different circumstances.

	* gettext.[Ch]: change for use with new message code.

2003-04-24 André Pönitz <poenitz@gmx.net>

	* factory.C: support for eqref

2003-04-23  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* messages.[Ch]: add missing char

	* Makefile.am (lyx_SOURCES): add messages.[Ch]

	* messages.[Ch]: New files

2003-04-18  John Levon  <levon@movementarian.org>

	* BufferView.h:
	* BufferView.C:
	* BufferView_pimpl.C:
	* lfuns.h:
	* LyXAction.C:
	* lyxtext.h:
	* text2.C: remove layout-copy/paste (bug 778)

2003-04-16  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (redoParagraphs): eliminate good_prevrit, rewrite a loop

2003-04-16  Alfredo Braunstein  <abraunst@libero.it>

	* bufferlist.C (quitWriteBuffer): WriteAs and MenuWrite return true
	if they succeed. Act accordingly.

2003-04-16  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (setCharFont): adjust
	(setCounter): adjust
	(insertStringAsLines): adjust

	* text.C (leftMargin): adjust
	(setHeightOfRow): adjust

	* rowpainter.C (paintFirst): adjust
	(paintLast): adjust

	* paragraph_funcs.C (depthHook): ParagraphList::iterators
	(outerHook): ditto
	(isFirstInSequence): ditto
	(getEndLabel): ditto
	(outerFont): adjust

	* paragraph.C (getParLanguage): comment out some hard stuff.

	* buffer.C (insertStringAsLines): take a ParagraphList as arg
	(sgmlError): ditto
	(simpleDocBookOnePar): ditto
	(makeDocBookFile): use ParagraphList::iterator

	* CutAndPaste.C (pasteSelection): adjust

2003-04-16  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (getFont): adjust
	(getLayoutFont): adjust
	(getLabelFont): adjust

	* paragraph_funcs.C (TeXOnePar): adjust

	* buffer.C (simpleLinuxDocOnePar): adjust
	(simpleDocBookOnePar): adjust

	* CutAndPaste.C (pasteSelection): adjust

	* BufferView.C (getEncoding): adjust

	* paragraph_funcs.C (outerFont): prepare for a ParagraphList arg.

2003-04-16  John Levon  <levon@movementarian.org>

	* lyxfind.C: use parlist stuff for search/changes

2003-04-16  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* undo_funcs.C (textHandleUndo): ajust (rather big adsjust this one)

	* text2.C (deleteEmptyParagraphMechanism): adjust

	* text2.[Ch] (ownerParagraph): delete func (both of them

2003-04-15  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text_funcs.C (transposeChars): use ParagraphList::iterator here.

2003-04-15  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* ParagraphList.C: prepare for NO_NEXT

2003-04-15  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (getFont): adjust
	(getLayoutFont): adjust
	(getLabelFont): adjust

	* paragraph.C (getFont): adjust
	(getLabelFont): adjust
	(getLayoutFont): adjust

	* paragraph_funcs.[Ch] (realizeFont): remove unneeded arguments.

2003-04-15  John Levon  <levon@movementarian.org>

	From Angus Leeming

	* lyx_main.C: handle Include in .ui files

2003-04-15  John Levon  <levon@movementarian.org>

	* MenuBackend.C: make the doc files length shorter

	* ToolbarBackend.h:
	* ToolbarBackend.C: handle toolbar placement flags,
	Minibuffer

2003-04-15  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph_pimpl.C (simpleTeXSpecialChars): take a outerfont arg,
	adjust

	* paragraph_funcs.C (TeXOnePar): adjust

	* paragraph.C (getLabelFont): add outerfont arg, adjust
	(getLayoutFont): ditto
	(simpleTeXOnePar): adjust

	* paragraph_pimpl.C (realizeFont): delete func

2003-04-14  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (beforeFullRowInset): added a bad getchar check, removed
	row argument, constify cur argument.

2003-04-15  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (getFont): adjust
	(getLayoutFont): adjust
	(getLabelFont): adjust

	* paragraph_funcs.C (TeXOnePar): adjust
	(outerFont): new func...
	(realizeFont): ...moved out from here, changed this to facilitate
	transition

	* paragraph.C (getFont): take outerfont as arg, adjust
	(simpleTeXOnePar): add outerfont arg, adjust

	* buffer.C (simpleLinuxDocOnePar): adjust
	(simpleDocBookOnePar): adjust

	* CutAndPaste.C (pasteSelection): adjust

	* BufferView.C (getEncoding): adjust

2003-04-14  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (setCharFont): adjust
	(setCounter): adjust

	* text.C (leftMargin): adjust
	(setHeightOfRow): adjust

	* rowpainter.C (paintFirst): adjust
	(paintLast): adjust

	* paragraph_pimpl.C (realizeFont): adjust

	* paragraph.C (isFirstInSequence): move from here...
	* paragraph_funcs.C (isFirstInSequence): ...to here

	* paragraph.C (outerHook): move from here...
	* paragraph_funcs.C (outerHook): ...to here

	* paragraph.C (depthHook): move from here...
	* paragraph_funcs.C (depthHook): ...to here

	* paragraph.C (getEndLabel): move from here...
	* paragraph_funcs.C (getEndLabel): ...to here

	* text2.C (realizeFont): move from here...
	* paragraph_funcs.C (realizeFont): ...to here

2003-04-14  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C (gotoNextInset): use separate tmp vars for par and pos.

2003-04-14  Angus Leeming  <leeming@lyx.org>

	* LColor.[Ch]: scrap LColor mathcursor.

2003-04-14  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxlex.[Ch] (text): delete function
	* trans.C (Load): adjust
	* paragraph_funcs.C (readParToken): adjust

2003-04-14  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxlex_pimpl.h: get rid of LEX_MAX_BUFF, change buff to be a
	vector<char> instead of a char[].

	* lyxlex_pimpl.C (getString): adjust
	(next): adjust
	(lex): use getString
	(eatLine): adjust
	(nextToken): adjust

	* lyxlex.C (text): use pimpl_->getString()
	(getBool): ditto
	(findToken): ditto

2003-04-14  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (getInset): temp vars for cursor.par() and cursor.pos()
	(makeFontEntriesLayoutSpecific): temp var for par.size()
	(setLayout): temp var for ownerParagraphs().end()
	(fullRebreak): temp var for rows().end()
	(selectionAsString): temp var for boost::next(startpit), realize
	that the while really is a regular for loop.
	(cursorEnd): temp vars for cursor.row(), lastPos ++, only call
	setCursor in one place.
	(setParagraph): temp vr for ownerParagraphs().end()
	(updateCounters): make the while loop a for loop
	(cutSelection): temp var for ownerParagraphs().end()
	(updateInset): make the do {} while() a regular for loop
	(getCursorX): use temp vars
	(setCurrentFont): use temp vars
	(getColumnNearX): use temp vars

2003-04-13  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text.C (transformChar): use temp var for getChar
	(computeBidiTables): use temp var for row->par()
	(fill): move temp vars for row->par() and pit->layout() earlier in
	the function.
	(labelFill): use temp var for row->par()
	(setHeightOfRow): do not allow rit to be RowList::end, get rid of
	asc and desc, realize that pit never changes and that firstpit is
	just a duplicate and not needed. Exchange rit->par() with pit in a
	lot of places.
	(breakAgain): use a temp var for boost::next(rit)
	(breakAgainOneRow): ditto
	(breakParagraph): use a temp var for rows().begin()
	(prepareToPrint): move nlh into minimal scope, use temp var for rit->par()
	(cursorRightOneWord): use temp var for cursor.par() and
	cursor.pos(), remove usage of tmpcursor.
	(cursorLeftOneWord): use temp var for cursor.par() and
	cursor.pos() only set cur at end of function.

2003-04-13  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text.C, text2.C: exchange all usage of Paragraph::next with
	boost::next(ParagraphList::iterator)

	* CutAndPaste.C (cutSelection): change 2. arg to a Paragraph*

	* text2.C (cursorTop): simplify implementation
	(cursorBottom): ditto
	(setParagraph): use ParagraphList::iterator
	(setCurrentFont): adjust
	(getColumnNearX): adjust
	(cursorRight): adjust
	(cursorLeft): remove usage of Paragraph::previous
	(cursorUpParagraph): ditto
	(deleteEmptyParagraphMechanism): slight cleanup

	* text.C (isBoundary): take a Paragraph const & instead of a
	pointer as arg.
	(addressBreakPoint): ditto
	(leftMargin): remove usage of Paragraph::previous.
	(setHeightOfRow): ditto
	(cursorLeftOneWord): ditto
	(selectNextWordToSpellcheck): ditto
	(Delete): ditto
	(backspace): ditto
	(breakParagraph): remove one usage of Paragraph::next
	(redoParagraph): ditto
	(acceptChange): ditto
	(insertChar): adjust
	(rowBreakPoint): adjust

	* bufferview_funcs.C (toggleAndShow): adjust

2003-04-11  Alfredo Braunstein  <abraunst@libero.it>

	* lyxrow.[Ch]: add a cached y position to a Row and Row::y()
	methods to access it.
	* lyxtext.h:
	* text.C: Added updateRowPositions to compute all row positions.
	Make top_y and getRowNearY() to use the cached y position

2003-04-11  John Levon  <levon@movementarian.org>

	* text.C (rowBreakPoint): reintroduce the labelEnd
	checks, code copied from the row fill stuff. Deep voodoo.

	* text.C (fill): add a comment and debugging for the
	next poor soul.

2003-04-11  John Levon  <levon@movementarian.org>

	* text.C: make sure fullrow insets get wrapped to the next line,
	even when they're in a manual label

2003-04-10  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (insertParagraph): make it take ParagraphList::iterator
	as arg.
	(setLayout): make it return ParagraphList::iterator
	(redoParagraphs): ditto
	(setCounter): ditto
	(checkParagraph): ditto

	* text.C (getRow): make getrow take ParagraphList::iterator as arg

	* text2.C: adjust several funcs.
	(realizeFont): take a ParagraphList::iterator as arg.
	(getLayoutFont): ditto
	(getLabelFont): ditto
	(setCharFont): ditto

	* text.C: adjust several funcs.

2003-04-09  Alfredo Braunstein  <abraunst@libero.it>

	* text.C (selectNextWordToSpellcheck): don't accidentally
	skip insets

2003-04-10  John Levon  <levon@movementarian.org>

	* ToolbarBackend.C (getIcon): special handling for
	LFUN_MATH_DELIM

2003-04-09  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (cursorRight): a getChar assert fixed

2003-04-09  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (getFont): change to take a ParagraphList::iterator
	instead of Paragraph*
	Adjust several functions.

	* text.C (transformChar): change to take a ParagraphList::iterator
	instead of Paragraph*
	(singleWidth): ditto
	Adjust several functions.

	* rowpainter.C: adjust several functions
	* rowpainter.h:store a ParagraphList::iterator and not a
	Paragraph&.


2003-04-09  John Levon  <levon@movementarian.org>

	* lyxfunc.C:
	* lfuns.h:
	* LyXAction.h:
	* LyXAction.C: remove LFUN_APROPOS, LFUN_GETTIP,
	and the "help" bits as well

2003-04-09  John Levon  <levon@movementarian.org>

	* ToolbarBackend.h:
	* ToolbarBackend.C: allow multiple toolbars

2003-04-09  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* undo_funcs.C (setCursorParUndo): adjust

	* text_funcs.C (transposeChars): adjust

	* text3.C (gotoNextInset): adjust
	(dispatch): adjust

	* text2.C (setLayout): adjust
	(changeDepth): adjust
	(setFont): adjust
	(redoParagraphs): adjust
	(selectionAsString): adjust
	(setParagraph): adjust
	(insertInset): adjust
	(cutSelection): adjust
	(copySelection): adjust
	(pasteSelection): adjust
	(insertStringAsLines): adjust
	(updateInset): adjust
	(setCursor): change to take a ParagraphList::iterator parameter
	(setCursorIntern): change to take a ParagraphList::iterator parameter
	(setCurrentFont): adjust
	(cursorLeft): adjust
	(cursorRight): adjust
	(deleteEmptyParagraphMechanism): adjust

	* text.C (breakParagraph): adjust
	(insertChar): adjust
	(acceptChange): adjust
	(rejectChange): adjust
	(selectNextWordToSpellcheck): adjust
	(changeCase): adjust
	(Delete): adjust
	(backspace): adjust

	* lyxfind.C (SearchForward): adjust
	(SearchBackward): adjust
	(nextChange): adjust

	* lyxcursor.C (par): adjust

	* lyxcursor.h: store a ParagraphList::iterator instead of a
	Paragraph*

	* lyx_cb.C (getPossibleLabel): adjust

	* bufferview_funcs.C (toggleAndShow): adjust

	* BufferView_pimpl.C (resizeCurrentBuffer): adjust
	(dispatch): adjust

	* BufferView.C (removeAutoInsets): adjust
	(lockedInsetStoreUndo): adjust

2003-04-09  John Levon  <levon@movementarian.org>

	* ToolbarBackend.C: try icon without argument
	if with argument fails

2003-04-08  John Levon  <levon@movementarian.org>

	* ToolbarBackend.h:
	* ToolbarBackend.C: add getIcon(), handle tooltip,
	and change from "Icon" to "Item".

2003-04-08  Alfredo Braunstein  <abraunst@libero.it>

	* BufferView.C (lockInset): another bad getchar crunched

2003-04-08  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (changeDepth): do not setUndo on test_only (make undo work
	again)

2003-04-05  Alfredo Braunstein  <abraunst@libero.it>

	* lyxfind.C (searchForward, searchBackwards): bug 782

2003-04-07  John Levon  <levon@movementarian.org>

	* paragraph.C: remove dead comment

	* text.C: remove troublesome depth-fiddling code
	in leftMargin() and rightMargin() (bug 1017)

	* text.C: fix breaking of rows in nested lists
	(bug 1004)

	* text2.C (updateCounters): fix up depth values
	(bug 1013)

2003-04-07  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C: clear message when doc finishes resizing,
	and after a mouse event

	* lyxfunc.C: clear message after exiting inset

2003-04-07  John Levon  <levon@movementarian.org>

	* bufferview_funcs.C: show math status not outside
	status in the statusbar

2003-04-07  John Levon  <levon@movementarian.org>

	* lyxfunc.C: note status changed after a depth change

2003-04-04  Angus Leeming  <leeming@lyx.org>

	* LaTeX.h: move AuxInfo operator==, != out of line.
	Remove LaTeX virtual destructor; nothing derives from it.
	Move operator()() out of public area and rename it startscript().
	Change protected for private.

2003-04-04  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C:
	* text2.C: remove unneeded #includes.

2003-04-03  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (dEPM): fix the heigth of the next row

2003-04-03  Alfredo Braunstein  <abraunst@libero.it>

	* text.C: squashed an invalid getChar requester + some ws changes

2003-04-03  John Levon  <levon@movementarian.org>

	* bufferview_funcs.h:
	* bufferview_funcs.C:
	* lyxfunc.C:
	* lyxtext.h:
	* text2.C: make getStatus work for the env depth lfuns

2003-04-03  John Levon  <levon@movementarian.org>

	* bufferview_funcs.h:
	* bufferview_funcs.C:
	* lyxfunc.C:
	* lyxtext.h:
	* text2.C: parlistize decDepth(), by merging it with incDepth()

2003-04-03  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxrow.h: store a ParagraphList::iterator instead of a
	Paragraph* and adjust other class functions to suit.

	* lyxrow_funcs.C, text.C, text2.C, text3.C: adjust because of the
	above.

2003-04-01  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (setCursor): do not anchor to cursor row for the time being

2003-04-02  John Levon  <levon@movementarian.org>

	* LyXAction.C:
	* lfuns.h:
	* lyx_main.C:
	* lyxtext.h:
	* text.C:
	* text3.C: rename the "tab" lfuns. Remove tab support from normal text

2003-04-02  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph.h: make ParagraphList and ParagraphList::iterator
	friends of Paragraph.

	* buffer.C (makeLinuxDocFile): move towards ParagraphList

	* ParagraphList.C: Use the private next_ and previous_ from
	Paragraph.

2003-04-01  John Levon  <levon@movementarian.org>

	* ToolbarBackend.h:
	* ToolbarBackend.C:
	* Makefile.am: rename, remove defaults gunk

	* MenuBackend.h:
	* MenuBackend.C: remove defaults gunk

	* Languages.h:
	* Languages.C: remove defaults gunk

	* lyx_main.h:
	* lyx_main.C: error out if files couldn't be found.

2003-04-02  John Levon  <levon@movementarian.org>

	* text2.C: make incDepth() use parlist

2003-04-02  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* undo_funcs.C (firstUndoParagraph): adjust

	* text3.C (gotoInset): adjust
	(dispatch): adjust, and rewrite loop.

	* text2.C (init): adjust, and rewrite loop.
	(redoParagraphs): adjust
	(updateInset): adjust, and rewrite loop.
	(deleteEmptyParagraphMechanism): adjust

	* tabular.C (LyXTabular): adjust
	(SetMultiColumn): adjust
	(TeXRow): adjust

	* lyxtext.[Ch] (ownerParagraph): delete function
	(ownerParagraphs): new function returns a ParagraphList.

	* BufferView.C (removeAutoInsets): adjust
	(insertErrors): adjust
	(setCursorFromRow): adjust

2003-04-01  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (buffer): ensure that the Layout is correct
	in the frontends.

2003-04-02  John Levon  <levon@movementarian.org>

	* lyxtext.h:
	* text.C:
	* Makefile.am:
	* text_funcs.h:
	* text_funcs.C: make transposeChars a free function

	* lyxrow_funcs.C: remove wrong comment

2003-04-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxtext.h: adjust
	* rowpainter.C: adjust
	* text.C: adjust
	* text2.C: adjust
	* text3.C: adjust

	* lyxrow_funcs. [Ch]: new files

	* lyxrow.[Ch]: remove next and previous pointers
	(next,previous): remove accessor functions
	(isParEnd): move to lyxrow_funcs
	(lastPos): move to lyxrow_funcs
	(nextRowIsAllInset): move to lyxrow_funcs
	(lastPrintablePos): move to lyxrow_funcs
	(numberOfSeparators): move to lyxrow_funcs
	(numberOfHfills): move to lyxrow_funcs
	(numberOfLabelHfills): move to lyxrow_funcs
	(hfillExpansion): move to lyxrow_funcs

	* lyxfunc.C: adjust

	* bufferview_funcs.C (toggleAndShow): adjust

	* RowList.h: Remove class RowList from file leave just a
	std::list<Row>.

	* RowList.C: delete file

	* Makefile.am (lyx_SOURCES): remove RowList.C, add lyxrow_funcs.C
	and lyxrow_funcs.h

2003-04-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text3.C (cursorPrevious): adjust
	(cursorNext): adjust
	(dispatch): adjust

	* text2.C (redoHeightOfParagraph): adjust
	(redoDrawingOfParagraph): adjust
	(setCursor): adjust

	* text.C (breakParagraph): adjust
	(insertChar): adjust
	(backspace): adjust

	* rowpainter.C (RowPainter): adjust
	(leftMargin): simplify and adjust
	(most rowpainter functions): adjust.

	* rowpainter.h: store the row as RowList::iterator not as Row*

	* lyxcursor.C (row): taka RowList::iterator as arg
	(irow): ditto

	* lyxcursor.h: make the LyXCursor store RowList::iterators instead
	of Row*.

2003-04-01  Angus Leeming  <leeming@lyx.org>

	* bufferview_funcs.C (string2font): rewrite so that it no longer uses
	stuff like bool Bool.

2003-04-01  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (redoParagraphs): fix a bug (introduced by myself) and
	rewrite a loop

2003-04-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (redoParagraphs): rewrite (with help from Alfredo) for
	RowList::iterator.

	* lyxtext.h (rows): drop one version and leve a const variant that
	returns a RowList::iterator.

2003-03-31  Angus Leeming  <leeming@lyx.org>

	* text.C (fill): ensure that the signature is the same as that in the
	header file.

2003-03-31  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (redoParagraphs): adjust
	(updateCounters): adjust
	(checkParagraph): adjust
	(getColumnNearX): adjust and reformat a bit.

	* text.C (top_y): adjust
	(workWidth): adjust
	(leftMargin): adjust
	(prepareToPrint): adjust
	(getRow): adjust
	(getRowNearY): adjust

	* lyxtext.h: make rowlist_ mutable.

	* RowList.h: add const_iterator
	* RowList.C: adjust for RowList::const_iterator.

	* text2.C (getCursorX): make it take a RowList::iterator as arg,
	adjust.

2003-03-31  John Levon  <levon@movementarian.org>

	* lyxrc.h:
	* lyxrc.C: moved pdf_mode and use_gui to elsewhere

	* lyx_main.C: set default fonts from using lyx_gui funcs

	* exporter.C: pdf_mode moved from lyxrc

	* lyx_cb.C:
	* lyxfunc.C: changes from above

2003-03-31  John Levon  <levon@movementarian.org>

	* lyx_main.C: fix to the last fix

2003-03-31  John Levon  <levon@movementarian.org>

	* bufferlist.C: "Load original" -> "Load Original"

	* converter.C:
	* exporter.C:
	* importer.C:
	* lyx_main.C:
	* format.C: more Alert cleanups

2003-03-30  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (removeParagraph): make it take a RowList::iterator as
	arg, adjust.
	(getColumnNearX): make it take a RowList::iterator as arg, adjust.
	(postRowPaint): make it take a RowList::iterator as arg, adjust.

	* text.C (anchor_row): make it take a RowList::iterator as arg,
	adjust.
	(computeBidiTables): make it take a const reference to Row instead
	of Row pointer, adjust.
	(leftMargin): make it take a RowList::iterator as arg, adjust.
	(rowBreakPoint): adjust
	(breakAgainOneRow): make it take a RowList::iterator as arg,
	adjust.
	(prepareToPrint): make it take a RowList::iterator as arg, adjust.

	* bufferview_funcs.C (toggleAndShow): adjust

2003-03-30  John Levon  <levon@movementarian.org>

	* Makefile.am:
	* BoostFormat.h:
	* boost-inst.C: moved to support

	* several files: changes as a result

2003-03-30  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (LyXText): adjust.
	(init): adjust
	(removeRow): make it take a RowList::iterator as arg, adjust.
	(fullRebreak): adjust
	(deleteEmptyParagraphMechanism): adjust
	(clearPaint): adjust
	(postPaint): adjust

	* text.C (top_y): adjust
	(setHeightOfRow): make it take a RowList::iterator as arg, adjust.
	(breakAgain): make it take a RowList::iterator as arg, adjust.
	(breakParagraph): adjust
	(insertChar): adjust
	(backspace): adjust

	* lyxtext.h: make anchor_row_ be a RowList::iterator, ditto
	need_break_row, and refresh_row.

	* text3.C (dispatch): adjust

	* text2.C (checkParagraph): adjust
	(setCursor): adjust
	(setCursorFromCoordinates): adjust

	* text.C (top_y): adjust
	(workWidth): adjust
	(getRow): make it return a RowList::iterator, adjust
	(getRowNearY): make it return a RowList::iterator, adjust

	* text2.C (init): adjust
	(insertRow): remove function
	(insertParagraph): adjust
	(redoParagraphs): adjust
	(fullRebreak): adjust
	(updateCounters): adjust

	* text.C (top_y): rewrite to use RowList iterators.
	(top_y): adjust
	(setHeightOfRow): rewrite to sue RowList iterators.
	(appendParagraph): adjust
	(breakAgain): adjust
	(breakAgainOneRow): adjust
	(breakParagraph): adjust
	(getRow): adjust
	(getRowNearY): adjust, and remove commented code.

	* lyxtext.h (firstRow): delete function
	(lastRow): delete function
	(rows): new function (const and non-const versions.)
	(insertRow): delete function

	* lyxrow.[Ch] (Row): new constructor taking a par and a pos

2003-03-29  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C: always update scrollbar top
	because pasting text when we're anchored could mean we
	miss an update altogether

2003-03-29  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (init): use rowlist_.end() and not 0.
	(insertRow): change to take a RowList::iterator as arg, adjust
	for this.
	(insertParagraph): change to take a RowList::iterator as arg,
	adjust for this.
	(redoParagraphs): remove some debug msgs.

	* text.C (appendParagraph): change to take a RowList::iterator
	arg, adjust for this.
	(breakAgain): add an assert
	(breakAgainOneRow): ditto

2003-03-29  John Levon  <levon@movementarian.org>

	* text2.C: do not clear selection after inc/decDepth
	(bug 550)

2003-03-29  John Levon  <levon@movementarian.org>

	* BufferView.C:
	* buffer.C: fix broken strerrors according to Lars

2003-03-29  John Levon  <levon@movementarian.org>

	* converters.C: more Alert cleanups

2003-03-29  John Levon  <levon@movementarian.org>

	* bufferview_funcs.C: remove pointless Alert

	* buffer.C: fix confusing error message when
	a template is chmoded 000

2003-03-29  John Levon  <levon@movementarian.org>

	* BufferView.C:
	* BufferView.h:
	* BufferView_pimpl.C: Alert fixes

	* Makefile.am:
	* tabular.C:
	* tabular-old.C: remove unused table compat reading

2003-03-29  John Levon  <levon@movementarian.org>

	* BufferView.C:
	* buffer.C:
	* lyx_cb.h:
	* lyx_cb.C: more Alert cleanups

	* lyxfunc.C: don't allow chktex if not latex document

2003-03-29  John Levon  <levon@movementarian.org>

	* lyx_cb.C:
	* BufferView.C:
	* buffer.C: warnings pushed down from support/,
	kill err_alert

2003-03-29  John Levon  <levon@movementarian.org>

	* lyxfunc.C: safety check for C-r (revert)

2003-03-29  John Levon  <levon@movementarian.org>

	* bufferlist.h:
	* bufferlist.C: several UI fixes using Alert::prompt.
	Fix the pointless looping quit code. Fix stupid revert
	behaviour (bug 938)

	* lyxvc.h:
	* lyxvc.C:
	* lyx_cb.C: use Alert::prompt

	* lyx_main.C: remove a silly question

	* lyxfunc.C: remove a couple of silly questions,
	use Alert::prompt

2003-03-28  John Levon  <levon@movementarian.org>

	* text2.C: fix bug 974 (End on empty par)

2003-03-28  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C:
	* LyXAction.C:
	* lfuns.h: remove do-nothing math greek lfuns

2003-03-27  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxgluelength.h (isValidGlueLength): add default arg on
	parameter 2. Remove default arg from friend in class.

	* lyxlength.h (isValidLength): add default arg on parameter 2.
	Remove default arg from friend in class.

	* text2.C (LyXText): adjust, initialize refresh_row.
	(init): adjust
	(removeRow): adjust
	(insertRow): adjust
	(insertParagraph): adjst
	(redoParagraphs): adjust
	(fullRebreak): adjust
	(updateCounters): adjust
	(deleteEmptyParagraphMechanism): first attempt at fixing a
	crashing bug.

	* text.C (top_y): adjust
	(setHeightOfRow): adjust
	(getRow): adjust
	(getRowNearY): adjust

	* lyxtext.h: include RowList.h
	(~LyXText): not needed anymore, deleted.
	(firstRow): modify for RowList
	(lastRow): new function
	Delete firstrow and lastrow class variables, add a Rowlist
	rowlist_ class variable.

	* lyxrow.C (lastPos): use empty() and not !size() to check if a
	paragraph is empty.

	* RowList.C (insert): fix case where it == begin().

2003-03-26  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (dispatch): changes to the Dialogs interface for
	the thesaurus dialog.

2003-03-26  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* Makefile.am (lyx_SOURCES): add RowList.[Ch]

	* RowList.[Ch]: new files

	* ParagraphList.C (erase): handle the case where it == begin
	correctly.

2003-03-25  John Levon  <levon@movementarian.org>

	* Makefile.am:
	* aspell_local.h:
	* aspell.C: add new aspell support

	* lyxrc.h:
	* lyxrc.C: Make use_pspell be use_spell_lib. Always
	have it accessible.

2003-03-25  Angus Leeming  <leeming@lyx.org>

	* lfuns.h:
	* LyXAction.C (init): new LFUN_INSET_INSERT.

	* BufferView_pimpl.C (dispatch): split out part of the
	LFUN_INSET_APPLY block LFUN_INSET_INSERT.

	* factory.C (createInset): act on LFUN_INSET_INSERT rather than
	LFUN_INSET_APPLY.

2003-03-25  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): changes to the Dialogs interface.

2003-03-25  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C:
	* text3.C: remove useless row->height(0)

2003-03-25  John Levon  <levon@movementarian.org>

	* lyxtext.h:
	* text2.C:
	* text3.C: rename the refreshing stuff to better names

2003-03-24  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.h:
	* BufferView_pimpl.C: update layout choice on a mouse
	press/release

2003-03-23  John Levon  <levon@movementarian.org>

	* Makefile.am: fix commandtags.h reference

2003-03-22  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C:
	* lyxtext.h:
	* rowpainter.C:
	* rowpainter.h:
	* text.C:
	* text2.C: remove CHANGED_IN_DRAW, it cannot happen now

2003-03-21  Alfredo Braunstein  <abraunst@libero.it>

	* lyxtext.h:
	* text.C: take the rtl methods out of line

2003-03-21 André Pönitz <poenitz@gmx.net>

	* metricsinfo.[Ch]: new files containing structures to be passed around
	during the two-phase-drawing...

2003-03-21 André Pönitz <poenitz@gmx.net>

	* lyxtextclass.C: read 'environment' tag.

2003-03-20  Alfredo Braunstein  <abraunst@libero.it>

	* text2.C (removeRow): fix bug 964

2003-03-20  John Levon  <levon@movementarian.org>

	* rowpainter.C:
	* text.C:
	* text2.C: paint cleanups. Inset::update() dropped font
	parameter

2003-03-19  John Levon  <levon@movementarian.org>

	* lyxfunc.C: only fitcursor/markDirty if available()

2003-03-19  John Levon  <levon@movementarian.org>

	* commandtags.h: rename to ...

	* lfuns.h: ... this, and renumber / cleanup

2003-03-19  John Levon  <levon@movementarian.org>

	* lyxfunc.C: mark buffer dirty if we executed a "dirtying" lfun.
	fit the cursor after an lfun

	* BufferView.h:
	* BufferView.C:
	* BufferView_pimpl.h:
	* BufferView_pimpl.C: remove BufferView::FITCUR/CHANGE

	* LyXAction.C: layout-character should have ReadOnly

	* ParagraphParameters.C:
	* buffer.C:
	* bufferview_funcs.C:
	* lyx_cb.C:
	* lyxfind.C:
	* lyxtext.h:
	* text.C:
	* text2.C:
	* text3.C:
	* undo_funcs.C: changes from above

2003-03-18  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C (scrollDocView): add updateLayoutChoice(),
	remove it from update()

	* lyxfunc.C: update layout choice after an lfun

	* text3.C: remove extra updateLayoutChoice()s

2003-03-18  John Levon  <levon@movementarian.org>

	* text.C: top_y change means full repaint, fix
	a drawing bug with cursor movement

2003-03-18  Alfredo Braunstein  <abraunst@libero.it>

	* lyxtext.h:
	* text.C:
	* text2.C: anchor row on setCursor

2003-03-18  Alfredo Braunstein  <abraunst@libero.it>

	* lyxtext.h: remove almost all mutable keywords
	* text.C:
	* text2.C:
	* text3.C: remove const keywords accordingly

2003-03-17  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph_funcs.C (TeXDeeper): reduce number of args, move into
	anon namespace
	(TeXEnvironment): ditto
	(TeXOnePar): ditto

2003-03-17  John Levon  <levon@movementarian.org>

	* text.C (rowBreakPoint): remove attempt to fix displayed
	math insets inside a manual label

2003-03-17  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxtext.h: remove BufferView* as first arg from almost all class
	functions.
	* other files: adjust.

2003-03-17  John Levon  <levon@movementarian.org>

	* lyxtext.h:
	* undo_funcs.C:
	* text2.C: more paint cleanups

	* BufferView_pimpl.C: screen prototype changed, use postPaint etc.

	* rowpainter.h:
	* rowpainter.C: remove "smart" background painting code

2003-03-16  John Levon  <levon@movementarian.org>

	* lyxtext.h:
	* text.C:
	* text2.C:
	* text3.C: add helper functions for setting refresh_row/y

2003-03-14  Kayvan Sylvan  <kayvan@sylvan.com>

	* paragraph_pimpl.C (simpleTeXSpecialChars): Added fix for the
	newline inset which *can* get inserted in the pass_thru layouts.
	This is primarily for literate documents.

2003-03-14  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C: increment LYX_FORMAT to 223

2003-03-14 André Pönitz <poenitz@gmx.net>

	* textclass.h: prepare for environment handling, ws changes
	* lyxlayout.C: read latexheader and latexfooter tags

2003-03-14  John Levon  <levon@movementarian.org>

	* text2.C: rewrite ::status() a bit

2003-03-13  John Levon  <levon@movementarian.org>

	* lyxtext.h: add some docs

2003-03-13  John Levon  <levon@movementarian.org>

	* lyxtext.h:
	* text.C:
	* text2.C:
	* text3.C: remove pointless 2nd arg to setHeightOfParagraph()

2003-03-13  John Levon  <levon@movementarian.org>

	* text3.C: fix appendix redrawing

2003-03-13  John Levon  <levon@movementarian.org>

	* text.C (setHeightOfRow):
	* rowpainter.h:
	* rowpainter.C: make appendix mark have the text
	  "Appendix" so the user knows what it is

	* LColor.h:
	* LColor.C: s/appendixline/appendix/ from above

2003-03-13  John Levon  <levon@movementarian.org>

	* paragraph_pimpl.C: fix Andre's backing out of the strong assertion

	* text.C: fix a getChar(pos) bug properly

2003-03-13  Angus Leeming  <leeming@lyx.org>

	* commandtags.h:
	* LyXAction.C (init): new LFUNs PARAGRAPH_APPLY and PARAGRAPH_UPDATE.
	Probably only temporary. Let's see how things pan out.

	* BufferView.C (unlockInset):
	* BufferView_pimpl.C (fitCursor):
	replace Dialogs::updateParagraph with dispatch(LFUN_PARAGRAPH_UPDATE).

	* BufferView_pimpl.C (dispatch): code for LFUNs LAYOUT_PARAGRAPH,
	PARAGRAPH_UPDATE, PARAGRAPH_APPLY.

	* ParagraphParameters.[Ch] (setParagraphParams, params2string):
	new functions that convert ParagraphParameters to and from a string.

	* lyxfunc.C (dispatch): move LFUN_LAYOUT_PARAGRAPH to
	BufferView::Pimpl's dispatch.
	In LFUN_ESCAPE, dispatch LFUN_PARAGRAPH_UPDATE.

2003-03-13 André Pönitz <poenitz@gmx.net>

	* lyxfunc.C:
	* text3.C:
	* factory.C: make it aware of InsetEnv

2003-03-13  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (setCursor): never ask for one past last
	(setCursor): add some debugging messages.

	* text.C (singleWidth): never ask for one past last
	(singleWidth): ditto
	(leftMargin): ditto
	(rightMargin): ditto
	(rowBreakPoint): ditto
	(setHeightOfRow): ditto
	(prepareToPrint): ditto

	* rowpainter.C (paintBackground): never ask for one past last
	(paintText): never ask for one past last

	* paragraph_pimpl.C (getChar): make the assert stricter, never
	allow the one past last pos to be taken

	* paragraph.C (getChar): ws changes only

	* lyxrow.C (nextRowIsAllInset): never ask for one past last
	(numberOfSeparators): ditto
	(numberOfHfills): ditto

2003-03-12  John Levon  <levon@movementarian.org>

	* author.h:
	* author.C:
	* bufferparams.h:
	* bufferparams.C:
	* paragraph_funcs.C: fix per-buffer authorlists

2003-03-12  John Levon  <levon@movementarian.org>

	* text.C: fix newline in right address

2003-03-12  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (dispatch): remove LFUNs from switch as they
	duplicate those in LyXFunc::dispatch.

	* commandtags.h:
	* LyXAction.C:
	* ToolbarDefaults.C:
	rename LFUN_FREE as LFUN_FONTFREE_APPLY.
	Add LFUN_FONTFREE_UPDATE.

	* lyxfunc.C (dispatch): code for LFUN_FREEFONT_APPLY,
	LFUN_FREEFONT_UPDATE, LFUN_LAYOUT_CHARACTER.

	* bufferview_func.[Ch]: several new functions to facilliate
	transfer of data to and from the character dialog.

2003-03-12  John Levon  <levon@movementarian.org>

	* buffer.C:
	* paragraph.h:
	* paragraph.C:
	* paragraph_funcs.C:
	* paragraph_pimpl.C:
	* sgml.C:
	* tabular.C:
	* text.C:
	* text3.C: remove META_NEWLINE in favour of an inset

	* rowpainter.h:
	* rowpainter.C: remove paintNewline (done by inset)

2003-03-12  John Levon  <levon@movementarian.org>

	* paragraph_pimpl.C: complain about bad getChar()s
	for a while at least

2003-03-12  John Levon  <levon@movementarian.org>

	* buffer.h:
	* buffer.C: move paragraph read into a separate function,
	a little renaming to reflect that.

	* bufferparams.h:
	* bufferparams.C: remove the author_ids map, not necessary now

	* factory.h:
	* factory.C: moved Buffer::readInset to here

	* paragraph_funcs.h:
	* paragraph_funcs.C: readParagraph free function moved from
	buffer.C

	* tabular.C: name change

2003-03-12  John Levon  <levon@movementarian.org>

	* buffer.C:
	* ParagraphParameters.C: move par params input to
	a read() method

	* lyxlex_pimpl.C: make nextToken()/next() after a pushToken()
	behave like a normal read from the stream wrt reading
	a line vs. a \\token

2003-03-12  John Levon  <levon@movementarian.org>

	* paragraph.C:
	* ParagraphParameters.h:
	* ParagraphParameters.C: move output code to a
	::write() method

2003-03-12  John Levon  <levon@movementarian.org>

	* BufferView.C (insertLyXFile):
	* buffer.h:
	* buffer.C:
	* tabular.C: use a parlist iterator for creating the
	  document.

2003-03-12  John Levon  <levon@movementarian.org>

	* buffer.C: make current_change static local not
	  static file-scope

2003-03-12  John Levon  <levon@movementarian.org>

	* buffer.C: fix insertStringAsLines for change tracking

2003-03-12  John Levon  <levon@movementarian.org>

	* BufferView.C:
	* tabular.C:
	* buffer.h:
	* buffer.C:
	* bufferparams.h:
	* bufferparams.C: move author list into params. Rename some
	  functions. Move the header reading into a separate token
	  loop. Move the header token reading into BufferParams.

2003-03-12  John Levon  <levon@movementarian.org>

	* changes.C: put debug inside lyxerr.debugging() checks

2003-03-11 André Pönitz <poenitz@gmx.net>

	* factory.C: make it aware of InsetHFill

2003-03-10  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C (latexParagraphs): move function from here...
	* paragraph_funcs.C (latexParagraphs): ...to here, and adjust
	args.

2003-03-10  Angus Leeming  <leeming@lyx.org>

	* LyXAction.C (init): fix bug in poplating array with multiple entries
	with the same LFUN (spotted by JMarc).

2003-03-10  John Levon  <levon@movementarian.org>

	* text.C:
	* text2.C: move getColumnNearX() near its
	only call site

2003-03-10  John Levon  <levon@movementarian.org>

	* text.C: fix break before a minipage

2003-03-10  John Levon  <levon@movementarian.org>

	* text.C: fix the last commit

2003-03-09  John Levon  <levon@movementarian.org>

	* lyxtext.h:
	* text.C:
	* text2.C: clean up nextBreakPoint (now rowBreakPoint). Fix
	bug 365 (don't break before insets unless needed). Don't
	return a value > last under any circumstances.

2003-03-09  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (trackChanges, dispatch): call
	Dialogs::show("changes") rather than Dialogs::showMergeChanges().

2003-03-09  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): call Dialogs::show("about") rather
	than Dialogs::showAboutlyx().

2003-03-09  Angus Leeming  <leeming@lyx.org>

	* factory.C (createInset): call Dialogs::show("tabularcreate") rather
	than Dialogs::showTabularCreate().

2003-03-09  John Levon  <levon@movementarian.org>

	* lyxtext.h:
	* text.C:
	* text2.C: 3rd arg to nextBreakPoint was always the same.
	  Use references.

2003-03-08  John Levon  <levon@movementarian.org>

	* lyxrow.C:
	* paragraph.C:
	* paragraph.h:
	* rowpainter.C:
	* text.C:
	* text2.C: Remove the "main" bit from the "main body"
	  notion.

2003-03-08  John Levon  <levon@movementarian.org>

	* text.C (leftMargin): The left margin of an empty
	manual label paragraph should not include the label width
	string length.

	* text.C (prepareToPrint): don't attempt to measure hfills
	for empty manual label paragraphs - the answer should be 0

2003-03-08  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* CutAndPaste.C: remove commented code and reindent.

2003-03-08  John Levon  <levon@movementarian.org>

	* lyxfunc.h:
	* lyxfunc.C: move reloadBuffer()

	* BufferView.h:
	* BufferView.C: to here

	* lyxvc.C: add comment

	* vc-backend.h:
	* vc-backend.C: call bv->reload() to avoid
	  getStatus() check on MENURELOAD

2003-03-07  Dekel Tsur  <dekelts@tau.ac.il>

	* LaTeX.C (run): Fix a bug where the DVI file was not updated due
	to an old format .dep file.

2003-03-07  Angus Leeming  <leeming@lyx.org>

	* text3.C (dispatch): remove the 'gross hack' of calling inset->edit
	when the LFUN_MOUSE_RELEASE should have been handled by
	inset->localDispatch.

2003-03-07  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (dispatch):
	* LyXAction.C (init):
	* ToolbarDefaults.C (init):
	* commandtags.h:
	* lyxfunc.C (getStatus):
	remove LFUN_INSET_GRAPHICS.

	* factory.C (createInset): add "graphics" to LFUN_INSET_APPLY.

2003-03-07  Angus Leeming  <leeming@lyx.org>

	* commandtags.h:
	* LyXAction.C (init):
	* lyxfunc.C (getStatus): remove LFUN_REF_INSERT.

	* lyxfunc.C (getStatus): add LFUN_DIALOG_SHOW_NEW_INSET to switch.

	* commandtags.h:
	* LyXAction.C: add LFUN_INSET_DIALOG_UPDATE.

	* lyxfunc (dispatch): on LFUN_DIALOG_UPDATE, pass the 'open' inset's
	localDispatch method LFUN_INSET_DIALOG_UPDATE.

2003-03-07  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): add "include" to LFUN_SHOW_NEW_INSET and
	remove "ert".

2003-03-06  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* ParagraphList.C (front): new function
	(back): implement

2003-03-06  Alfredo Braunstein  <abraunst@libero.it>

	* lyxtext.h (top_y): added these 2 methods, and private vars top_row_
	and top_row_offset_. removed var first_y.
	* text.C (top_y):
	* text2.C (LyXText, removeRow):
	* text3.C:
	* BufferView_pimpl.C:
	use these methods instead of using first_y

2003-03-06  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (pasteSelection): adjust for checkPastePossible

	* CutAndPaste.C: remove Paragraph * buf and replace with
	ParagraphList paragraphs.
	(DeleteBuffer): delete
	(cutSelection): change the tc type to textclass_type
	(copySelection): change the tc type to textclass_type
	(copySelection): adjust for ParagraphList
	(pasteSelection): change the tc type to textclass_type
	(pasteSelection): adjust for Paragraphlist
	(nrOfParagraphs): simplify for ParagraphList
	(checkPastePossible): simplify for ParagraphList
	(checkPastePossible): remove unused arg

	* ParagraphList.C (insert): handle the case where there are no
	paragraphs yet.

	* CutAndPaste.h: make CutAndPaste a namespace.

	* text3.C (dispatch): adjust

	* text.C (breakParagraph): add a ParagraphList as arg

	* paragraph_funcs.C (breakParagraph): change to take a
	BufferParams and a ParagraphList as args.
	(breakParagraphConservative): ditto
	(mergeParagraph): ditto
	(TeXDeeper): add a ParagraphList arg
	(TeXEnvironment): ditto
	(TeXOnePar): ditto

	* buffer.C (readLyXformat2): adjust
	(insertStringAsLines): adjust
	(latexParagraphs): adjust

	* CutAndPaste.C (cutSelection): use 'true' not '1' as truth value.
	(cutSelection): adjust
	(pasteSelection): adjust

	* BufferView_pimpl.C (insertInset): adjust

2003-03-05  Angus Leeming  <leeming@lyx.org>

	* commandtags.h:
	* LyXAction.C (init):
	* BufferView_pimpl.C (dispatch):
	* lyxfunc.C (getStatus):
	remove LFUN_CHILD_INSERT.

	* factory.C (createInset): add "include" to LFUN_INSET_APPLY.

2003-03-05  Angus Leeming  <leeming@lyx.org>

	* commandtags.h:
	* LyXAction.C (init):
	* src/factory.C (createInset):
	* lyxfunc.C (getStatus):
	* text3.C (dispatch):
	remove LFUN_INSET_EXTERNAL and LFUN_INSERT_URL

	* factory.C (createInset): add "external" to LFUN_INSET_APPLY.

2003-03-05  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* ParagraphList.C (insert): handle insert right before end()
	(erase): fix cases where it can be first or last paragraph.

2003-03-04  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph_funcs.C (TeXEnvironment): remove all usage of
	Paragraph::next and Paragraph::previous
	(TeXOnePar): ditto

	* text.C (breakParagraph): adjust

	* paragraph_funcs.C (breakParagraph): take a Buffer* instead of a
	BufferParams& as arg.
	(breakParagraph): use ParagraphList::insert
	(breakParagraphConservative): take a Buffer* instead of a
	BufferParams& as arg.
	(breakParagraphConservative): use ParagraphList::insert.

	* buffer.C (insertStringAsLines): un-const it
	(insertStringAsLines): adjust

	* ParagraphList.C (insert): new function

	* CutAndPaste.C (pasteSelection): adjust

	* text.C (backspace): adjust

	* tabular.C (SetMultiColumn): adjust

	* CutAndPaste.C (cutSelection): adjust
	(pasteSelection): adjust

	* tabular.C (SetMultiColumn): make it take a Buffer* instead of a
	Buffer const * as arg

	* ParagraphList.C (erase): new function
	* paragraph_funcs.C (mergeParagraph): use it
	(mergeParagraph): make it take a Buffer* instead of a
	BufferParams* as arg

	* paragraph_funcs.C (breakParagraph): take ParagraphList::iterator
	as arg
	(breakParagraphConservative): ditto

	* paragraph.h: remove the breakParagraph friend

	* paragraph.C (eraseIntern): new function
	(setChange): new function

	* paragraph_funcs.C (mergeParagraph): make it take a
	ParagraphList::iterator instead of a Paragraph *, adjust
	accordingly.

	* paragraph.h: move an #endif so that the change tracking stuff
	also works in the NO_NEXT case.

2003-03-04  Angus Leeming  <leeming@lyx.org>

	* commandtags.h:
	* LyXAction.C: new LFUN_INSET_MODIFY.

	* BufferView_pimpl.C (dispatch): if an inset is found to be open
	on LFUN_INSET_APPLY, pass LFUN_INSET_MODIFY to its localDispatch.

2003-03-04  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* several files: ws changes only

	* paragraph_funcs.C (TeXOnePar): take ParagraphList::iterator as args
	(TeXEnvironment): ditto
	(TeXDeeper): ditto

	* buffer.C (makeLaTeXFile): adjust
	(latexParagraphs): make it take ParagraphList::iterator as args

2003-03-03  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* buffer.C (latexParagraphs): adjust

	* paragraph.C (TeXOnePar): move function...
	(optArgInset): move function...
	(TeXEnvironment): move function...
	* paragraph_pimpl.C (TeXDeeper): move function...
	* paragraph_funcs.C: ...here

	* tabular.C (UseParbox): rewrite to use ParagraphList iterators.

2003-03-02  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* buffer.C (readInset): remove compability code for old Figure and
	InsetInfo insets

2003-03-02  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* buffer.C: ws changes
	(readInset):

	* BufferView_pimpl.C: ditto
	* author.C: ditto
	* buffer.h: ditto
	* bufferlist.h: ditto
	* changes.h: ditto
	* lyxfunc.C: ditto

2003-02-28  Alfredo Braunstein <abraunst@libero.it>

	* converter.[Ch]: split into itself +
	* graph.[Ch]
	* format.[Ch]
	* Makefile.am: += graph.[Ch] + format.[Ch]
	* MenuBackend.C
	* buffer.C
	* exporter.C
	* importer.C
	* lyx_main.C
	* lyxfunc.C
	* lyxrc.C: added #include "format.h"

2003-02-27  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (dispatch): call a real, LyX dialog to insert
	  a label.

	* factory.C (createInset): add "label" to the factory.

	* lyx_cb.[Ch] (getPossibleLabel): rewrite MenuInsertLabel to return the
	  string and do no more.

2003-02-27  Angus Leeming  <leeming@lyx.org>

	* commandtags.h:
	* LyXAction.C (init):
	* factory.C (createInset):
	* BufferView_pimpl.C (dispatch):
	  collapse LFUN_XYZ_APPLY to LFUN_INSET_APPLY.

	* lyxfunc.C (getStatus): remove LFUN_BIBTEX_APPLY, LFUN_CITATION_APPLY.

	* lyxfunc.C (dispatch):
	* text3.C (dispatch): pass name to params2string.

2003-02-26  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (dispatch): collapse the various LFUN_XYZ_APPLY
	  blocks together.
	  Rearrange the ~includes. Strip out the unnecessary ones.

	* factory.C (createInset): reformat.
	  create new insets for the various LFUN_XYZ_APPLY lfuns.

2003-02-26  John Levon  <levon@movementarian.org>

	* lyxrow.h:
	* lyxrow.C: add isParStart,isParEnd helpers

	* paragraph.h: make isInserted/DeletedText take refs

	* paragraph_funcs.h:
	* paragraph_funcs.C: remove #if 0'd code

	* lyxtext.h:
	* text3.C:
	* text2.C:
	* text.C: use lyxrow helpers above.
	  Move draw and paint routines to RowPainter.
	  Make several methods use refs not pointers.
	  Make backgroundColor() const.
	  Add markChangeInDraw(), isInInset().
	  Merge changeRegionCase into changeCase.
	  Make workWidth() shouldn't-happen code into an Assert.

	* rowpainter.h:
	* rowpainter.C: new class for painting a row.

	* vspace.h:
	* vspace.C: make inPixels take a ref

2003-02-26  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (dispatch): use InsetCommand::localDispatch for
	LFUN_REF_APPLY.

2003-02-25  John Levon  <levon@movementarian.org>

	* ispell.C: give the forked command a more accurate name

2003-02-22  John Levon  <levon@movementarian.org>

	* toc.h:
	* toc.C: make TocItem store an id not a Paragraph *
	  (bug #913)

2003-02-21  Angus Leeming  <leeming@lyx.org>

	* commandtags.h: Retire LFUN_CITATION_INSERT, LFUN_CITATION_CREATE,
	  LFUN_INSERT_BIBTEX, LFUN_BIBTEX_STYLE, LFUN_BIBDB_ADD, LFUN_BIBDB_DEL.
	  Bring to life LFUN_DIALOG_SHOW_NEW_INSET, LFUN_DIALOG_SHOW_NEXT_INSET,
	  LFUN_DIALOG_UPDATE, LFUN_DIALOG_HIDE, LFUN_DIALOG_DISCONNECT_INSET,
	  LFUN_BIBITEM_APPLY, LFUN_BIBTEX_APPLY, LFUN_CITATION_APPLY,
	  LFUN_INDEX_APPLY, LFUN_REF_APPLY, LFUN_TOC_APPLY, LFUN_URL_APPLY,

	* BufferView_pimpl.C (dispatch):
	* LyXAction.C (init):
	* factory.C (createInset):
	* lyxfunc.C (getStatus, dispatch):
	* text3.C (dispatch): retire old LFUNs and bring new ones to life.

2003-02-21  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (MenuInsertLyXFile):
	* lyx_cb.C (WriteAs, getContentsOfAsciiFile):
	* lyxfunc.C (menuNew, open, doImport):
	  no longer pass a LyXView & to fileDlg.

2003-02-21  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C: replace insetbib.h with insetbibtex.h.
	* LyXAction.C: change, BIBKEY to BIBITEM.
	* buffer.C: replace insetbib.h with insetbibitem.h and insetbibtex.h.
	Change InsetBibKey to InsetBibitem.
	Change BIBKEY_CODE to BIBITEM_CODE.
	* commandtags.h: change LFUN_INSERT_BIBKEY to LFUN_INSERT_BIBITEM.
	* factory.C: replace insetbib.h with insetbibitem.h.
	Change LFUN_INSERT_BIBKEY to LFUN_INSERT_BIBITEM.
	* paragraph.C: replace insetbib.h with insetbibitem.h.
	* paragraph.[Ch]: change InsetBibKey to InsetBibitem.
	Change bibkey() to bibitem().
	* text.C: remove insetbib.h.
	* text2.C: replace insetbib.h with insetbibitem.h.
	change bibkey() to bibitem().
	* text3.C: remove insetbib.h.
	change LFUN_INSERT_BIBKEY to LFUN_INSERT_BIBITEM.

2003-02-18  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxrc.C (output): enclose user email in quotes (in case there are
	several words)

2003-02-18  John Levon  <levon@movementarian.org>

	* buffer.h: add std::

2003-02-17  John Levon  <levon@movementarian.org>

	* SpellBase.h:
	* ispell.h:
	* ispell.C:
	* pspell.h:
	* pspell.C: reworking. Especially in ispell, a large
	  number of clean ups and bug fixes.

	* lyxfunc.C: fix revert to behave sensibly

2003-02-17 André Pönitz <poenitz@gmx.net>

	* LyXAction.C:
	* commandtags.h: new LFUN_INSERT_BIBKEY

	* layout.h:
	* lyxlayout.C:
	* buffer.C:
	* factory.C:
	* text.C:
	* text2.C:
	* text3.C:
	* paragraph.[Ch]:
	* paragraph_func.C: remove special bibkey handling

2003-02-17  John Levon  <levon@movementarian.org>

	* text.C (Delete): fix case where delete at the end of
	  the very first paragraph would not merge the pars

2003-02-17  John Levon  <levon@movementarian.org>

	* lyxrow.C: fix lastPrintablePos()

2003-02-16  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* bufferparams.C (writeLaTeX): add a std:here

	* buffer.C: and remove a using directive there

2003-02-15  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* buffer.C (makeLaTeXFile): move the code that generates the
	  preamble...

	* bufferparams.C (writeLaTeX): ... in this new method

	* LaTeXFeatures.C (getEncodingSet): make const
	  (getLanguages): make const

	* MenuBackend.C (binding): returns the binding associated to this
	  action
	  (add): sets the status of each item by calling getStatus. Adds
	  some intelligence.
	  (read): add support for OptSubMenu
	  (expand): remove extra separator at the end of expanded menu

2003-02-15  John Levon  <levon@movementarian.org>

	* BufferView.C:
	* BufferView_pimpl.C:
	* bufferlist.h:
	* bufferlist.C: remove pointless BufferStorage bloat. Remove
	  inset code that had no actual effect. Remove unneeded status
	  code.

2003-02-14  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* buffer.C (makeLaTeXFile): fix counting of number of line feeds
	  in preamble

2003-02-14  Michael Schmitt <michael.schmitt@teststep.org>

	* text.C (drawLengthMarker): also draw an arrow marker for
	  symbolic lengths (medskip...)

2003-02-14  John Levon  <levon@movementarian.org>

	* tabular.h:
	* tabular.C: better method names

2003-02-14  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C:
	* bufferlist.C:
	* buffer.C:
	* converter.C:
	* lyx_cb.C:
	* lyxfunc.C: change prohibit/allowInput to busy(bool), as
	  it's a more accurate name. Remove some pointless uses.

2003-02-14  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text2.C (LyXText): change order of initilizers to shut off
	  warnings

2003-02-14  John Levon  <levon@movementarian.org>

	* buffer.C: use ParIterator for getParFromID()

	* paragraph.h:
	* paragraph.C:
	* paragraph_pimpl.h:
	* paragraph_pimpl.C: remove unused getParFromID()

2003-02-14  John Levon  <levon@movementarian.org>

	* buffer.C: remove some very old #if 0'd parse code

2003-02-13  John Levon  <levon@movementarian.org>

	* text.h:
	* text.C:
	* text2.C: move hfillExpansion(), numberOfSeparators(),
	  rowLast(), rowLastPrintable(), numberofHfills(),
	  numberOfLabelHfills() ...

	* lyxrow.h:
	* lyxrow.C: ... to member functions here.

	* paragraph.h:
	* paragraph.C:
	* lyxtext.h:
	* text.C: remove LyXText::beginningOfMainBody(), and call
	  p->beginningOfMainBody() directly. Move the check for
	  LABEL_MANUAL into the latter.

	* text.h:
	* text.C:
	* text2.C:
	* vspace.C:
	* BufferView.h:
	* BufferView.C: make defaultHeight() be a free defaultRowHeight()

	* text.h:
	* text.C:
	* text2.C:
	* text3.C:
	* frontends/screen.C: move bv_owner private, introduce isTopLevel()
	  to make it clear we're testing for outmost-lyxtext vs. inset's lyxtext

2003-02-13  John Levon  <levon@movementarian.org>

	* CutAndPaste.C: remove debug

2003-02-11  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* paragraph.C (asString): remove two unused variables

	* lyxtextclass.C (readTitleType):
	  (Read):
	  (LyXTextClass): handle new members titletype_ and titlename_

	* buffer.C (latexParagraphs): honor LyXTextClass::titletype

2003-02-09  John Levon  <levon@movementarian.org>

	* buffer.h:
	* buffer.C: replace hand-coded list with a map for the dep clean

2003-02-08  John Levon  <levon@movementarian.org>

	* LaTeX.C: consolidate code into showRunMessage() helper

2003-02-08  John Levon  <levon@movementarian.org>

	* lyxfind.C:
	* lyxtext.h:
	* text2.C:
	* BufferView.C: change setSelectionOverString() to setSelectionRange()
	  and pass the size in explicitly

	* BufferView_pimpl.h:
	* BufferView_pimpl.C:
	* BufferView.h:
	* BufferView.C: add getCurrentChange()

	* BufferView_pimpl.h:
	* BufferView_pimpl.C: handle change lfuns

	* CutAndPaste.C: merge the cut and copy code. Rework the cut code
	  for changes. Mark pasted paragraphs as new.

	* support/lyxtime.h:
	* support/lyxtime.C:
	* DepTable.C: abstract time_t as lyx::time_type

	* LColor.h:
	* LColor.C: add colours for new text, deleted text, changebars

	* LaTeXFeatures.C: add dvipost as a simple feature. Make the color
	  package use "usenames" option.

	* commandtags.h:
	* lyxfunc.C:
	* LyXAction.C: add change lfuns

	* Makefile.am:
	* author.h:
	* author.C: author handling

	* buffer.h:
	* buffer.C: add a per-buffer author list, with first entry as
	  current author. Handle new .lyx tokens for change tracking. Output
	  author list to .lyx file. Output dvipost stuff to .tex preamble.
	  Bump lyx format to 222.

	* bufferlist.h:
	* bufferlist.C: add setCurrentAuthor() to reset current author details
	  in all buffers.

	* bufferparams.h:
	* bufferparams.C: add param for tracking

	* bufferview_funcs.C: output change info in minibuffer

	* Makefile.am:
	* changes.h:
	* changes.C: add change-tracking structure

	* debug.h:
	* debug.C: add CHANGES debug flag

	* lyxfind.h:
	* lyxfind.C: add code for finding the next change piece

	* lyxrc.h:
	* lyxrc.C: add user_name and user_email

	* lyxrow.h:
	* lyxrow.C: add a metric for the top of the text line

	* lyxtext.h:
	* text.C: implement accept/rejectChange()

	* lyxtext.h:
	* text.C: paint changebars. Paint new/deleted text in the chosen
	colours. Strike through deleted text.

	* paragraph.h:
	* paragraph.C:
	* paragraph_pimpl.h:
	* paragraph_pimpl.C: output change markers in .lyx and .tex. Pass
	  in the current change to the insert functions. Rework erase to
	  mark text as deleted, adding an eraseIntern() and a range-based
	  erase(). Implement per-paragraph change lookup and
	  accept/reject.

	* paragraph_funcs.C: Fixup paste for change tracking.

	* tabular.C: mark added row/columns as new.

	* text.C: fix rowLast() to never return -1. Don't allow
	  spellchecking of deleted text. Track transpose changes. Don't
	  allow paragraph break or merge where appropriate.

	* text2.C: leave cursor at end of selection after a cut.

2003-02-07  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text.C (getLengthMarkerHeight):
	(drawLengthMarker): make the `symbolic' lengths (small/med/big)
	visible on screen too.

2003-02-07  John Levon  <levon@movementarian.org>

	* text.C: s/LYX_PAPER_MARGIN/PAPER_MARGIN/g

2003-02-05  Angus Leeming  <leeming@lyx.org>

	* lyxserver.C (read_ready): revert my patch of 11 September last year
	as it sends PC cpu through the roof. Presumably this means that
	the lyxserver will no longer run on an Alpha...

2003-01-30  Angus Leeming  <leeming@lyx.org>

	* factory.C (createInset): create an InsetCommandParam of type "index"
	and use it to 'do the right thing'.

	* text2.C (getStringToIndex): ensure that cursor position is always
	reset to the reset_cursor position.

2003-01-28  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfunc.C (getStatus): "buffer-export custom" should never be
	disabled.

2003-01-20  Michael Schmitt <michael.schmitt@teststep.org>

	* bufferview.C:
	* lyxcb.C:
	* lyxfunc.C: Output messages with identical spelling, punctuation,
	and spaces

2003-01-22  Michael Schmitt  <Michael.Schmitt@teststep.org>

	* MenuBackend.C (expandFormats): List only viewable export formats
	in "View" menu

	* buffer.C (parseSingleLyXformat2Token): Fix misleading error
	message

	* lyxfunc.C (getStatus): Make sure that formats other than
	"fax" can also be disabled

2003-01-16  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text3.C (dispatch): put the lfuns that insert insets in 3
	groups, and call doInsertInset with appropriate arguments.
	(doInsertInset): new function, that creates an inset and inserts
	it according to some boolean parameters.

2003-01-16  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* buffer.C (readFile): remember to pass on 'par' when calling
	readFile recursively.

2003-01-15  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* MenuBackend.C (expandFormats): add "..." to import formats.

2003-01-15  Dekel Tsur  <dekelts@tau.ac.il>

	* paragraph.C (asString): Remove XForms RTL hacks.

2003-01-13  Alfredo Braunstein <abraunst@libero.it>
	* buffer.C: fix typo

2003-01-12  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* Makefile.am (LIBS): delete var
	(lyx_LDADD): add @LIBS@ here instead.

2003-01-08  Michael Schmitt <Michael.Schmitt@teststep.org>

	* Clarify the meaning of "wheel mouse jump"

2003-01-06  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfunc.C (getStatus): fix disabling of cut/paste of cells in a
	tabular in a float

2003-01-08  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* importer.C (Loaders): do not preallocate 3 elements in the
	vector, since one ends up with 6 elements otherwise

2002-12-20  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* DepTable.C (write): write the file name as last element of the
	.dep file (because it may contain spaces)
	(read): read info in the right order

2003-01-07  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* paragraph_pimpl.C (simpleTeXBlanks):
	(simpleTeXSpecialChars):
	* paragraph.C (simpleTeXOnePar): make `column' unsigned.

	* tabular.C (latex): add some missing case statements. Reindent.

	* MenuBackend.C (expandToc): remove unused variable.

2003-01-06  Michael Schmitt <Michael.Schmitt@teststep.org>

	* LColor.C:
	* LaTeX.C:
	* LyXAction.C:
	* MenuBackend.C:
	* buffer.C:
	* exporter.C:
	* lyxfunc.C:
	* lyxrc.C: fix inconsistent usage of spaces, colons, capitalization,
	and the like.

2003-01-05  John Levon  <levon@movementarian.org>

	* BufferView.h:
	* BufferView.C: add getEncoding()

	* kbsequence.h:
	* kbsequence.C: do not store last keypress

	* lyxfunc.h:
	* lyxfunc.C: store last keypress here instead. Pass encoding
	  to getISOEncoded()

2002-12-27  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyx_main.C (init): remove annoying error message when following
	symbolic links (bug #780)

2002-12-26  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text.C (insertChar):
	* lyxrc.C (getDescription): remove extra spaces

2002-12-23  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxrc.C (getDescription): remove extra spaces

2002-12-20  John Levon  <levon@movementarian.org>

	* text3.C: hack fix for page up/down across tall rows

2002-12-17  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text2.C (pasteEnvironmentType): avoid crash if layout-copy has
	not been invoked

2002-12-17  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfunc.C (getStatus): query lyx_gui::getStatus() to catter for
	unimplemented lfuns. Make LFUN_THESAURUS_ENTRY status unknown if
	thesaurus is not compiled in

2002-12-17  Alfredo Braunstein <abraunst@libero.it>

	* lyxfunc.C: correct  inversion of WORDFINDBACK/FORWARD

2002-12-16  Angus Leeming  <leeming@lyx.org>

	* lyxrc.[Ch]:
	* lyx_main.C (init): remove override_x_deadkeys stuff.

2002-12-12  John Levon  <levon@movementarian.org>

	* lyxfunc.C: use LyXKeySym->isText() as last-ditch
	  insert. Only remove shift modifier under strict
	  circumstances.

2002-12-09  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* MenuBackend.C (expandToc): fix crash.

2002-12-08  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* MenuBackend.C (expandToc): gettext on float names.

2002-12-03  Juergen Spitzmueller  <j.spitzmueller@gmx.de>

	* lyxlength.[Ch]: set default unit to UNIT_NONE,
	implement bool empty() [bug 490]

2002-12-02  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C, CutAndPaste.C: use BoostFormat.h not boost/format.hpp

2002-12-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* several files: ws changes

2002-12-01  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* text2.C (setCounter): clean up a bit, use boost.format.
	(updateCounters): initialize par upon declaration.

	* CutAndPaste.C (SwitchLayoutsBetweenClasses): set the layout also
	if the layout exists. We do not just store the layout any more.
	(SwitchLayoutsBetweenClasses): use boost.format

2002-11-18  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* converter.C (convert): if from and to files are the same, use a
	temporary files as intermediary

2002-11-22  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* commandtags.h:
	* LyXAction.C (init): remove LFUN_VECTOR (bug 662)

2002-11-27  Dekel Tsur  <dekelts@tau.ac.il>

	* lyxrc.[Ch]: Add {roman,sans,typewriter}_font_foundry variables.

2002-11-27  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* tabular.C (asciiPrintCell): use string(size, char) instead of
	explicit loop.

	* sgml.C (openTag): fix order of arguments to string constructor
	(closeTag): ditto

	* lyxfunc.C (dispatch): use boost.format

	* lots of files: change "c" -> 'c'

2002-11-25  Dekel Tsur  <dekelts@tau.ac.il>

	* encoding.C: Patch from Isam Bayazidi: Fix Arabic shaping.

2002-11-25  Angus Leeming  <leeming@lyx.org>

	* BoostFormat.h: wrap code inside #ifdef __GNUG__ block.

	* lyx_main.C (init): compile fix.

2002-11-25  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyx_cb.C (start): boost.formatify
	do not include <iostream>

	* lengthcommon.C: ws only

	* boost-inst.C,BoostFormat.h: add more explict instantations

2002-11-24  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lots of files: handle USE_BOOST_FORMAT

2002-11-21  John Levon  <levon@movementarian.org>

	* pspell.C: fix compile

2002-11-21  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxfunc.C (dispatch): use boost::format
	(open): ditto
	(doImport): ditto

	* lyxfont.C (stateText): use boost::format

	* lyx_main.C (LyX): use boost::format
	(init): ditto
	(queryUserLyXDir): ditto
	(readRcFile): ditto
	(parse_dbg): ditto
	(typedef boost::function): use the recommened syntax.

	* importer.C (Import): use boost::format

	* debug.C (showLevel): use boost::format

	* converter.C (view): use boost::format
	(convert): ditto
	(move): ditto
	(scanLog): ditto

	* bufferview_funcs.C (currentState): use boost::format

	* bufferlist.C (emergencyWrite): use boost::format

	* buffer.C (readLyXformat2): use boost::format
	(parseSingleLyXformat2Token): ditto

	* Makefile.am (lyx_SOURCES): add BoostFormat.h and boost-inst.C

	* LaTeX.C (run): use boost::format

	* Chktex.C (scanLogFile): use boost::format

	* BufferView_pimpl.C (savePosition): use boost::format
	(restorePosition): ditto
	(MenuInsertLyXFile): ditto

	* BoostFormat.h: help file for explicit instation.

2002-11-21  Dekel Tsur  <dekelts@tau.ac.il>

	* tabular.C (latex): Support for block alignment in fixed width
	columns.

2002-11-17  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C:
	* lyx_cb.C:
	* lyxfunc.C: split filedialog into open/save

2002-11-08  Juergen Vigna  <jug@sad.it>

	* undo_funcs.C (textHandleUndo): fixed problems with undo introduced
	by my last patch (hopefully).

2002-11-08  John Levon  <levon@movementarian.org>

	* iterators.h:
	* iterators.C:
	* buffer.h:
	* buffer.C:
	* paragraph.h:
	* paragraph.C:
	* toc.h:
	* toc.C: ParConstIterator, and use it (from Lars)

2002-11-07  Ben Stanley  <bds02@uow.edu.au>

	* lyxtextclass.[Ch]: revise and add doxygen comments

2002-11-07  John Levon  <levon@movementarian.org>

	* text.C: fix progress value for spellchecker

	* toc.C: fix navigate menu for insetwrap inside minipage

	* paragraph_funcs.C: added FIXME for suspect code

2002-11-07  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C: fix redrawing of insets
	  on buffer switch

2002-11-05  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C (updateCounters): fix bug 668

2002-11-04  Dekel Tsur  <dekelts@tau.ac.il>

	* text3.C (dispatch): Do not make the buffer dirty when moving the
	cursor.

2002-11-04  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* vc-backend.C: STRCONV
	(scanMaster): ditto

	* text2.C (setCounter): STRCONV

	* paragraph.C (asString): STRCONV

	* lyxlength.C (asString): STRCONV
	(asLatexString): ditto

	* lyxgluelength.C (asString): STRCONV
	(asLatexString): ditto

	* lyxfunc.C (dispatch): STRCONV
	(open): ditto

	* lyxfont.C (stateText): STRCONV

	* importer.C (Import): STRCONV

	* counters.C (labelItem): STRCONV
	(numberLabel): ditto
	(numberLabel): remove unused ostringstream o

	* chset.C: STRCONV
	(loadFile): ditto

	* bufferview_funcs.C (currentState): STRCONV

	* buffer.C (readFile): STRCONV
	(asciiParagraph): ditto
	(makeLaTeXFile): ditto

	* Spacing.C (writeEnvirBegin): STRCONV

	* LaTeXFeatures.C (getLanguages): STRCONV
	(getPackages): ditto
	(getMacros): ditto
	(getBabelOptions): ditto
	(getTClassPreamble): ditto
	(getLyXSGMLEntities): ditto
	(getIncludedFiles): ditto

	* LaTeX.C: STRCONV
	(run): ditto
	(scanAuxFile): ditto
	(deplog): ditto

	* LString.h: add the STRCONV macros

	* BufferView_pimpl.C (savePosition): STRCONV
	(restorePosition): ditto
	(MenuInsertLyXFile): ditto

	* vc-backend.C (scanMaster): change from submatch[...] to
	submatch.str(...)

	* funcrequest.C: include config.h

	* factory.C: include config.h

	* chset.C (loadFile): change from submatch[...] to submatch.str(...)

	* box.C: include config.h

	* LaTeX.C (scanAuxFile): change from submatch[...] to
	submatch.str(...)
	(deplog): ditto

2002-10-25  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (cursorToggle): remove reapSpellchecker hack.

	* ispell.[Ch] (setError): new method.
	* ispell.C (c-tor): move out child process into new class LaunchIspell.
	Use setError() insetead of goto END.

	* lyx_cb.C (AutoSave): move out child process into new class
	AutoSaveBuffer.

2002-10-30  John Levon  <levon@movementarian.org>

	* text3.C: make start appendix undoable

2002-10-24  Dekel Tsur  <dekelts@tau.ac.il>

	* lyxlength.C (inPixels): Fix returned value.

	* paragraph.C (TeXOnePar): Fix bug with language changes in nested
	environment.

2002-10-24  Angus Leeming  <leeming@lyx.org>

	* lyxgluelength.h: no need to forward declare BufferParams
	or BufferView, so don't.

2002-10-21  John Levon  <levon@movementarian.org>

	* BufferView.C: menuUndo ->undo, redo

	* BufferView.h: document, remove dead, make some methods private

	* paragraph_funcs.h:
	* paragraph_funcs.C:
	* CutAndPaste.C: s/pasteParagraph/mergeParagraph

	* buffer.h:
	* buffer.C:
	* sgml.h:
	* sgml.C: move sgml open/close tag into sgml.C

	* bufferview_funcs.h: unused prototype

	* lyxfunc.h:
	* lyxfunc.C: remove unused

	* lyxtext.h:
	* text.C: remove unused

2002-10-21  John Levon  <levon@movementarian.org>

	* BufferView.h:
	* BufferView.C:
	* BufferView_pimpl.h:
	* BufferView_pimpl.C: fix mouse wheel handling based on
	  patch from Darren Freeman

2002-10-09  Dekel Tsur  <dekelts@tau.ac.il>

	* lyx_main.C (queryUserLyXDir): Fix automatic reconfiguration.

2002-10-17  Dekel Tsur  <dekelts@tau.ac.il>

	* lyxlength.C (inPixels): Fix hanfling of negative length.
	Fix LyXLength::MU case.

2002-10-16  John Levon  <levon@movementarian.org>

	* buffer.C: remove \\protected_separator parsing done by lyx2lyx now

2002-10-16  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* converter.C (view): add support for $$i (file name) and $$p
	(file path) for the viewer command. If $$i is not specified, then
	it is appended to the command (for compatibility with old syntax)

2002-10-14  Juergen Vigna  <jug@sad.it>

	* undo_funcs.C (textHandleUndo): alter the order in which the
	new undopar is added to the LyXText, as we have to set first
	the right prev/next and then add it as otherwise the rebuild of
	LyXText is not correct. Also reset the cursor to the right paragraph,
	with this IMO we could remove the hack in "redoParagraphs()".

2002-10-09  Angus Leeming  <leeming@lyx.org>

	* Bufferview_pimpl.C (dispatch): call InsetCitation::setLoadingBuffer
	to turn off an optimisation if a new inset is to be inserted.

2002-10-11 André Pönitz <poenitz@gmx.net>

	* lyxtext.h: make some functions public to allow access
	from inset/lyxtext for handling LFUN_PRIOR/NEXT

2002-10-09  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text3.C (dispatch): when changing layout, avoid an infinite loop
	[bug #652]

2002-10-07  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxrc.C (read): treat a viewer or converter command of "none" as
	if it were empty.

	* MenuBackend.C (expandFormats): for an update, also allow the
	formats that are not viewable

	* lyx_main.C (queryUserLyXDir): re-run automatically the configure
	script if it is newer than the lyxrc.defaults in user directory

2002-10-07 André Pönitz <poenitz@gmx.net>

	* text.C: Vitaly Lipatov's small i18n fix

2002-09-25  Angus Leeming  <leeming@lyx.org>

	* ispell.h: doxygen fix.

2002-09-25  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.h (readFile): Add a new argument to the method, to allow
	reading of old-format templates.

2002-09-24  Dekel Tsur  <dekelts@tau.ac.il>

	* toc.C (getTocList): Get TOC from InsetWrap.

2002-09-16  John Levon  <levon@movementarian.org>

	* lyxfunc.C: check tabular for cut/copy too

2002-09-12  John Levon  <levon@movementarian.org>

	* LyXAction.C: tidy

	* factory.h:
	* factory.C: add header

	* paragraph_funcs.h:
	* paragraph_funcs.C: cleanup

2002-09-11  John Levon  <levon@movementarian.org>

	* PrinterParams.h: odd/even default to true

2002-09-12  Rob Lahaye  <lahaye@snu.ac.kr>

	* PrinterParams.h: update printer parameters for new xforms dialog

2002-09-11  Angus Leeming  <leeming@lyx.org>

	* lyxserver.C (read_ready): re-write to make it more transparent
	and to make it work in coherent fashion under Tru64 Unix.

2002-09-11  André Pönitz <poenitz@gmx.net>

	* commandtags.h:
	* LyXAction.C:
	* text3.C: implement LFUN_WORDSEL

2002-09-11  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxtextclass.h: don't include FloatList.h, forward declare instead.
	make floatlist_ a boost::shared_ptr<FloatList>

	* lyxtextclass.C: include FloatList.h
	(LyXTextClass): initialize floatlist_
	(TextClassTags): add TC_NOFLOAT
	(Read): match "nofloat" to TC_NOFLOAT and use it.
	(readFloat): modify call to floatlist_
	(floats): ditto
	(floats): ditto

	* FloatList.[Ch] (FloatList): remove commented out float
	initialization.
	(erase): new function

2002-09-10  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* MenuBackend.C (expandToc): fix crash when there is no document
	open

2002-09-10  Dekel Tsur  <dekelts@tau.ac.il>

	* many files: Add insetwrap.

2002-09-09  John Levon  <levon@movementarian.org>

	* text2.C: remove confusing and awkward depth wraparound

2002-09-09  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C: Don't use empty arg for LFUN_CHILD_INSERT

	* buffer.h:
	* buffer.C: remove getIncludeonlyList()

	* paragraph.C:
	* lyxfunc.C: remove headers

2002-09-09  Juergen Vigna  <jug@sad.it>

	* text.C (getColumnNearX): fix form Michael this is most
	probably a cut&paste bug.

2002-09-06  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* remove all INHERIT_LANG and INHERIT_LANGUAGE commented code

	* LaTeXFeatures.C (useLayout): let tclass and lyt be a const
	references, ws changes.

	* text2.C (init): update counters after init
	(insertParagraph): no need to set counter on idividual paragraphs.
	(setCounter): access the counters object in the textclass object
	on in the buffer object.
	(updateCounters): ditto

	* lyxtextclass.C: include counters.h, add variable ctrs_ as
	shared_ptr<Counters> to avoid loading counters.h in all
	compilation units.
	(LyXTextClass): initialize ctrs_
	(TextClassTags): add TC_COUNTER, and ...
	(Read): use it here.
	(CounterTags): new tags
	(readCounter): new function
	(counters): new funtion
	(defaultLayoutName): return a const reference

	* counters.C (Counters): remove contructor
	(newCounter): remove a couple of unneeded statements.
	(newCounter): simplify a bit.
	(numberLabel): some small formatting changes.

	* buffer.[Ch]: remove all traces of counters, move the Counters
	object to the LyXTextClass.

2002-09-06  Alain Castera  <castera@in2p3.fr>

	* tabular.C: uses \tabularnewline; uses >{...} construct from array
	package to set the horizontal alignment on fixed width columns.

	* lyx_sty.C:
	* lyx_sty.h: added tabularnewline macro def.

	* LaTeXFeatures.C: added NeedTabularnewline macro feature

2002-09-06  John Levon  <levon@movementarian.org>

	* LyXAction.C: tooltips for sub/superscript

	* MenuBackend.C: a bit more verbose

	* lyxfunc.C: tiny clean

	* undo_funcs.C: document undo_frozen

2002-09-05  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* counters.C (Counters): add missing algorithm counter.

	* text2.C (setCounter): lookup the counter with layouts latexname
	instead of by section number.
	(setCounter): use a hackish way to lookup the correct enum
	counter.
	a float name->type change
	reset enum couners with counter name directly instead of depth value.

	* counters.C (Counters): remove the push_backs, change to use the
	float type not the float name.
	(labelItem): remove unused string, float name->type change

	* counters.h: don't include vector, loose the enums and sects vectors

2002-09-04  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* lyxtextclass.C (TextClassTags): add TC_FLOAT
	(Read): add float->TC_FLOAT to textclassTags
	(Read): and handle it in the switch
	(readFloat): new function

	* FloatList.C (FloatList): comment out the hardcoded float
	definitions.

	* lyxlayout.h: ws change.

2002-08-29  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (readFile): Look for lyx2lyx in LYXDIR/lyx2lyx/

2002-09-03  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.h: qualified name is not allowed in member
	declaration: WorkArea & Pimpl::workarea() const;

	* factory.C: added using std::endl directive.

	* text3.C: added using std::find and std::vector directives.

2002-08-29  André Pönitz <poenitz@gmx.net>

	* lyxtext.h:
	* text2.C: remove unused member number_of_rows

	* Makefile.am:
	* BufferView2.C: remove file, move contents to...
	* BufferView.C: ... here

	* BufferView_pimpl.C:
	* factory.C: move more inset creation to factory

	* vspace.C: avoid direct usage of LyXText, ws changes

	* BufferView.[Ch]:
		don't provide direct access to WorkArea, use two simple
		acessors haveSelction() and workHeight() instead


2002-08-29  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C (dispatch): do not continue when
	  no buffer

2002-08-28  André Pönitz <poenitz@gmx.net>

	* commandtags.h: new LFUN_MOUSE_DOUBLE, LFUN_MOUSE_TRIPLE

	* BufferView.h:
	* BufferView_pimpl.[Ch] move work area mouse event to LFUNs

2002-08-28  Rob Lahaye  <lahaye@snu.ac.kr>

	* buffer.C: increment LYX_FORMAT to 221

	* lyxrc.[Ch]: declare display_graphics as grfx::DisplayType and use
	grfx::displayTranslator.find(foo); include graphics/GraphicsTypes.h.

	* lyxrc.C: use more "if (...) { } else { }" style (John's advice).

	* lyx_main.C: call once the setDisplayTranslator(); is that okay here?

2002-08-27  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* factory.C (createInset): use LyXTextClass::floats

	* MenuBackend.C (expandFloatListInsert):
	(expandFloatInsert):
	(expandToc):

	* text2.C (setCounter):

	* LaTeXFeatures.C (useFloat):
	(getFloatDefinitions):

	* BufferView_pimpl.C (dispatch): use LyXTextClass::floats()

	* lyxtextclass.[Ch]: rename layoutlist to layoutlist_; add
	floatlist_, with accessor floats().

	* FloatList.h: remove global FloatList

2002-08-26  André Pönitz <poenitz@gmx.net>

	* paragraph.[Ch]: Martin's patch for the \end_deeper bug

	* BufferView.h:
	* BufferView2.C:
	* BufferView_pimpl.C:
	* text3.C: mun hanfling of LFUN_CUT/COPY/PASTE to LyXText

2002-08-25  John Levon  <levon@movementarian.org>

	* LyXAction.C: fix margin note description

2002-08-24  John Levon  <levon@movementarian.org>

	* buffer.C:
	* bufferlist.C:
	* bufferview_funcs.C:
	* lyxfont.C:
	* undo_funcs.C: cleanups

	* lyxfunc.C: disable CUT/COPY when no selection

2002-08-23  Rob Lahaye  <lahaye@snu.ac.kr>

	* lyxlength.[Ch]: use better (three letters) mnemonics for percentage units
	in "enum UNIT"; e.g. PTW for Percent of TextWidth

	* lyxrc.C: graphics display is now monochrome|grayscale|color|none.
	Add backward compatibility to "mono", "gray" and "no".

2002-08-24  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (readFile): Always run lyx2lyx if file_format < LYX_FORMAT
	(and file_format >= 200).

2002-08-23  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxlayout.C (Read): treat LT_OPTARGS as an integer, not a bool

2002-08-22  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (getStatus): handle LFUN_INSET_OPTARG

2002-08-20  Martin Vermeer  <martin.vermeer@hut.fi>

	* BufferView_pimpl.C:
	* LyXAction.C:
	* buffer.C:
	* commandtags.h:
	* lyxfunc.C:
	* paragraph.[Ch]:
	* text2.C:
	* insets/insetoptarg.[Ch]: Added "optional argument" collapsible
	inset and code to make it  work with the paragraph code. The inset
	can be anywhere in the paragraph, but will only do the expected
	thing in LaTeX if the layout file contains the parameter line
			OptionalArgs	1
	(or more generally, a nonzero value) for that layout.

2002-08-22  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph.h: remove the declaration of undefined counters class
	function.

2002-08-22  Martin Vermeer <martin.vermeer@hut.fi>

	* text2.C (setCounter):  fixed enumeration mis-count as reported by
	Dr. Richard Hawkins.

2002-08-21  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph_funcs.h: remove some unneeded includes

	* text.C (backspace): pasteParagraph now in global scipe

	* CutAndPaste.C (cutSelection): pasteParagraph now in global scope
	(pasteSelection): ditto

	* paragraph.[Ch] (pasteParagraph): move function to global scope ...
	* paragraph_funcs.C (pasteParagraph): ... here

2002-08-20  André Pönitz <poenitz@gmx.net>

	* commandtags.h: new LFUNs for swapping/copying table row/colums

	* LyXAction.C:
	* lyxfunc.C: support for new lfuns

2002-08-21  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* tabular.C:
	* buffer.[Ch]: remove NO_COMPABILITY stuff

2002-08-20  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* boost.C (throw_exception): new file, with helper function for
	boost compiled without exceptions.

	* paragraph.h:
	* lyxlength.C:
	* buffer.C:
	* ParameterStruct.h:
	* ParagraphParameters.[Ch]: remove NO_PEXTRA_REALLY stuff

	* bufferlist.C (emergencyWriteAll): use boost bind

	* BufferView_pimpl.C (moveCursorUpdate): remove inline

	* text.C: include paragraph_funcs.h
	(breakParagraph): breakParagraph is now in global scope

	* paragraph_funcs.[Ch]: new files

	* paragraph.C (breakParagraph,breakParagraphConservative): move to
	global scope

	* buffer.C: include paragraph_funcs.h
	(insertStringAsLines): breakParagraph is now in global scope

	* Makefile.am (lyx_SOURCES): add paragraph_funcs.h and
	paragraph_funcs.C

	* CutAndPaste.C: include paragraph_funcs.h
	(cutSelection): breakParagraphConservative is now in global scope
	(pasteSelection): ditto

	* buffer.h: declare oprator== and operator!= for
	Buffer::inset_iterator

	* bufferlist.C (emergencyWrite): don't use fmt(...)

	* text3.C: add using std::endl

	* BufferView.C (moveCursorUpdate): remove default arg

2002-08-20  André Pönitz <poenitz@gmx.net>

	* buffer.[Ch]: move inline functions to .C

	* BufferView2.C:
	* BufferView_pimpl.C:
	* text.C:
	* buffer.[Ch]: use improved inset_iterator

	* buffer.C:
	* paragraph.[Ch]: write one paragraph at a time

2002-08-20  Dekel Tsur  <dekelts@tau.ac.il>

	* BufferView_pimpl.C (dispatch): Insert insetbibtex with "plain"
	style if style is not specified.

2002-08-20  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* text2.C (setCounter): when searching for right label for a
	caption, make sure to recurse to parent insets (so that a caption
	in a minipage in a figure float works) (bug #568)

2002-08-20  André Pönitz <poenitz@gmx.net>

	* text3.C: new file for LyXText::dispatch() and helpers

	* BufferView.[Ch]: move text related stuff to LyXText::dispatch()

	* funcrequest.[Ch]: add message() do avoid direct access to LyXFunc

2002-08-19  André Pönitz <poenitz@gmx.net>

	* lyxtext.h:
	* text.C: new LyXText::dispatch()

	* BufferView_pimpl.C: move handling of LFUN_APPENDIX to LyXText

2002-08-18  Dekel Tsur  <dekelts@tau.ac.il>

	* text.C (paintRowSelection): Fix code for rows with both RTL & LTR text.

	* BufferView_pimpl.C (smartQuote): Insert typewriter quotes in
	Hebrew text.

2002-08-16  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* Makefile.am: use $(variables) instead of @substitutions@

2002-08-15  André Pönitz <poenitz@gmx.net>

	* lyxfunc.C:
	* BufferView_pimpl.C: streamlining mathed <-> outer world
	interaction

	* commandtags.h:
	* LyXAction.C: remove unused LFUN_MATH

2002-08-15  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph.[Ch]: add some NO_NEXT ifdefs.

2002-08-15  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph.C (Paragraph): reformat a bit
	(cutIntoMinibuffer): use builtin InsetList function instad of
	doing it manually.
	(getInset): ditto

	* buffer.C: include boost/bind.hpp, add using std::for_each
	(writeFileAscii): use ParagraphList iterators
	(validate): use for_each for validate traversal of paragraphs
	(getBibkeyList): use ParagraphList iterators
	(resizeInsets): use for_each to resizeInsetsLyXText for all
	paragraphs.
	(getParFromID): use ParagraphList iterators

	* BufferView2.C (lockInset): use paragraph list and iterators

2002-08-14  John Levon  <levon@movementarian.org>

	* lyxserver.C: remove spurious xforms include

2002-08-14  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (getStatus): disable math-extern outside of math mode

2002-08-13  André Pönitz <poenitz@gmx.net>

	* LyXAction.[Ch]:
	* lyxfunc.C: further cleaning

2002-08-13  André Pönitz <poenitz@gmx.net>

	* funcrequest.h: new constructor

	* funcrequest.C: move stuff here from .h

	* Makefile.am:
	* BufferView_pimpl.C:
	* LyXAction.C:
	* toc.C:
	* lyxfunc.C: subsequent changes

	* lyxfunc.h: new view() member function

	* lyxfunc.C: subsequent changes

2002-08-13  Angus Leeming  <leeming@lyx.org>

	* BufferView2.C:
	* BufferView_pimpl.C:
	* buffer.C:
	* converter.C:
	* importer.C:
	* lyxfunc.C:
	* lyxvc.C:
	* toc.C:
	* vc-backend.C:
	changes due to the changed LyXView interface that now returns references
	to member variables not pointers.

2002-08-13  Angus Leeming  <leeming@lyx.org>

	* WordLangTuple (word, lang_code): return references to strings,
	not strings.

	* BufferView.h:
	* SpellBase.h:
	* lyxtext.h: forward-declare WordLangTuple.

	* BufferView2.C:
	* ispell.C:
	* pspell.C:
	* text.C: #include "WordLangTuple.h".

	* lyxtext.h:
	* text.C: (selectNextWordToSpellcheck): constify return type.

2002-08-12  Martin Vermeer <martin.vermeer@hut.fi>

	* buffer.C:
	* buffer.h:
	* lyxtext.h:
	* paragraph.C:
	* paragraph_pimpl.h:
	* text.C:
	* text2.C:
	* undo_funcs.C: replaced per-paragraph counter logic by per-buffer, as
	suggested by Angus.
	Made updateCounter always count from start of buffer, and removed
	second argument (par).
	Reverted floats number display to '#'. Perhaps I'll try again when the
	code base is sanitized a bit.

2002-08-12  Angus Leeming  <leeming@lyx.org>

	* buffer.[Ch] (getLabelList): constify.

2002-08-07  André Pönitz <poenitz@gmx.net>

	* commandtags.h: new LFUN_MOUSE_(PRESS|MOTION|RELEASE)

	* funcrequest.h: extension to keep mouse (x,y) position

2002-08-12  Juergen Vigna  <jug@sad.it>

	* BufferView2.C (insertErrors): forbid undo when inserting error
	insets.

	* CutAndPaste.C (SwitchLayoutsBetweenClasses): ditto

2002-08-12  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* ParagraphList.[Ch]: new files

	* Makefile.am (lyx_SOURCES): add ParagraphList.[Ch]

	* BufferView2.C (lockInset): ParagraphList changes
	* toc.C: ditto
	* text2.C: ditto
	* bufferlist.C: ditto
	* buffer.h: ditto
	* buffer.C: ditto

2002-08-11  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph_pimpl.h: remove inclusion of boost/array.hpp, remove
	unused class variable counter_,

	* paragraph.[Ch] (getFirstCounter): delete unused function

	* counters.C: include LAssert.h
	(reset): add a new function with no arg, change other version to
	not have def. arg and to not allow empty arg.

	* text2.C (setCounter): remove empty arg from call to Counters::reset

2002-08-11  John Levon  <levon@movementarian.org>

	* Makefile.am: add WordLangTuple.h

2002-08-11  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph.C, ToolbarDefaults.h, kbsequence.h, lyx_main.C,
	lyxfunc.C lyxlex_pimpl.C: ws changes only.

	* insets/insettext.C: InsetList changes

	* graphics/GraphicsSupport.C (operator()): InsetList changes

	* toc.C (getTocList): InsetList changes

	* paragraph_pimpl.[Ch]: InsetList changes

	* paragraph.[Ch]: InsetList changes

	* buffer.C (inset_iterator): InsetList changes
	(setParagraph): ditto
	* buffer.h (inset_iterator): ditto
	* iterators.C (operator++): ditto
	* iterators.h: ditto

	* Makefile.am (lyx_SOURCES): add InsetList.C and InsetList.h

	* InsetList.[Ch]: new files, most InsetList handling moved out of
	paragraph.C.

	* BufferView2.C (removeAutoInsets): InsetList changes
	(lockInset): ditto
	(ChangeInsets): ditto

2002-08-10  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* paragraph_pimpl.h (empty): new function

	* paragraph.[Ch] (empty): new function

	* other files: use the new Paragraph::empty function

2002-08-09  John Levon  <levon@movementarian.org>

	* lyxtext.h: remove unused refresh_height

2002-08-09  John Levon  <levon@movementarian.org>

	* Makefile.am:
	* sgml.h:
	* sgml.C:
	* buffer.C:
	* paragraph.h:
	* paragraph.C: move sgml char escaping out of paragraph

	* paragraph.h:
	* paragraph.C: remove id setter

	* buffer.C:
	* paragraph.C:
	* paragraph_pimpl.C: remove dead tex_code_break_column

	* bufferview_funcs.C: small cleanup

	* lyxfunc.C: remove dead proto

	* lyxtext.h: make some stuff private. Remove some dead stuff.

	* lyxgluelength.C: make as[LyX]String() readable

2002-08-08  John Levon  <levon@movementarian.org>

	* LyXAction.h:
	* LyXAction.C:
	* MenuBackend.C:
	* ToolbarDefaults.C:
	* lyxfunc.C:
	* lyxrc.C:
	* toc.C: lyxaction cleanup

2002-08-08  John Levon  <levon@movementarian.org>

	* BufferView2.C: small cleanup

	* lyxfind.h:
	* lyxfind.C: move unnecessary header into the .C

2002-08-08  John Levon  <levon@movementarian.org>

	* funcrequest.h: just tedious nonsense

	* lyx_main.h:
	* lyx_main.C: cleanups

	* buffer.C:
	* vspace.C: remove dead header lyx_main.h

2002-08-07  Angus Leeming  <leeming@lyx.org>

	* Paragraph.[Ch]:
	* paragraph_pimpl.h:
	Forward declare class Counters in paragraph.h by moving the ctrs member
	variable into Paragraph::Pimpl.
	(counters): new method, returning a reference to pimpl_->ctrs.

	* text2.C: ensuing changes.

2002-08-07  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C (resizeCurrentBuffer): update scrollbar

	* BufferView_pimpl.C: announce X selection on double/triple
	  click

	* lyx_main.C: use correct bool in batch dispatch

	* counters.h: srcdocs (from Martin Vermeer and Angus Leeming)

2002-08-07  André Pönitz <poenitz@gmx.net>

	* funcrequest.h: new class to wrap a kb_action and its argument

	* BufferView.[Ch]:
	* BufferView_pimpl[Ch]:
	* LaTeX.C:
	* LyXAction.[Ch]:
	* lyxfunc.[Ch]:
	* lyxrc.C: subsequent changes


2002-08-07  John Levon  <levon@movementarian.org>

	* BufferView_pimpl.C (redoCurrentBuffer): fix screen update when
	  document options change.

2002-08-06  Martin Vermeer  <martin.vermeer@hut.fi>

	* counters.[Ch]
	* text2.C
	* paragraph.[Ch]
	* makefile.am: move counters functionality over from
	text2.C/paragraph.[Ch] to counters.[Ch], and make proper C++.

2002-08-06  John Levon  <levon@movementarian.org>

	* WordLangTuple.h: new file for word + language code tuple

	* SpellBase.h:
	* pspell.h:
	* pspell.C:
	* ispell.h:
	* ispell.C:
	* lyxtext.h:
	* text.C:
	* text2.C:
	* BufferView.h:
	* BufferView2.C: use WordLangTuple

	* layout.h:
	* buffer.C: remove very dead LYX_LAYOUT_DEFAULT

2002-08-06  John Levon  <levon@movementarian.org>

	* lyx_main.C: fix cmdline batch handling

2002-08-06  André Pönitz <poenitz@gmx.net>

	* lyxrc.C: set default for show_banner to true

2002-08-06  John Levon  <levon@movementarian.org>

	* pspell.C: fix a crash, and allow new aspell to work

2002-08-06  John Levon  <levon@movementarian.org>

	* lyxfunc.C:
	* kbmap.C: small cleanup

	* vspace.h:
	* vspace.C: add const

2002-08-05  John Levon  <levon@movementarian.org>

	* LyXAction.C: back to tabular-insert

2002-08-04  John Levon  <levon@movementarian.org>

	* BufferView.h:
	* BufferView.C: cosmetic change

	* BufferView_pimpl.C: s/IGNORE_CODE/NOTE_CODE/

	* bufferlist.C:
	* buffer.h:
	* buffer.C:
	* lyxcb.h:
	* lyxcb.C:
	* lyxserver.C:
	* lyxvc.C:
	* vc-backend.C:
	* BufferView2.C: purge all "Lyx" not "LyX" strings

	* lyxcursor.h:
	* lyxcursor.C: attempt to add some documentation

	* lyxfunc.C:
	* commandtags.h:
	* LyXAction.C:
	* ToolbarDefaults.C:
	* BufferView_pimpl.C: remove LFUN_DIALOG_TABULAR_INSERT and
	  merge with LFUN_TABULAR_INSERT

	* Makefile.am:
	* SpellBase.h:
	* ispell.h:
	* ispell.C:
	* pspell.h:
	* pspell.C: split up i/pspell implementations into separate
	  files, many cleanups

	* lyxlex.C: unrevert, with a proper fix for prefix.length() == 0

	* text2.C: some cleanup

	* lyxfunc.C: don't check for isp_command == "none" any more, it
	  didn't make any sense

2002-08-06	Martin Vermeer <martin.vermeer@hut.fi>

	* counters.[Ch]
	* text2.C
	* paragraph.[Ch]
	* makefile.am: move counters functionality over
	from text2.C/paragraph.[Ch] to counters.[Ch], and
	make proper C++.
2002-08-02  John Levon  <levon@movementarian.org>

	* buffer.C: s/lyxconvert/lyx2lyx/

2002-08-02  Angus Leeming  <leeming@lyx.org>

	* lyxlex.C: revert John's change as it breaks reading of the user
	preamble.

2002-08-02  Angus Leeming  <leeming@lyx.org>

	* importer.C (Import):
	* lyxfunc.C (moveCursorUpdate, dispatch, view_status_message):
	changes due to LyXView::view() now returning a boost::shared_ptr.

2002-08-02  John Levon  <levon@movementarian.org>

	* lyxlex.C: small cleanup

2002-08-02  John Levon  <levon@movementarian.org>

	* text2.C (status): small cleanup, no logic change

2002-08-01  John Levon  <levon@movementarian.org>

	* buffer.h:
	* buffer.C (writeFile): don't output alerts, caller
	  handles this

	* bufferlist.C:
	* lyx_cb.C: from above

	* lyxfunc.C: allow to open non-existent files

2002-07-31  John Levon  <levon@movementarian.org>

	* lyxserver.C: don't let incidental errors get
	  in the way (errno)

2002-07-30  John Levon  <levon@movementarian.org>

	* lyxfunc.C: disable character dialog in ERT inset (partial fix)

2002-07-30  John Levon  <levon@movementarian.org>

	* lyxserver.h:
	* lyxserver.C: remove I/O callback too

2002-07-30  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (getStatus): disable LFUN_LATEX_LOG when there is no
	log.

2002-07-29  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* many files: strip,frontStrip -> trim,ltrim,rtrim

2002-07-28  Lars Gullik Bjønnes  <larsbj@gullik.net>

	* PrinterParams.h: remove extern containsOnly, and include
	support/lstrings.h instead.

	* LaTeX.C (scanAuxFile): modify because of strip changes
	(deplog): ditto
	* buffer.C (makeLaTeXFile): ditto
	* bufferparams.C (writeFile): ditt
	* lyxfont.C (stateText): ditto
	* lyxserver.C (read_ready): ditto
	* vc-backend.C (scanMaster): ditto

	* BufferView_pimpl.h: ws changes

	* BufferView_pimpl.C: inlude boost/signals/connection.hpp

2002-07-26  André Pönitz <poenitz@gmx.net>

	* kb_sequence.C: remove unnedred usings

2002-07-26  Juergen Vigna  <jug@sad.it>

	* lyxfind.C (LyXReplace): we have to check better if the returned
	text is not of theLockingInset()->getLockingInset().

2002-07-25  Juergen Vigna  <jug@sad.it>

	* lyxfind.C (LyXReplace): don't replace if we don't get the
	right LyXText.

	* undo_funcs.C (createUndo): remove debugging code.

2002-07-25  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (parseSingleLyXformat2Token): Use default placement
	when reading old floats.

	* FloatList.C (FloatList): Change the default placement of figure
	and tables to "tbp".

2002-07-25  John Levon  <moz@compsoc.man.ac.uk>

	* MenuBackend.C: using std::max

2002-07-25  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* MenuBackend.C (expandToc):
	(expandToc2): code moved from xforms menu frontend. It is now
	generic and TOCs are transparent to menu frontends.

2002-07-24  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* toc.C (getTocList): protect against buf=0

	* MenuBackend.C (expand): move from Menu to MenuBackend; pass a
	Menu as first parameter. Now, this calls itself recursively to
	expand a whole tree (this will be useful for TOC handling)
	(expandFloatInsert): remove 'wide' version of floats

	* MenuBackend.h (submenuname): returns the name of the submenu.
	(submenu): returns the submenu itself, provided it has been
	created by MenuBackend::expand

2002-07-23  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* paragraph_pimpl.C (simpleTeXSpecialChars): close fonts before
	insets which have noFontChange == true. (bug #172)

2002-07-22  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* BufferView_pimpl.C: add connection objects and use them...
	(Pimpl): here.

2002-07-22  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* MenuBackend.C (expandLastfiles):
	(expandDocuments):
	(expandFormats):
	(expandFloatListInsert):
	(expandFloatInsert):
	(expand): split expand in parts

2002-07-22  John Levon  <moz@compsoc.man.ac.uk>

	* lyx_gui.C: use lyx_gui::exit()

2002-07-22  John Levon  <moz@compsoc.man.ac.uk>

	* LyXAction.C: show the failing pseudo action

2002-07-22  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (readFile): Run the lyxconvert script in order to read
	old files.

2002-07-22  John Levon  <moz@compsoc.man.ac.uk>

	* LyXAction.C:
	* commandtags.h:
	* lyxfunc.C: remove LFUN_ADD_TO_TOOLBAR

2002-07-22  John Levon  <moz@compsoc.man.ac.uk>

	* LyXAction.C:
	* commandtags.h:
	* lyxfunc.C: remove LFUN_TOOLBAR_PUSH

2002-07-22  Herbert Voss  <voss@lyx.org>

	* lengthcommon.C:
	* lyxlength.[Ch]: add support for the vertical lengths

2002-07-21  John Levon  <moz@compsoc.man.ac.uk>

	* toc.[Ch]: std:: fixes

2002-07-21  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxrc.C: do not include lyx_main.h

	* LaTeXFeatures.h: use a list<string> instead of a vector<string>
	for layouts

	* lyxrc.C:
	* encoding.C:
	* bufferlist.C:
	* BufferView2.C: include "lyxlex.h"

	* tabular.h:
	* bufferparams.h: do not #include "lyxlex.h"

	* lyxtextclasslist.C (Add): remove method
	(classlist): renamed to classlist_

	* paragraph_pimpl.C:
	* paragraph.C:
	* text2.C:
	* CutAndPaste.C:
	* bufferview_funcs.C:
	* bufferlist.C:
	* text.C:
	* LaTeXFeatures.C:
	* buffer.C:
	* toc.C (getTocList): use BufferParams::getLyXTextClass

	* toc.C (getTocList): use InsetFloat::addToToc

	* toc.[Ch]: new files, containing helper functions to handle table
	of contents

	* lyxfunc.C (dispatch): no need to remove spaces around command
	given as a string
	(getStatus): handle LFUN_SEQUENCE by returning the status of the
	first command of the sequence; it is not very clever, but I do not
	have a better idea, actually

	* LyXAction.C (LookupFunc): make sure to remove space at the
	beginning and end of the command

2002-07-20  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* MenuBackend.C (getMenubar): new method: return the menubar of
	this menu set
	(read): treat differently reading of menu and menubar (in
	particular, the menubar has no name now)
	(Menu::menubar): remove

	* lyxfunc.C (dispatch): add 'done' message to minibuffer when
	saving is finished

2002-07-20  Dekel Tsur  <dekelts@tau.ac.il>

	* BufferView_pimpl.C (workAreaButtonRelease): Fix opening of
	a bibitem inset in a RTL paragraph.

2002-07-20  John Levon  <moz@compsoc.man.ac.uk>

	* paragraph_pimpl.C: constify

	* BufferView_pimpl.C:
	* LaTeX.C:
	* lyxfunc.C: fix dispatch in a nicer way

2002-07-20  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (dispatch):
	* BufferView_pimpl.C:
	* BufferView_pimpl.h:
	* BufferView.C:
	* BufferView.h: rename Dispatch() to dispatch()

	* LaTeXFeatures.C (useLayout): honor LyXLayout::depends_on()

	* lyxlayout.C (Read): honor DependsOn tag

	* lyxlayout.[Ch] (depends_on): new method

	* version.C.in: update lyx_docversion

	* LaTeXFeatures.C (getMacros): only define \LyX when needed

	* paragraph.C (validate): remove from here...
	* paragraph_pimpl.C (validate): ... and move here
	(isTextAt): make it const

	* buffer.C (getLists): ws cleanup

2002-07-20  Dekel Tsur  <dekelts@tau.ac.il>

	* language.C (read): Use iso8859-1 encoding in latex_lang
	(this prevents LyX from crashing when using iso10646-1 encoding).

2002-07-19  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* text2.C (toggleInset): if cursor is inside an inset, close the
	inset and leave cursor _after_ it

2002-07-19  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.C: move minibuffer completion handling out of here

2002-07-19  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C:
	* LaTeX.C: fix dispatch calls

2002-07-19  Dekel Tsur  <dekelts@tau.ac.il>

	* text.C (drawChars): Fix Arabic text rendering.

2002-07-18  John Levon  <moz@compsoc.man.ac.uk>

	* LyXAction.C:
	* commandtags.h:
	* lyxfunc.C: remove message-push/pop

	* lyxserver.C:
	* lyxfunc.h:
	* lyxfunc.C: rationalise some code by removing verboseDispatch
	  in favour of a bool argument to dispatch()

2002-07-17  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyx_main.C (init): make sure to read symlinks as absolute paths

2002-07-17  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.h:
	* lyxfunc.C: no need for commandshortcut to be a member

2002-07-15  André Pönitz <poenitz@gmx.net>

	* converter.C: add support for $$s (scripts from lib/scripts dir)
	* lyx_main.C: white space

2002-07-17  John Levon  <moz@compsoc.man.ac.uk>

	* bufferlist.C:
	* lyxrc.h:
	* lyxrc.C: remove second exit confirmation

2002-07-17  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView.h:
	* BufferView.C:
	* BufferView2.C:
	* BufferView_pimpl.h:
	* BufferView_pimpl.C:
	* lyxfunc.C: s/setState/switchKeyMap/, s/showState/view_state_changed/

2002-07-16  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* MenuBackend.C (expand): add numeric shortcuts to document menu

	* lyxrc.C (getDescription): remove RC_NEW_ASK_FILENAME

2002-07-15  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfont.C (setLyXFamily):
	(setLyXSeries):
	(setLyXShape):
	(setLyXSize):
	(setLyXMisc):
	(lyxRead):
	* debug.C (value):
	* buffer.C (asciiParagraph): use ascii_lowercase

2002-07-15  Mike Fabian  <mfabian@suse.de>

	* lyxlex_pimpl.C (search_kw):
	* lyxlex.C (getLongString):
	* converter.h (operator<):
	* converter.C (operator<):
	* buffer.C (parseSingleLyXformat2Token):
	(asciiParagraph):
	* ToolbarDefaults.C (read):
	* MenuBackend.C (checkShortcuts):
	(read):
	* LColor.C (getFromGUIName):
	(getFromLyXName): use the compare_ascii_no_case instead of
	compare_no_case, because in turkish, 'i' is not the lowercase
	version of 'I', and thus turkish locale breaks parsing of tags.

2002-07-16  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (buffer): Previews::generateBufferPreviews
	now takes a Buffer const & argument.

2002-07-15  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView.C (resize): check there's a buffer to resize

2002-07-14  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.C: remove dead code

	* lyxserver.h:
	* lyxserver.C: use lyx_guii::set_read_callback

2002-07-13  Dekel Tsur  <dekelts@tau.ac.il>

	* lyxfunc.C (dispatch): Correct cursor behaviour when exiting
	an inset in a RTL paragraph.

2002-07-12  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.C: repaint after a font size update

2002-07-15  André Pönitz <poenitz@gmx.net>

	* lyxlength.C: inBP should be able to return negative values

2002-07-12  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.C: use lyx_gui::update_fonts()

2002-07-12  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.C: use lyx_gui::update_color()

2002-07-11  John Levon  <moz@compsoc.man.ac.uk>

	* bufferlist.C:
	* lyxfunc.h:
	* lyxfunc.C:
	* lyxrc.h:
	* lyxrc.C: remove file->new asks for name option, and let
	  buffer-new take an argument

2002-07-11  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: remove unneeded extra repaint()

2002-07-10  John Levon  <moz@compsoc.man.ac.uk>

	* LyXAction.C: allow command-sequence with NoBuffer

	* lyxfunc.C: don't insist on trailing ';' for command-sequence

2002-07-10  Angus Leeming  <leeming@lyx.org>

	* lyxrc.[Ch]: preview_scale_factor should be a float not an int.

2002-07-09  Angus Leeming  <leeming@lyx.org>

	* lyxrc.[Ch]: added preview_hashed_labels and preview_scale_factor.

2002-07-09  John Levon  <moz@compsoc.man.ac.uk>

	* lengthcommon.h: whitespace

	* lyxfunc.C: update scrollbar after goto paragraph

	* lyxtext.h: factor out page break drawing, and fix it so
	  page break/added space paints as selected nicely

2002-07-09  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: add FIXMEs, clean up a little

2002-07-09  André Pönitz <poenitz@gmx.net>

	* lyxfont.[Ch]: support for wasy symbols

2002-07-08  André Pönitz <poenitz@gmx.net>

	* BufferView_pimpl.C: apply John's patch for #93.

2002-07-05  Angus Leeming  <leeming@lyx.org>

	* BufferView_pimpl.C (buffer): generate previews if desired.

	* LColor.h: add "preview" to the color enum.

	* LColor.C (LColor): add a corresponding entry to the items array.

	* buffer.C (~Buffer): remove any previewed LaTeX snippets associated
	with this buffer.

2002-07-05  Angus Leeming  <leeming@lyx.org>

	* buffer.[Ch] (makeLaTeXFile): create two methods where there was one.
	The body of the code is now in the method that is passed an ostream &
	rather than a file name.
	Pass an additional only_preamble parameter, useful for the forthcoming
	preview stuff.

2002-07-03  André Pönitz <poenitz@gmx.net>

	* lyxfunc.C: simplify getStatus() a bit for math stuff

2002-07-02  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* BufferView_pimpl.C (workAreaResize): add an unconditional repaint.

2002-06-20  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* text.C (changeRegionCase): do not change case of all the
	document when region ends at paragraph end (bug #461)

2002-07-01  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* paragraph.C (startTeXParParams):
	(endTeXParParams): add \protect	when necessary

2002-06-19  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* BufferView_pimpl.C (workAreaExpose): remove warning

2002-06-27  Angus Leeming  <leeming@lyx.org>

	* Makefile.am: add lyxlayout_ptr_fwd.h.

2002-06-26  André Pönitz <poenitz@gmx.net>

	* lyxrc.[Ch]: introduce \preview, revive half-dead \show_banner

2002-06-25  Angus Leeming  <leeming@lyx.org>

	* lyxfunc.C (dispatch): Comment out the call to
	grfx::GCache::changeDisplay. The method no longer exists now that the
	pixmap generation part of the graphics loader has been moved into
	InsetGraphics.

2002-06-24  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C: layout as layout

	* text.C: layout as layout

	* tabular.C (OldFormatRead): layout as layout

	* paragraph_pimpl.C (TeXDeeper): layout as layout
	(realizeFont): layout as layout

	* paragraph.C (writeFile): layout as layout
	(validate): layout as layout
	(getFont): layout as layout
	(getLabelFont): layout as layout
	(getLayoutFont): layout as layout
	(breakParagraph): layout as layout
	(stripLeadingSpaces): layout as layout
	(getEndLabel): layout as layout
	(getMaxDepthAfter): layout as layout
	(applyLayout): layout as layout
	(TeXOnePar): layout as layout
	(simpleTeXOnePar): layout as layout
	(TeXEnvironment): layout as layout
	(layout): layout as layout
	(layout): layout as layout

	* lyxtextclass.C (compare_name): new functor to work with
	shared_ptr, layout as layout
	(Read): layout as layout
	(hasLayout): layout as layout
	(operator): layout as layout
	(delete_layout): layout as layout
	(defaultLayout): layout as layout

	* lyxlayout_ptr_fwd.h: new file

	* lyxlayout.C (Read): layout as layout

	* lyx_cb.C (MenuInsertLabel): layout as layout

	* bufferlist.C (newFile): layout as layout

	* buffer.C (readLyXformat2): layout as layout
	(parseSingleLyXformat2Token): layout as layout
	(insertStringAsLines): layout as layout
	(asciiParagraph): layout as layout
	(latexParagraphs): layout as layout
	(makeLinuxDocFile): layout as layout
	(simpleLinuxDocOnePar): layout as layout
	(makeDocBookFile): layout as layout
	(simpleDocBookOnePar): layout as layout
	(getLists): layout as layout

	* LaTeXFeatures.C (getTClassPreamble): layout as layout

	* CutAndPaste.C (cutSelection): layout as layout
	(pasteSelection): layout as layout
	(SwitchLayoutsBetweenClasses): layout as layout

	* BufferView_pimpl.C (Dispatch): layout as layout
	(smartQuote): layout as layout

	* BufferView2.C (unlockInset): layout as layout

2002-06-24  André Pönitz <poenitz@gmx.net>

	* lyxfunc.C: fix #487

2002-06-21  John Levon  <moz@compsoc.man.ac.uk>

	* lyxrc.h:
	* lyxrc.C:
	* lyxfunc.C: remove display_shortcuts, show_banner

2002-06-21  John Levon  <moz@compsoc.man.ac.uk>

	* Buffer_pimpl.C: oops, update on resize

2002-06-21  John Levon  <moz@compsoc.man.ac.uk>

	* buffer.C:
	* converter.C:
	* exporter.C:
	* lyxfunc.C:
	* BufferView.h:
	* BufferView.C: use repaint()

	* BufferView_pimpl.h:
	* BufferView_pimpl.C: s/updateScreen()/repaint()/
	  as it's a clearer description. Remove superfluous
	  redraws.

2002-06-21  John Levon  <moz@compsoc.man.ac.uk>

	* text.C: fix bug 488. Not ideal, but getting
	  getWord() to work properly for the insets that
	  matter is more difficult ...

2002-06-20  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C:
	* LyXAction.C:
	* commandtags.h:
	* lyxfunc.C: remove the six million index lyxfuncs to just
	  one, and DTRT (bug 458)

2002-06-20  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView.h:
	* BufferView.C:
	* BufferView_pimpl.h:
	* BufferView_pimpl.C: clean up resize() stuff,
	  and unnecessary updateScreen()s

2002-06-20  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView.h:
	* BufferView.C:
	* BufferView_pimpl.h:
	* BufferView_pimpl.C:
	* lyxfind.h:
	* lyxfind.C:
	* minibuffer.C: remove focus management of workarea,
	  not needed. Use screen's greyOut()

2002-06-17  Herbert Voss  <voss@lyx.org>

	* converter.C: (convert) do not post a message, when converting
	fails, let the calling function decide what to do in this case

2002-06-18  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.C: tidy up a little

2002-06-16    <alstrup@diku.dk>

	* BufferView_pimpl.C (Pimpl): Use WorkAreaFactory.
	Got rid of FORMS_H_LOCATION include. Now we are
	GUII.

2002-06-15  LyX Development team  <lyx@rilke>

	* buffer.[Ch] (sgmlOpenTag):
	(sgmlCloseTag): Added support for avoiding pernicious mixed
	content. Return number of lines written.

	(makeLinuxDocFile):
	(makeDocBookFile): Fixed calls to sgml*Tag.
	Simple white space clean.

	(simpleDocBookOnePar): Simple white space clean.

	* tabular.[Ch] (docBook): Renamed to docbook and got another
	argument to related with the pernicious mixed content.

	(docbookRow): Fixed calls for docbook inset method.

2002-06-15  Lyx Development team  <larsbj@birdstep.com>

	* lyxfunc.[Ch]: Use LyXKeySym instead of KeySym,
	so it's X11 independent.

	* kb*.[Ch]: ditto.

	* BufferView_pimpl.[Ch] (workAreaKeyPress): ditto.

2002-06-15  Lyx Development team  <lyx@electronia>

	* intl.h: Renamed getTrans to getTransManager.

2002-06-14  Angus Leeming  <leeming@lyx.org>

	* Makefile.am: nuke forgotten stl_string_fwd.h.

2002-06-12  Angus Leeming  <leeming@lyx.org>

	* stl_string_fwd.h: unused and non-compliant anyway. Nuked.

2002-06-13  Angus Leeming  <leeming@lyx.org>

	* LaTeX.C:
	* vspace.C: wrap using std::sscanf inside a CXX_GLOBAL_CSTD block.

2002-06-12  Andrew Zabolotny  <zap@cobra.ru>

	* kbmap.C (getiso): add support for cyrillic and greek

2002-06-12  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView.h:
	* BufferView.C:
	* BufferView_pimpl.h:
	* BufferView_pimpl.C: move bogus scrolling logic
	  to xforms

2002-06-12  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.C:
	* BufferView_pimpl.C: view->resize() change

2002-06-12  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: topCursorVisible
	  prototype change

2002-06-12  John Levon  <moz@compsoc.man.ac.uk>

	* Makefile.am:
	* lyx_gui.h:
	* lyx_gui.C: move to frontends/

	* main.C:
	* lyx_main.h:
	* lyx_main.C: changes from above

2002-06-12  John Levon  <moz@compsoc.man.ac.uk>

	* intl.C:
	* intl.h:
	* kbmap.C:
	* kbsequence.C:
	* lyx_cb.C:
	* lyx_main.C: minor tidy

2002-06-12  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.h:
	* BufferView_pimpl.C:
	* BufferView.h:
	* BufferView.C: make painter() const,
	  remove dead code

	* BufferView2.C: use screen() accessor

	* lyx_main.h:
	* lyx_main.C: some minor cleanup

2002-06-12  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.h:
	* BufferView_pimpl.C: remove enter/leaveView,
	  use workHeight()

2002-06-12  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView.h:
	* BufferView.C:
	* BufferView2.C:
	* BufferView_pimpl.h:
	* BufferView_pimpl.C: only construct screen once,
	  rename

	* lyxrc.C: remove pointless comment

2002-06-11  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView.h:
	* BufferView.C: remove active() and belowMouse()

	* BufferView_pimpl.h:
	* BufferView_pimpl.C: use workarea() not workarea_,
	  and make it use a scoped_ptr instead

2002-06-11  John Levon  <moz@compsoc.man.ac.uk>

	* lyx_gui.C: add debug message on BadWindow

2002-06-10  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* sp_spell.C: fdopen is not part of the C++ standard.

	* paragraph.C (InsetIterator): use >= instead of ==

2002-06-07  Angus Leeming  <leeming@lyx.org>

	Fixes needed to compile with Compaq cxx 6.5.
	* BufferView_pimpl.C:
	* DepTable.C:
	* buffer.C:
	* converter.C:
	* encoding.C:
	* lyx_gui.C:
	* lyx_main.C:
	* lyxtextclasslist.C:
	* minibuffer.C:
	* sp_spell.C:
	* tabular_funcs.C:
	* vc-backend.C:
	all c-library variables have been moved into namespace std. Wrap
	using std::xyz declarations inside a #ifndef CXX_GLOBAL_CSTD block.

	* lyxlength.C:
	* tabular-old.C:
	* tabular.C:
	Add a using std::abs declaration.

	* kbmap.h (modifier_pair):
	* paragraph.h (InsetTable, InsetList):
	* lyxfont.h (FontBits):
	type definition made public.

	* bufferlist.C (emergencyWriteAll): the compiler complains that
	there is more than one possible lyx::class_fun template to choose from.
	I re-named the void specialisation as lyx::void_class_fun.

	* lyxfont.C (FontBits' operator==, operator!=): taken out of class.

	* tabular_funcs.C: lstrings.h must come before tabular_funcs.h or
	the compiler is is unable to find tostr in write_attribute.

2002-06-06  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* buffer.C (sgmlError): hide #warning

2002-06-05  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* xtl/*: get rid of xtl, which is not in use anyway

	* LyXAction.C (init):
	* commandtags.h: remove BUFFER_PRINT and BUFFER_PARAMS_GET, which
	were unimplemented xtl experimentation

2002-06-04  André Pönitz <poenitz@gmx.net>

	* lyxfunc.C: disable array operation on simple formulae

2002-06-03  John Levon  <moz@compsoc.man.ac.uk>

	* converter.C: constify a bit

2002-06-02  John Levon  <moz@compsoc.man.ac.uk>

	* lyx_gui.C: check xforms version correctly

2002-04-30  Herbert Voss  <voss@lyx.org>

	* buffer.C (parseSingleLyXformat2Token): fix bug with ignored
	"keep" option

2002-05-31  John Levon  <moz@compsoc.man.ac.uk>

	* lyxvc.C: fix bug 416 (make sure buffer is saved before
	  attempt to register it with a VCS)

2002-05-30  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyx_main.C (init): honor variables LYX_DIR_13x and
	LYX_USERDIR_13x

2002-05-30  John Levon  <moz@compsoc.man.ac.uk>

	* buffer.h:
	* buffer.C:
	* lyx_main.C: fix a crash on bad command line,
	  and give a useful exit status on error

	* lyxfunc.C (doImport): allow -i lyx to work

2002-03-30  André Pönitz <poenitz@gmx.net>

	* lyxfunc.C: mathed font changes

2002-05-30  John Levon  <moz@compsoc.man.ac.uk>

	* LaTeX.C:
	* importer.h:
	* importer.C:
	* lyx_sty.h:
	* lyx_sty.C:
	* lyxlex.C:
	* lyxrow.h:
	* lyxtext.h:
	* paragraph.h:
	* paragraph.C:
	* texrow.h:
	* texrow.C:
	* text.C:
	* trans_mgr.h: srcdocs, and some minor cleanups

2002-05-29  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* paragraph_pimpl.C (isTextAt): rewrite to be much faster (do not
	call getFont all the time)

2002-05-29  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* switch from SigC signals to boost::signals

2002-05-29  André Pönitz <poenitz@gmx.net>

	* paragraph_pimpl.C (getChar): don't call size() too often...

2002-05-29  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* paragraph_pimpl.C (insertChar): do not try to update tables when
	appending (pos == size())

	* buffer.C (parseSingleLyXformat2Token): reorder a bit the tests
	in order to reduce drastically the number of comparisons needed to
	parse a large document

2002-05-29  André Pönitz <poenitz@gmx.net>

	* text.C:
	* text2.C:
	* lyxtextclass.C:
	* sp_pspell.h:
	* textclasslist.[Ch]:
	* sp_ispell.h: whitespace change

2002-05-29  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxserver.C (callback): tentative fix of lyxserver. Does not use
	lyxaction directly now.

2002-05-27  John Levon  <moz@compsoc.man.ac.uk>

	* trans.C:
	* lyxfont.C:
	* lyxvc.C: remove unused headers

2002-05-26  John Levon  <moz@compsoc.man.ac.uk>

	* Makefile.am:
	* buffer.h:
	* undostack.h:
	* undostack.C:
	* undo_funcs.h:
	* undo_funcs.C: some cleanups. Use shared_ptr
	  and a template for the undo stacks.

2002-05-26  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.h:
	* BufferView_pimpl.C:
	* kbmap.h:
	* kbmap.C:
	* kbsequence.h:
	* kbsequence.C:
	* lyxfunc.h:
	* lyxfunc.C:
	* text2.C: use key_state/mouse_state

2002-05-25  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* vc-backend.C (scanMaster): use boost regex and get rid of LRegex
	and LSubstring

	* chset.C: change include order
	(loadFile): use boost regex and get rid of LRegex and LSubstring

	* Makefile.am (BOOST_LIBS): new variable
	(lyx_LDADD): use it

	* LaTeX.C: change include order.
	(scanAuxFile): use boost regex and get rid of LRegex and
	LSubstring
	(deplog): ditto

2002-05-24  John Levon  <moz@compsoc.man.ac.uk>

	* ColorHandler.h:
	* ColorHandler.C:
	* FontInfo.h:
	* FontInfo.C: moved to frontends/xforms/

	* FontLoader.h:
	* FontLoader.C: moved into frontends for GUIIzation

	* Makefile.am:
	* lyx_gui.C:
	* lyxfont.C:
	* lyxfunc.C: changes from above

2002-05-24  John Levon  <moz@compsoc.man.ac.uk>

	* LColor.C: remove spurious X include

	* BufferView_pimpl.C:
	* Makefile.am:
	* font.h:
	* font.C:
	* text.C:
	* text2.C: move font metrics to frontends/

2002-05-24  Juergen Vigna  <jug@sad.it>

	* undo_funcs.C (textHandleUndo): fix the cursor selection after
	setting the undo_cursor.

	* ParagraphParameters.h: include local includes first.

2002-05-23  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C:
	* BufferView_pimpl.h:
	* Makefile.am:
	* WorkArea.h:
	* WorkArea.C:
	* screen.C: move WorkArea into frontends/

	* lyxscreen.h:
	* screen.C:
	* text.C:
	* BufferView.C:
	* BufferView2.C: move LyXScreen into frontends/

	* lyxlookup.h:
	* lyxlookup.C:
	* lyx_gui.C: move lyxlookup into frontends/xforms/

2002-05-23  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView2.C:
	* BufferView_pimpl.C:
	* FontLoader.C:
	* LyXView.h:
	* LyXView.C:
	* Makefile.am:
	* WorkArea.C:
	* XFormsView.h:
	* XFormsView.C:
	* buffer.C:
	* bufferlist.C:
	* bufferview_funcs.C:
	* converter.C:
	* importer.C:
	* lyx_cb.C:
	* lyx_gui.C:
	* lyx_main.C:
	* lyx_find.C:
	* lyxfunc.C:
	* lyxvc.C:
	* minibuffer.C:
	* text.C:
	* text2.C:
	* trans.C:
	* vc-backend.C: move LyX/XFormsView into frontends/

2002-05-23  John Levon  <moz@compsoc.man.ac.uk>

	* Makefile.am:
	* PainterBase.C:
	* PainterBase.h:
	* Painter.C:
	* Painter.h:
	* WorkArea.C:
	* WorkArea.h:
	* screen.C:
	* tabular.C:
	* text.C:
	* text2.C: move Painter to frontends/

2002-05-22  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C: comment out some some code that depend upon lyx_format
	< 220

	* paragraph.h (NO_PEXTRA_REALLY): turn off all pextra
	* ParagraphParameters.h (NO_PEXTRA_REALLY): ditto

	* buffer.h (NO_COMPABILITY): turn off compability

	* ColorHandler.C: include scoped_array.hpp

	* font.C: Use more specific smart_ptr header.
	* Painter.C: ditto
	* gettext.C: ditto
	* ShareContainer.h: ditto
	* lyx_main.h: ditto
	* kbmap.h: ditto
	* FontInfo.h: ditto
	* BufferView_pimpl.h: ditto
	* ColorHandler.h: ditto

	* kbmap.C (defkey): change call to shared_ptr::reset

2002-05-21  Juergen Vigna  <jug@sad.it>

	* buffer.C (insertErtContents): fix to insert ert asis if it is
	non empty. Skip it completely if it contains only whitespaces.

2002-05-15  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C:
	* BufferView2.C: clear selection on paste (bug 393)

2002-05-14  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* DepTable.C: include ctime

2002-05-11  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (latexParagraphs): Add new argument (moving_arg).

2002-05-14  Juergen Vigna  <jug@sad.it>

	* text.C (breakParagraph): fixed function to honor the keepempty
	layout in the right maner and also to permit the right breaking
	algorithm on empty or non empyt keepempty paragraphs.

	* paragraph.C (breakParagraph): we have to check also if the par
	is really empty (!size()) for isempty otherwise we do the wrong
	paragraph break.

2002-05-10  Juergen Vigna  <jug@sad.it>

	* buffer.[Ch] : The following are only changes to the ert
	compatibility read reading old LaTeX layout and font stuff and
	convert it to ERTInsets.

	* buffer.h: added isErtInset().

	* buffer.C (struct ErtComp): add a fromlayout bool to check
	if we're inside a LaTeX layout.
	(isErtInset): new helper function.
	(insertErtContents): look for other ert insets before this one
	and insert the contents there, so that we don't have subsequent
	ERT insets with nothing between them. This way we create only one
	inset with multiple paragraphs. Also check if we don't insert only
	spaces ' ' as they are ignored anyway afterwards in the .tex file
	so if we have only spaces we will ignore this latex part in the
	new file.
	(parseSingleLyXformat2Token \\layout): better compatibility when
	reading layout-latex stuff.
	(parseSingleLyXformat2Token \\lang): put the insetERT in the right
	language tag.
	(parseSingleLyXformat2Token \\begin_inset): don't reset ert_comp
	stuff after reading the inset only get the information back from
	the stack.

2002-05-10  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (makeLaTeXFile): Put language options after loading babel.

	* LaTeXFeatures.C (getBabelOptions): New method.

2002-05-08  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* BufferView_pimpl.C (Dispatch): work around missing argument for
	'layout'

2002-05-08  Juergen Vigna  <jug@sad.it>

	* text.C (leftMargin): handle paragraph leftindent.

	* paragraph.C (writeFile): write the new \\leftindent tag.
	(validate): handle leftindent code.
	(TeXEnvironment): handle paragraphleftindent code again.

	* lyx_sty.h: changed ParagraphIndent to ParagraphLeftIndent.

	* buffer.C (parseSingleLyXformat2Token): added compatibility code
	for paragrap_extra indent code and new token \\leftindent.
	(latexParagraphs): handle the leftindent as environment.

	* ParameterStruct.h: added leftindent support.

	* ParagraphParameters.C (leftIndent): added support functions for
	the paragraph left indent.

	* LaTeXFeatures.C: change paragraphindent to paragraphleftindent seems
	more appropriate.

2002-05-05  Dekel Tsur  <dekelts@tau.ac.il>

	* paragraph.C (isRightToLeftPar): Return false for a paragraph
	inside insetERT.

	* text.C (computeBidiTables): No bidi in insetERT.

	* BufferView_pimpl.C (setState): Fix keymap handling inside insetERT
	in RTL documents.

2002-05-03  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* version.C.in: pre 5

2002-05-02  José Matos  <jamatos@fep.up.pt>
	* buffer.C (makeDocBookFile): white space changes, add newline to
	command styles.
	(simpleDocBookOnePar): protect <emphasis> inside a CDATA section.

	* tabular.C (docBook): fix typo.

2002-05-03  Juergen Vigna  <jug@sad.it>

	* screen.C (drawFromTo): recalculate the rowpointer if we had a
	change in LyXText as we can not be sure it was not freed.
	(drawOneRow): remove unused code.

	* text.C (drawInset): redo the calculation of the need_break_row as
	it could have a row which was already freed.
	(draw): look at the return value of drawInset and return false if
	it also returned false.
	(paintRowText): look at the return value of draw and return false if
	it also returned false.

	* lyxtext.h: added bool return type to drawInset() and draw() so that
	if we have a change in the row so that the rowbreak has to be redone
	we abort drawing as it will be called again.

2002-05-02  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (moveCursorUpdate): make repaint if we had
	a change in the maintext also if we're inside an inset.
	(Dispatch): set the cursor again after a break line and after the
	screen has been updated as it could be we're in a different row.

	* text2.C (fixCursorAfterDelete): check to make sure we don't request
	to set the cursor behind the pargraph with > size().
	(setCursor): check also for the same paragraph when checking where
	to put the cursor if we have a NFR inset.

	* buffer.C (parseSingleLyXformat2Token): move the compatibility
	parts of layout read further up as it still was in the wrong
	position.

2002-05-02  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* screen.C (drawFromTo): change sine fullRebreak always return
	true.

	* buffer.C (parseSingleLyXformat2Token): reindent some

	* BufferView_pimpl.C (update): change since fullRebreak always
	return true.
	(Dispatch): git rid of the last hardcoded "Standard"s.

2002-05-01  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.[Ch] (fullRebreak): make it return void now that we always
	returned true.

2002-04-30  Juergen Vigna  <jug@sad.it>

	* buffer.C (parseSingleLyXformat2Token): reset the font before the
	ert compatibility check for "latex" layout.

2002-04-29  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (parseSingleLyXformat2Token): Fix reading of old format
	minipages: use col% instead of p%, and also use the current font.
	(makeLaTeXFile): Fix use babel condition.
	(parseSingleLyXformat2Token): Correct font when reading old floats.

2002-04-28  Dekel Tsur  <dekelts@tau.ac.il>

	* BufferView_pimpl.C (Dispatch): Check that float type exists when
	inserting list of floats.

2002-04-25  Herbert Voss  <voss@lyx.org>

	* MenuBackend.C (expand): don't add the graphics extensions to the
	export menu

2002-04-24  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* CutAndPaste.C (SwitchLayoutsBetweenClasses): when converting a
	non-existing layout, do not complain if it was the default layout
	of the original class (bug #342)

2002-04-24  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (workAreaButtonPress): fix handling of mouse-wheel
	(workAreaButtonRelease): don't do anything if it was a mouse-wheel

2002-04-22  Angus Leeming  <a.leeming@ic.ac.uk>

	* buffer.C (getBibkeyList): If using \bibliography, return the
	option field with the reference itself. Enables us to provide natbib
	support when using \bibliography.

2002-04-23  Mike Ressler  <mike.ressler@alum.mit.edu>

	* lyxtextclass.[Ch]: add layout keyword ProvidesNatbib.

	* LaTeXFeatures.C: do not add \usepackage{natbib} to tex file if
	natbib is provided by the LaTeX class.

2002-04-23  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.[Ch]: remove use of wrong and unneeded insetSleep/
	Wakeup functions.

	* BufferView.[Ch]: remove not needed insetSleep/Wakeup functions.

2002-04-22  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (getStatus): LFUN_PROTECTED_SPACE is allowed in maths

	* paragraph_pimpl.C (simpleTeXSpecialChars): remove bogus
	ensuremath around textordmasculine, textordfeminine and
	textdegree.

2002-04-19  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (resizeCurrentBuffer): resize the insets before
	reinitializing the buffer otherwise row-dimensions may be wrong.
	(update): reset also the selection cursors if they do exits otherwise
	their x/y positions may be wrong.

	* text2.C (cursorDown): don't enter the inset if we came from a row
	above and are one row over the inset.

	* lyxfunc.C (dispatch): update paragraph layout after LFUN_ESCAPE when
	really leaving an inset.

2002-04-18  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (Dispatch): fixed to change layout also if one
	of the selected paragraph does not have the selected layout also if
	the last one had!

	* text2.C (setLayout): fixed bug which did not change last selected
	paragraph.

	* tabular.C (OldFormatRead): check also for \\end_inset as Lars
	changed the read and substituted \\end_float with \\end_inset!

	* BufferView_pimpl.C (cursorPrevious):
	(cursorNext): fixed to make it work with rows heigher than the work
	area without moving the cursor only the draw of the row.
	(workAreaMotionNotify): fix jumping over high rows.

2002-04-17  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxtextclass.C (Read): fix bit adding, bug discovered by Mike
	Ressler.

2002-04-16  Juergen Vigna  <jug@sad.it>

	* text2.C (setCursor): set also the irow().
	(setCursorFromCoordinates): fixed to set the (i) cursor values right!
	(cursorUp):
	(cursorDown): support for locking an inset if the x_fix value goes
	inside it. That way I can transverse insets too with cursor up/down.

	* lyxrow.h: added irow helper function same as other (i) functions.

	* BufferView_pimpl.C (cursorPrevious):
	(cursorNext): fixed for insets!

2002-04-15  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (insetDimensions): use ix/iy values for inset
	position otherwise it is wrong in some cases.

	* lyxfunc.C (dispatch): fix FINISHED UP/DOWN to handle x position
	inside the inset before the call.

2002-04-16  Angus Leeming  <a.leeming@ic.ac.uk>

	* buffer.[Ch] (getBibkeyList): make it const.

2002-04-12  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (workAreaMotionNotify): use new ix() cursor pos.

	* text2.C (getCursorX): new helper function
	(setCursor): compute also ix_
	(setCursorFromCoordinates): set also ix.

	* lyxcursor.h: added ix_ and helper functions.

	* BufferView_pimpl.C (workAreaMotionNotify): forgot to use iy().

	* buffer.C (insertStringAsLines): dont break paragraph if the this
	paragraph is inside an inset which does not permit it!

	* text.C (breakParagraph): honor keepempty flag and break the paragraph
	also with no chars on this paragraph.
	(paintRowText): only paint stuff if it's inside the workarea!

	* paragraph.C (breakParagraph): honor keepempty flag and break the
	paragraph always below not above.

	* BufferView2.C (unlockInset): update the paragraph layout on inset
	unlock as we changed paragraph in such a case.

	* lyxfind.C (LyXFind): clear the former selection if not found!

	* text2.C (insertInset): freeze Undo after setUndo so that it is not
	again called in insertChar().

	* text.C (leftMargin): return LYX_PAPER_MARGIN if this row contains
	an inset which uses the whole row!
	(rightMargin): ditto.
	(insertChar): force a rebreak if we inserted an inset!

2002-03-28  Herbert Voss  <voss@lyx.org>

	* lyxlength.[Ch]: add inBP() to get the right PS-point
	units (BigPoint). With inPixels we have rounding errors

2002-04-11  Juergen Vigna  <jug@sad.it>

	* text2.C (setCursorFromCoordinates): set iy to the right value.
	(setCursor): add check if row->previous exists!

	* buffer.C (parseSingleLyXformat2Token): reset font after read of
	an old float_type as this was the case in the old code!

	* paragraph.C (simpleTeXOnePar): fix closing of foreignlanguage tags.

	* BufferView2.C (showLockedInsetCursor): use iy
	(fitLockedInsetCursor): ditto

	* BufferView_pimpl.C (checkInset): use LyXCursor::iy for baseline of
	locked insets as there we have the right value now.

	* lyxcursor.C: added iy_ variable and iy functions to set to the
	baseline of cursor-y of the locked inset.

	* text2.C (setCursorFromCoordinates): set LyXCursor::iy.
	(setCursor): fixed for insets which need a full row.

	* text.C (rowLastPrintable): don't ignore the last space when before
	an inset which needs a full row.
	(numberOfSeparators): use rowLastPrintable and <= last to honor a space
	as last character of a row when before a inset which needs a full row.

2002-04-06  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* version.C.in: update date

	* text2.C (fullRebreak): try to always return true and see what
	happens...

2002-04-04  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* MenuBackend.C (expand): use Floating::listName

	* FloatList.C (FloatList): add listName argument to the built-in
	floats

	* Floating.[Ch]: add listName member, which is the 'List of XXX'
	text associated with the float.

2002-04-03  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* MenuBackend.C (expand): change label "Wide xxx" to "xxx (wide)".

2002-04-03  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* ShareContainer.h: add a couple of missing typenames.

2002-04-02  Angus Leeming  <a.leeming@ic.ac.uk>

	* lyxrc.C (getDescription): use _() correctly rather than N_().

2002-03-28  Herbert Voss  <voss@lyx.org>

	* lyxlength.C: compatibility stuff for < 1.1.6fix4 and
	"old" 1.2.0 files which use c%, l%, p% t% instead of text%, ...

2002-04-02  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyx_main.C (init): use environment variable LYX_DIR_12x instead
	of LYX_DIR_11x. Same for LYX_USERDIR_12x.

2002-03-29  Juergen Vigna  <jug@sad.it>

	* lyxfunc.C (dispatch): add a missing fitCursor call.

	* BufferView2.C (fitLockedInsetCursor): the inset needs to know if
	it was scrolled by a cursor move, so return the bool status.

	* BufferView.C (fitCursor): return the bool flag also to the outside
	world as this is needed.

	* screen.C (toggleToggle): don't subtract the offset if it's positive.

	* BufferView_pimpl.C (workAreaButtonPress): just lock the inset don't
	call the edit() as it is not needed (and wrong) IMO.
	(workAreaButtonPress): set the screen_first variable before evt.
	unlock the inset as this may change screen_first and then we have
	a wrong y position for the click!

2002-03-28  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* MenuBackend.C (expand): another translation that I missed

2002-03-28  Juergen Vigna  <jug@sad.it>

	* screen.C (toggleToggle): fix for insettexts y_offset on drawing.

	* tabular.C (OldFormatRead): fix ert compatibility read inside cells.

2002-03-27  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (getStatus): return 'disabled' early for LFUN_NOACTION

	* MenuBackend.C (expand): fix export/view/update when there is no
	document open.

2002-03-27  Herbert Voss  <voss@lyx.org>

	* lengthcommon.C: change c%, l%, p% t% to col%, line%, page%
	and text%

2002-03-27  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* bufferview_funcs.C (currentState): only show paragraph number
	for is DEVEL_VERSION is set.

	* lyxfunc.C (dispatch): put warning in INFO channel

	* MenuBackend.C (expand): translate the name of floats

	* FloatList.C (FloatList): mark the float names for translation

	* converter.C (convert): use LibScriptSearch

2002-03-26  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* MenuBackend.C (defaults): fix default menu (we might as well get
	rid of it...)

2002-03-26  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxvc.C (registrer): register the file with CVS if it's in a CVS
	directory.

2002-03-25  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxvc.C: reorder includes.

2002-03-25  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C (updateScrollbar): update on buffer switch
	  properly

2002-03-19  John Levon  <moz@compsoc.man.ac.uk>

	* CutAndPaste.C: change layouts earlier on paste
	  to avoid crashing when calling getFont()

2002-03-22  Angus Leeming  <a.leeming@ic.ac.uk>

	* PrinterParams.h: #include "lyxrc.h" and remove that bloody
	irritating #error.

2002-03-21  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* WorkArea.C: remove 'Pending' debug message.

	* most files: ws cleanup

	* buffer.[Ch]: ws changes

	* Makefile.am (LYX_CONV_LIBS): remove ld -r stuff.

2002-03-21  Juergen Vigna  <jug@sad.it>

	* tabular.C (SetMultiColumn): collapse also the contents of the
	cells and set the last border right. Added a Buffer const * param.

2002-03-20  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* Makefile.am (LYX_CONV_LIBS): select libs depending on partial
	linking or not.

2002-03-19  Juergen Vigna  <jug@sad.it>

	* text2.C (clearSelection): reset also xsel_cache.

	* BufferView_pimpl.C (Dispatch): call WorkArea::haveSelection(false)
	where it needs to be called (John tells us to do so too :)
	(selectionLost): reset sel_cache.

	* WorkArea.C (event_cb): leave ret to 0 (John tells us to do so :)

2002-03-19  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* text2.C (setCursorIntern): put debuging code in INSETS channel

2002-03-19  André Pönitz <poenitz@gmx.net>

	* lyxfunc.C: tiny whitespace change

2002-03-19  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* ToolbarDefaults.C (init):
	* LyXAction.C (init):
	* commandtags.h:
	* BufferView_pimpl.C (Dispatch):
	* lyxfunc.C (dispatch): remove LFUN_DEPTH

2002-03-19  Allan Rae  <rae@lyx.org>

	* exporter.C (Export): removeAutoInsets before doing anything else.
	While I've just introduced a dependency on BufferView this really is
	the best place to clean the buffer otherwise you need to cleanup in
	a dozen places before calling export or cleanup in a dozen functions
	that export calls.

	* converter.C (runLaTeX):
	(scanLog): Better handling of removeAutoInsets and screen updates.

	* lyxfunc.C (dispatch): small whitespace changes

2002-03-18  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* WorkArea.C (C_WorkAreaEvent): return a value.
	(event_cb): return 1 if we handled the event, 0 otherwise.

	* lyx_gui.C (LyX_XErrHandler): don't abort on BadWindow

2002-03-18  Juergen Vigna  <jug@sad.it>

	* tabular.C (LeftAlreadyDrawed): fixed for multicolumn borders.
	(GetAdditionalWidth): ditto.
	(RightLine): ditto.
	(LeftLine): ditto.

	* BufferView2.C (copy): use getLyXText() so that we do it inside an
	inset if we're there actually (probably not used right now but this
	is the direction to go for unifying code).
	(paste): disable code to clear the selection.

	* BufferView_pimpl.C (workAreaButtonPress): check also for a selection
	inside an InsetText and move the check further up as it is in the
	wrong place.

	* text2.C (pasteSelection): set a selection over the pasted text.

2002-03-14  Kayvan A. Sylvan  <kayvan@sylvan.com>

	* Makefile.am (lyx_DEPENDENCIES): Swap the order of libfrontend
	and libgraphics to build on Cygwin.

2002-03-15  Juergen Vigna  <jug@sad.it>

	* CutAndPaste.C (SwitchLayoutsBetweenClasses): fix the wrong use of
	inserting an Inset into the paragraph. I know this is not the best
	fix but we already use current_view in CutAndPaste so we will remove
	all of it's using at the same time.

	* buffer.C (sgmlError): deactivated function till it is rewritten in
	the right mode, now it can create problems.

	* paragraph.C (isLineSeparator): check if getInset returns != 0,
	before accessing it.

2002-03-14  Juergen Vigna  <jug@sad.it>

	* undo_funcs.C (textHandleUndo): do the right thing when updating
	the inset after the undo/redo.

	* text2.C (setCursor): just some testcode for #44 not ready yet.

	* undo_funcs.C (textHandleUndo): set the next() and previous()
	pointers of the paragraph to 0 before deleting otherwise we have
	problems with the Paragraph::[destructor].

	* text.C (breakParagraph): IMO we should ALWAYS force a real undo
	on a paragraph insertion.

2002-03-14  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C (asciiParagraph): use += operator for char append to
	string.

	* paragraph.C (getFontSettings): compare >= not just >
	(highestFontInRange): ditto
	(setFont): ditto

2002-03-13  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.C: change several algorithm to be more appripriate for
	the problem domain. This is lookip in FontList and in the InsetList.

2002-03-13  André Pönitz <poenitz@gmx.net>

	* commandtags.h:
	* LyXAction.C: remove unused LFUN_MATH_MACROARG

2002-03-06  John Levon  <moz@compsoc.man.ac.uk>

	* commandtags.h:
	* LyXAction.C:
	* lyxfunc.C:
	* BufferView_pimpl.C: remove unused LFUN_CORE, LFUN_TEXT_INSET

2002-03-13  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* Painter.C (display): anon helper function, adjust code for this
	change.
	(pixmap): remove function.

	* Painter.h: remove private display variable.

	* PainterBase.[Ch]: remove dummy[123] cruft, ws changes

2002-03-13  Angus Leeming  <a.leeming@ic.ac.uk>

	* WorkArea.[Ch]: remove figinset_canvas cruft.

2002-03-12  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxtextclass.C (operator): add one item cache optimization.

	* bufferlist.h: doxy changes

	* bufferlist.C: ws changes

	* DepTable.[Ch] (ext_exist): place const in the right spot.

	* BufferView_pimpl.C (resizeCurrentBuffer): further refine when to
	call resizeInsets.
	(workAreaExpose): call resizeInsets when the with BufferView changes.
	(Dispatch): adjust for protectedBlank removal
	(specialChar): call updateInset if the insert went ok.

	* BufferView_pimpl.[Ch] (protectedBlank): remove func, use
	specialChar instead.

	* BufferView2.C (ChangeInsets): remove warning add FIXME comment

	* BufferView.h: doxy change

	* Makefile.am (INCLUDES): remove @FRONTEND_INCLUDES@

	* lyxtextclass.C (operator[]): remove non-const version
	(defaultLayout): remove non-const version

2002-03-12  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (resizeCurrentBuffer): only resize insets if we
	did resize the LyXText too.

	* buffer.C (readLyXformat2): set layout information on newly allocated
	paragraphs.

	* tabular.C (OldFormatRead): set layout information on the paragraph.

2002-03-12  Josï¿½Abï¿½io Oliveira Matos  <jamatos@novalis.fc.up.pt>

	* buffer.C (simpleDocBookOnePar): fix empty definition case for now.

2002-03-11  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (cursorPrevious): remove old cruft which is
	plainly wrong.
	(resizeCurrentBuffer): force also the insets to resize themselfes.
	(moveCursorUpdate): fixed up for InsetText.

2002-03-08  Angus Leeming  <a.leeming@ic.ac.uk>

	* commandtags.h:
	* LyXAction.C: add LFUN_TOOLTIPS_TOGGLE, "toggle-tooltips"
	* lyxfunc.C (getStatus(LFUN_TOOLTIPS_TOGGLE)): set flag based on
	value of Dialogs::tooltipsEnabled().
	(dispatch(LFUN_TOOLTIPS_TOGGLE)): emit signal Dialogs::toggleTooltips.

2002-03-08  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (updateInset): update inset inside inset also
	if it isn't inside theLockingInset().

2002-03-07  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C (asciiParagraph): redo some of the word and line length
	handling.
	(getLists): look for Caption instead of caption.

2002-03-07  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* buffer.C (Buffer): initialize niceFile to true
	(makeLaTeXFile):
	(makeLinuxDocFile):
	(makeDocBookFile): make sure niceFile is true on exit

2002-03-06  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* buffer.C (makeLaTeXFile): escape ~ in \input@path

2002-03-07  Angus Leeming  <a.leeming@ic.ac.uk>

	* LyXSendto.C: remove.
	* LyXView.C (c-tor): clean-up Jürgen's #if 0 correctly.
	* lyx_gui.C: remove now-redundant comment.
	* ColorHandler.h: remove forward declaration of class WorkArea.
	* lyxfunc.C: remove #include "WorkArea.h".

2002-03-07  Juergen Vigna  <jug@sad.it>

	* undo_funcs.C (textHandleUndo): fix problems when the paragraph
	got moved away with the DEPM and also set the inset_owner always
	right which before could have been omitted.

2002-03-07  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C (parseSingleLyXformat2Token): use default layout is the
	wanted layout is not found.

2002-03-07  Juergen Vigna  <jug@sad.it>

	* CutAndPaste.C (cutSelection): another layout settings forgotten.

2002-03-07  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.C (breakParagraph): use default layout not layout of
	prev paragraph.
	(Paragraph): clear ParagraphParameters.

2002-03-06  Juergen Vigna  <jug@sad.it>

	* buffer.C (parseSingleLyXformat2Token): changed "%" to "p%" as
	otherwise it would not be a valid lenght. Fixed a special case in
	the minipage compatibility read where we end the document with a
	minipage.

	* text2.C (deleteEmptyParagraphMechanism): check if old_cursor.par()
	was set as it could be 0 for InsetTexts first entry.

2002-03-06  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.C (writeFile): if layout is empty write out
	defaultLayoutName().

	* buffer.C (parseSingleLyXformat2Token): if we have a buggy .lyx
	file without named layout we set layout to defaultLayoutName().

2002-03-06  Juergen Vigna  <jug@sad.it>

	* CutAndPaste.C (copySelection): set layout for new paragraph.

	* text.C (prepareToPrint): leave ERT inset left aligned
	(leftMargin): don't indent paragraphs inside ERT insets

2002-03-06  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.C (breakParagraph): dont call clear do the work manually

	* paragraph.[Ch] (clear): remove function

2002-03-05  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.C (Paragraph): dont call clear, the work has already
	been done.

	* lyxtextclass.C (operator): assert if n is empty

	* CutAndPaste.C (cutSelection): dont call Paragraph::clear, do the
	work manually instead.

2002-03-01  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: protect selectionLost against text == 0

2002-03-05  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text.C (breakParagraph): fix a setting layout to '0' problem.

2002-03-05  Josï¿½Abï¿½io Oliveira Matos  <jamatos@novalis.fc.up.pt>

	* buffer.C (makeLinuxDocFile, makeDocBookFile): take into account the
	final location of file, for the included files, and graphics.

2002-03-05  Juergen Vigna  <jug@sad.it>

	* CutAndPaste.C (pasteSelection): fix the depth level on paste.

2002-03-04  Juergen Vigna  <jug@sad.it>

	* lyx_cb.C (getContentsOfAsciiFile): new helper function.

	* tabular.C (calculate_width_of_column_NMC): fixed to use also the
	last column of multicolumn cells.
	(SetWidthOfMulticolCell): recalculate NMC and real columns.

2002-03-04  Jose Abilio Oliveira Matos  <jamatos@novalis.fc.up.pt>

	* exporter.C (Export): for linuxdoc and docbook the buffer is a nice
	file if it doesn't go to a temporary file.

	* buffer.C (sgmlOpenTag):
	(sgmlCloseTag):  remove extra newline insertion.

2002-03-04  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text.C (getRowNearY): comment out debug msg

2002-03-03  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C: first -> first_y

	* text.C (getRowNearY): add some attemts at a possible
	optimization, not working.

	* tabular.[Ch]: add BufferParams to several function so that newly
	created paragraph can be initialized to he default layotu for the
	buffers textclass.

	* tabular-old.C (ReadOld): add buf->params to call of Init

	* screen.C: rename text->first to text->first_y

	* paragraph.C (breakParagraph): always set layout in the broken
	paragraph

	* lyxtextclass.C (Read): remove lowercase
	(hasLayout): ditto
	(operator): ditto
	(delete_layout): ditto

	* lyxtext.h: rename first -> first_y

	* lyxlayout.C (Read): remove lowercase
	(name): ditto
	(setName): ditto
	(obsoleted_by): ditto

	* bufferlist.C (newFile): set layout on first paragrpah of new buffers.

	* buffer.C (insertErtContents): add params are to InsetERT
	(parseSingleLyXformat2Token): add code to check if a paragraphs
	layout really exist.
	(parseSingleLyXformat2Token): add params to several inset
	constructors
	(asciiParagraph): remove lowercase, do the layout comparisons with
	no_case

	* BufferView_pimpl.C (cursorNext): first -> first_y
	(resizeCurrentBuffer): first -> first_y
	(updateScrollbar): first -> first_y
	(scrollCB): first -> first_y
	(workAreaMotionNotify): first -> first_y
	(workAreaButtonPress): first -> first_y
	(checkInsetHit): first -> first_y
	(cursorPrevious): first -> first_y
	(cursorNext): first -> first_y
	(Dispatch): add buffer_->params to severl inset contructors

2002-03-02  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxlayout.C (Read): remove some debug info that I forgot.

	* buffer.C (makeLaTeXFile): fix calling of LaTeXFeatures, and
	clean up the code slightly.
	(makeLinuxDocFile): ditto
	(makeDocBookFile): ditto

	* text2.C: layout as string

	* text.C: layout as string

	* paragraph_pimpl.C: layout as string

	* paragraph.[Ch]: layout as string

	* lyxtextclasslist.[Ch]: layout as string

	* lyxtextclass.[Ch]: layout as string

	* lyxtext.h: layout as string

	* lyxlayout.[Ch]: layout as string

	* lyx_cb.C: layout as string

	* bufferview_funcs.C: layout as string

	* bufferparams.C: layout as string

	* buffer.C: layout as string

	* LyXView.[Ch]: layout as string

	* LaTeXFeatures.[Ch]: layout as string

	* CutAndPaste.C (SwitchLayoutsBetweenClasses): layout as string

	* BufferView_pimpl.C: change current_layout to string, remove
	lyx::layout_type.
	(Dispatch):
	(smartQuote):
	(insertInset):
	(workAreaButtonRelease): layout as string

	* BufferView2.C (unlockInset): adjust

	* vspace.C (asLatexCommand): use an explict temp variable.

2002-03-01  John Levon  <moz@compsoc.man.ac.uk>

	* Makefile.am: use FRONTEND_*

2002-03-01  Juergen Vigna  <jug@sad.it>

	* tabular.C (SetWidthOfMulticolCell): changed to something better
	I hope but still work in progress.
	(recalculateMulticolumnsOfColumn): renamed function from
	recalculateMulticolCells as it is more appropriate now.
	(SetWidthOfCell): calculate multicols better.

2002-03-01  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* minibuffer.C (MiniBuffer): reset timout to 6000, as it was before.

	* lyxfunc.C (processKeySym): print sequence also if it is
	`deleted' (complete)

	* kbsequence.C (print): print sequence even if it is deleted
	(complete would be a better word, actually).

	* lyxfunc.C (dispatch): print complete options after a prefix key

	* vspace.C (asLatexCommand): rewrite in a slightly different form.

2002-03-01  Martin Vermeer  <martin.vermeer@hut.fi>

	* text2.C (setCharFont): eliminate setCharFont code duplication.

2002-03-01  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* BufferView_pimpl.C (Dispatch): remove bogus handling of
	LFUN_TABULAR_FEATURE (bug #177)

2002-02-29 ;-)  Angus Leeming  <a.leeming@ic.ac.uk>

	* Makefile.am: remove figure.h

2002-02-28  Angus Leeming  <a.leeming@ic.ac.uk>

	* Bufferview_pimpl.C:
	* CutAndPasteC:
	* LaTeX.C:
	* LyXSendto.C:
	* buffer.C:
	* bufferlist.C:
	* converter.C:
	* language.C:
	* lyxfunc.C:
	* lyxvc.C:
	* paragraph.C:
	* text.C:
	* text2.C: remove #include "lyx_gui_misc.h".

	* LaTeX.C: added #include <cstdio>

2002-02-28  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* paragraph.C (getMaxDepthAfter): new method. The maximal depth
	that the paragraph following this one can have.

	* text2.C (incDepth): use Paragraph::getMaxDepthAfter

	* vspace.C (asLatexCommand): fix bogus gcc warning

	* Makefile.am (lyx_SOURCES): remove vms_defines.h

2002-02-27  Martin Vermeer  <martin.vermeer@hut.fi>

	* text2.C (setLayout): get rid of redundant code

2002-02-26  Martin Vermeer  <martin.vermeer@hut.fi>

	* text2.C (incDepth): make sure depth cannot be increased beyond
	reasonable values.

2002-02-20  Angus Leeming  <a.leeming@ic.ac.uk>

	* lyxfunc.C (dispatch): act on LFUN_FORKS_SHOW and LFUN_FORKS_KILL.
	also call grfx::GCache::changeDisplay if the graphicsbg color changes.

	* PainterBase.h (image):
	* Painter.[Ch] (image): now accepts a grfx::GImage const & rather than
	a LyXImage const *.

2002-02-26  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView.C:
	* BufferView.h:
	* BufferView_pimpl.C:
	* BufferView_pimpl.h:
	* LaTeXFeatures.C:
	* LyXAction.C:
	* LyXView.C:
	* Makefile.am:
	* UpdateList.h:
	* UpdateList.C:
	* buffer.C:
	* figure.h:
	* figureForm.C:
	* figureForm.h:
	* figure_form.C:
	* figure_form.h:
	* lyx_cb.C:
	* lyx_gui.C:
	* lyx_gui_misc.C:
	* lyxfunc.C:
	* sp_base.h:
	* sp_ispell.h:
	* sp_pspell.h:
	* sp_spell.C: remove fig inset, and the crap house of
	  cards that follows it

2002-02-26  John Levon  <moz@compsoc.man.ac.uk>

	* Makefile.am:
	* lyxserver.C:
	* os2_defines.h:
	* os2_errortable.h:
	* nt_defines.h: move .h into support/

	* vms_defines.h: remove

	* WorkArea.C: add space in debug output

	* text2.C:
	* paragraph.C:
	* buffer.C: add WITH_WARNINGS

	* vc-backend.h:
	* vc-backend.C:
	* bufferlist.C: s/retrive/retrieve/, add docs

	* vspace.h:
	* vspace.C:
	* kbmap.h:
	* lyxlength.h:
	* lyxgluelength.h:
	* length_common.h:
	* chset.h:
	* chset.C: add docs

	* lyxgui.C: add ID to X error handler

	* lyxtestclass.c: fix typo

2002-02-26  Juergen Vigna  <jug@sad.it>

	* tabular_funcs.C (write_attribute): changed so that some default
	attributes are not written at all.
	(getTokenValue): set default values before trying to read the
	value so we have the return value always set as default if we don't
	find the token we search for.

	* tabular.C (Write): write bools as bools not as strings!

2002-02-22  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (workAreaButtonPress): call edit() before calling
	insetButtonPress for HIGHLY_EDITABLE_INSETS seems saner (fix #250).

	* text.C (leftMargin): don't add an indent for paragraphs inside
	tabular cells (fix #208).

2002-02-21  José Matos  <jamatos@fep.up.pt>

	* tabular.C (docBook): fixed support for long tables.

2002-02-20  Juergen Vigna  <jug@sad.it>

	* text2.C (getFont): get the drawing font of the Inset if this
	paragraph is inside an inset (only important for InsetERT for now).

	* buffer.C (insertErtContents): use new lanugage params in ERT
	constructor.

	* CutAndPaste.C: commenting out seemingly uneeded code.

2002-02-19  Allan Rae  <rae@lyx.org>

	* BufferView2.C (removeAutoInsets): fix remaining freed memory read.
	Iterators might be simple to use but they also get invalidated.
	(removeAutoInsets): renamed saved cursor tracking variables and added
	some comments to clarify what everything does.

2002-02-18  Angus Leeming  <a.leeming@ic.ac.uk>

	* Chktex.C:
	* LaTeX.C:
	* LyXSendto.C:
	* converter.C:
	* lyx_cb.C:
	* vc-backend.C: Changes due to the renaming of support/syscall.[Ch] as
	support/systemcall.[Ch] and of class Systemcalls as class SystemCall.

	* lyxfunc.C:
	* vc-backend.h: remove #include "support/syscall.h"

	* LaTeX.C:
	* LyXSendto.C:
	* converter.C: rearrange #includes in Lars' approved fashion.

	* LyXView.[Ch]: make autosave_timeout a pointer to Timeout. Can thus
	forward declare class Timeout in the header file.

	* XFormsView.C: changes due to the above.

	* minibuffer.[Ch]: make timer and stored_timer pointers to Timeout,
	similar to LyXView.

	* commandtags.h: add LFUN_FORKS_SHOW and LFUN_FORKS_KILL to the enum.
	* LyXAction.C (init): add LFUN_FORKS_SHOW and LFUN_FORKS_KILL to items[]

2002-02-18  José Matos  <jamatos@fep.up.pt>

	* buffer.C (simpleDocBookOnePar): if paragraph style is CDATA escapes
	insets contents.

2002-02-16  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* a lot of small ws changes
	* add a lot of using std::XXX
	* use std construcs some places where approp.
	* use some exisint stuff from lyxfunctional where approp.
	* Make file changes to use partial linking (lets test this now...)

2002-02-16  Angus Leeming  <a.leeming@ic.ac.uk>

	* Chktex.C:
	* buffer.C:
	remove #include "support/syscontr.h" as it's redundant. Always has been.

	* Chktex.C:
	* LaTeX.C:
	* LyXSendto.C:
	* converter.C:
	* lyx_cb.C:
	* vc-backend.C:
	change Systemcalls::System to Systemcalls::Wait and
	change Systemcalls::SystemDontWait to Systemcalls::DontWait.
	No change of functionality, just reflects the stripped down Systemcalls
	class.

2002-02-16  Angus Leeming  <a.leeming@ic.ac.uk>

	* debug.[Ch]: add a GRAPHICS type to the enum.

2002-02-13  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* text.C (nextBreakPoint): use Paragraph::isLineSeparator

	* paragraph.C (isLineSeparator): call Inset::isLineSeparator if
	there is an inset.

2002-02-12  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (getStatus): change the rules for LFUN_INSET_TOGGLE to
	match the changes below.

	* text2.C (toggleInset): if there is not editable inset at cursor
	position, try to see if cursor is _inside_ a collapsable inset
	and close it.

2002-02-11  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (getStatus): handle LFUN_SWITCHBUFFER so that the
	document menu has a nice checkbox

2002-02-07  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxlength.C (asLatexString): change PW to output as percent of
	\textwidth.

	* lengthcommon.C: change '%' to 't%'

	* lyxfunc.C (dispatch): a few comments from Martin

2002-02-06  John Levon  <moz@compsoc.man.ac.uk>

	* WorkArea.h:
	* WorkArea.C:
	* BufferView_pimpl.h:
	* BufferView_pimpl.C: clear our selection when X tells us we've lost
	  the X selection.

2002-02-07  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* vspace.C (inPixels): fix compiler warning

2002-02-06  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (getStatus): fix status message for disabled commands.

2002-02-01  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: fix crash on close buffer
	during selection (#227)

2002-01-27  Herbert Voss  <voss@lyx.org>

	* buffer.C: link old Figure to new graphic inset

2002-01-26  Dekel Tsur  <dekelts@tau.ac.il>

	* FontLoader.C (getFontinfo): Change the latex font names in order
	to match the names of type1inst.

2002-01-21  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* WorkArea.C (WorkArea): initialize the scrollbar bounds.

	* DepTable.C (sumchange): do not evaluate end() on every iteratrion.
	(extchanged): ditto
	(ext_exist): ditto
	(remove_files_with_extension): ditto
	(remove_file): ditto
	(write): ditto

	* BufferView_pimpl.C (updateScrollbar): do the right thing if the
	document is smaller than the work area height. Do not initialize
	static variables to 0.

2002-01-20  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyx_gui.C (init): give the toolbar tooltips a normal font.

	* lyxfunc.C (getStatus): handle LFUN_LAYOUT like
	LFUN_LAYOUT_PARAGRAPHS.

	* tabular.C (GetCellFromInset): new method. Finds an inset in a
	tabular. It is possible to provide a possible cell, which will
	typically be the actcell from the corresponding insettabular

	* lyxfunc.C (getStatus): small cleanup; disable
	LFUN_LAYOUT_PARAGRAPHS in insets where forceDefaultParagraphs is
	true

2002-01-19  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* tabular.C (Validate): remove broken optimization (fixes bug #201)

	* paragraph.C (startTeXParParams):
	(endTeXParParams): new methods. The LaTeX code to
	start/end paragraph formatting
	(simpleTeXOnePar): call startTeXParParams also when paragraph is
	empty (fixes bug #200)

	* vspace.C (inPixels): adapt to the change below
	(inPixels): [later] more cleanups (remove unused variables)

	* lyxlength.C (inPixels): change to use a width and a height as
	parameter.

2002-01-18  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxlength.C (asLatexString): \pagewidth is not a LaTeX macro.
	Replaced with \paperwidth

	* DepTable.C (insert): add std:: qualifier

2002-01-18  Allan Rae  <rae@lyx.org>

	* text2.C (removeRow): add comment.  Should other refresh_?? vars be
	updated also?

	* text.C (drawInset): Turned out I didn't know enough about how
	rebreaking worked.  This fixes most of the redraw problems.  I see
	an occasional cursor trail when a line is broken now and the cursor
	placement can seem out by a few pixels also after a rebreak.

2002-01-17  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* buffer.C (parseSingleLyXformat2Token): update because minipage
	width is now a LyXLength

	* lyxlength.C (inPixels): new method, extracted from VSpace::inPixels

	* BufferView_pimpl.C (smartQuote): fix insertion of quote inset in
	math insets

2002-01-17  Juergen Vigna  <jug@sad.it>

	* lyxfunc.C (dispatch): fixed PARAGRAPH_GOTO

	* BufferView2.C (lockInset): call edit() so that theLockingInset()
	is set correctly and the inset is updated correctly.

2002-01-17  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* CutAndPaste.C (pasteSelection): move the setInsetOwner call at
	the beginning of the loop.

2002-01-17  John Levon  <moz@compsoc.man.ac.uk>

	* lyxrc.C: improve help for use_scalable_fonts

2002-01-17  Allan Rae  <rae@lyx.org>

	* lyx_cb.C (ShowMessage): make sure we have a user and an owner.

2002-01-17  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* CutAndPaste.C (pasteSelection): when pasting multiple paragraph,
	make sure to set their inset_owner to the right value (bug #171)

2001-12-12  Ben Stanley  <bds02@uow.edu.au>

	* DepTable.h
	* DepTable.C: Implement mtime checking to reduce time spent doing
	CRCs.

2002-01-16  Juergen Vigna  <jug@sad.it>

	* tabular.C (GetAdditionalHeight): one of error fixed.

	* lyxrc.C (output): small fix in writing use_pspell.

2002-01-16  Angus Leeming  <a.leeming@ic.ac.uk>

	* sp_base.h: #include LString.h

2002-01-16  Allan Rae  <rae@lyx.org>

	* text2.C (removeRow): refresh_row needs a valid row.  Or does it?
	Can someone check this please?

	* text.C (drawInset): It was possible that p.row would be removed by
	breakAgainOneRow upsetting a few other settings.  There may be another
	small tweak possible by setting need_break_row = 0 when p.row has been
	removed but I don't know enough about the logic here.

2002-01-15  Allan Rae  <rae@lyx.org>

	* text.C (insertChar): removed conditional truism.

	* BufferView2.C (removeAutoInsets): More tweaks.
	cur_par_prev could be a stray pointer.  Check for trailing empty line
	in case last line was cur_par and only had an error inset on it.

2002-01-14  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyx_cb.C (MenuWrite): buffer->fileName is guaranteed to be
	absolute

	* vc-backend.C (most methods):
	* exporter.C (Export):
	* converter.C (convert):
	(runLaTeX):
	* LyXSendto.C (SendtoApplyCB):
	* lyxfunc.C (dispatch):
	(menuNew):
	(open):
	(doImport):
	* lyx_cb.C (AutoSave):
	(InsertAsciiFile):
	* BufferView_pimpl.C (MenuInsertLyXFile):
	* buffer.C (runChktex): use Buffer::filePath().

	* buffer.h: rename filename to filename_; rename filepath to
	filepath_ and make it private
	(filePath): new method

	* buffer.C (writeFile): use fileName()
	(getLatexName):

	* lyx_main.C (init): fix starting  of LyX when the binary is a
	link from so,ewhere else.

	* minibuffer.C: include <cctype> for isprint

2002-01-14  Angus Leeming  <a.leeming@ic.ac.uk>

	* buffer.C (parseSingleLyXformat2Token): changes associated with the
	change of InsetMinipage::width to InsetMinipage::pageWidth to avoid the
	name clash with InsetCollapsable's width function.

2002-01-14  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lastfiles.C: include <iterator>

2002-01-14  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView2.C (ChangeRefsIfUnique): use lyx::count rather than
	std::count.

	* buffer.C (makeLaTeXFile): ditto.
	Also make loop operation more transparent.

2002-01-14  Angus Leeming  <a.leeming@ic.ac.uk>

	* ToolbarDefaults.C: remove trailing comma closing namespace.

	* WorkArea.h: remove WorkArea:: from declaration of event_cb.

	* lyxfunc.[Ch]: clean-up declaration of verboseDispatch functions
	as in WorkArea.

	* trans.C (Load): comment out unused variable, allowed.

2002-01-11  Angus Leeming  <a.leeming@ic.ac.uk>

	* minibuffer.[Ch] (append_char): new method to recieve input from the
	drop-down completion browser. If a key was pressed, then recieve this
	char and append it to the existing string.
	(peek_event): modify the positioning data passed to the completion
	browser so that it can be placed above the minibuffer rather than below.
2002-01-14  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* LyXAction.C (init): alloe error-next for readonly documents.

	* BufferView2.C (ChangeRefsIfUnique): use standard version of
	count.

2002-01-13  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* bufferlist.C (readFile): create the buffer _after_ checking that
	the file exists.

	* lyxfunc.C (verboseDispatch): fix handling of arguments

	* lyxrc.C (setDefaults): do not initialize document_path to $HOME.

	* lyxrc.C: use string::erase() instead of initializing to "".


2001-11-26  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.h:
	* BufferView_pimpl.C:
	* WorkArea.h:
	* WorkArea.C:
	* text2.C: tell X when we have made a selection for copying

2002-01-13  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* BufferView_pimpl.C (MenuInsertLyXFile):
	* lyxfunc.C (menuNew):
	(open):
	(doImport): add shortcuts to directory buttons

	* BufferView_pimpl.C (workAreaButtonRelease): remove dead code (to
	open a float)

	* lyxfunc.C (setStatusMessage):
	(getStatusMessage): new methods
	(getStatus):use setStatusMessage instead of setErrorMessage
	(dispatch): when function is disabled, set error message here
	[instead of in getStatus previously]

	* BufferView_pimpl.C (workAreaButtonRelease): update
	toolbar/menubar here too.

2002-01-13  Allan Rae  <rae@lyx.org>

	* BufferView2.C (removeAutoInsets): finished off earlier fix.
	Now seems indestructible.  Remaining task is to audit all other
	code affected by deleteEmptyParagraphMechanism.  One small quirk
	left is that an empty document with an error in the preamble can
	be made to report an error but no error box appears.  I don't know
	where it goes.
	(removeAutoInsets): Improved comments.

2002-01-13  John Levon  <moz@compsoc.man.ac.uk>

	* Thesaurus.h:
	* Thesaurus.C: update for Aiksaurus 0.14

2002-01-13  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C (firstParagraph): removed member function, all uses
	replaces with ownerParagraph
	(redoParagraphs): here
	(updateInset): here
	(toggleAppendix): here
	* BufferView2.C (insertErrors): here
	(setCursorFromRow): here

2002-01-13  Allan Rae  <rae@lyx.org>

	* BufferView2.C (removeAutoInsets): ensure we have a valid cursor if
	the old cursor is now invalid due to deleteEmptyParagraphMechanism.
	There is still a way to segfault this although you may have to do this
	multiple times: Have an InsetERT with an unknown command in it.
	View->DVI, move cursor between Error box and InsetERT and hit <Enter>,
	<down-arrow>, <Enter> again, View->DVI, BANG!

	* text2.C (setCursor):
	(deleteEmptyParagraphMechanism):
	* lyxtext.h (setCursor):
	(deleteEmptyParagraphMechanism): return true if the paragraph was deleted.
	Making use of the return value may help fix other bugs.

2002-01-12  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (dispatch): update toolbar/menubar after dispatching.

	* LyXView.C (updateMenubar): call MenuBar::update here
	(updateToolbar): but not here
	(showState): do not update toolbar/menubar

	* LyXAction.[Ch]: move isPseudoAction to the C file, since nobody
	should need to care about that.

	* lyxfunc.C (verboseDispatch): simplify a bit
	(getStatus): have a version which takes a pseudoaction, and
	another which requires a (kb_action,string).

	* LyXAction.C (retrieveActionArg): make it work also when action
	is not a pseudo-action.
	(getActionName): simplify a bit
	(helpText):

2002-01-11  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (verboseDispatch): new families of methods with
	several ways to specify a command and a bool to indicate whether
	the command name and shortcut should be displayed in minibuffer
	(eventually, we could extend that to a finer bitmask like
	SHORTCUT|CMDNAME|CMDRESULT, or whatever).
	(dispatch): the pristine dispatch command which just, well,
	dispatchs! Note it still sets its result to minibuffer; I'm not
	sure we want that.

	* lyxfunc.h: remove setHintMessage

	* vc-backend.C: use LFUN_MENURELOAD instead of "buffer-reload"

2002-01-10  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* BufferView_pimpl.C (specialChar): delete new inset if we have
	not been able to insert it.

	* kbmap.C: revert to using int instead of kb_action, since all we
	are dealing with is pseudo-actions.

	* LyXAction.C (searchActionArg): change to return int instead of
	kb_action, since the result is a pseudoaction.

2002-01-12  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (insertErtContents): Fix (partially) the font bug.

2002-01-11  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView2.C (ChangeRefsIfUnique): use the HP version of std::count
	as the other one is broken on my machine!

2002-01-10  Martin Vermeer  <martin.vermeer@hut.fi>

	* commandtags.h:
	* LyXAction.C: two new LFUNS, LFUN_FRAK and LFUN_ITAL.

2002-01-10  Angus Leeming  <a.leeming@ic.ac.uk>

	* lyxrc.[Ch]: change names and descriptions of popup font variables to
	reflect their actual use. Provide compatibility code for older lyxrc
	files.

	* lyx_gui.C (init): revoke change of 2002-01-07 of popup font style to
	FL_NORMAL_STYLE.
	change names of popup font variables in line with the changes to lyxrc.C

2002-01-10  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* buffer.C (asciiParagraph): avoid outputing a word twice after
	an inset.

	* lyxrc.C (getDescription): document that document_path and
	template_path can be empty.

2002-01-09  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* LaTeXFeatures.C (getMacros):
	* buffer.C (validate): rename feature "amsstyle" to "amsmath"

	* buffer.C (makeLaTeXFile): remove test for "amsstyle" from here.

	* LaTeXFeatures.C (useFloat): require "float" here instead of in
	getPackages.
	(getPackages): rename feature "floats" to "float". Use an array to
	iterate over 'simple' features (i.e. just a \usepackage). Add
	handling of "amsmath" (renamed from "amsstyle").

2001-12-29  Michael A. Koziarski  <michael@koziarski.org>

	* LaTeXFeatures.C (require): Prevent duplicate entries in the
	features list.

2002-01-08  Angus Leeming  <a.leeming@ic.ac.uk>

	* FuncStatus.C: small compile fix for DEC cxx. Doesn't like
	FuncStaus::FuncStatus & FuncStaus::some_method().

2002-01-08  Martin Vermeer  <martin.vermeer@hut.fi>

	* FuncStatus.[Ch]: new files. This is a rewrite as a proper class
	of the func_satus stuff. Edited and massaged in various ways by
	JMarc.

	* lyxfunc.C (getStatus): use FuncStatus

2002-01-08  Juergen Vigna  <jug@sad.it>

	* text.C (nextBreakPoint): use function Inset::isChar().

	* paragraph.C (TeXOnePar): use function
	Inset::forceDefaultParagraphs.

	* buffer.C (latexParagraphs): use function
	Inset::forceDefaultParagraphs.

2002-01-07  Angus Leeming  <a.leeming@ic.ac.uk>

	* lyx_gui.C (init): set the style of the menu popups to
	FL_BOLD_STYLE, thereby fixing bugzilla bug #32.

2002-01-07  Juergen Vigna  <jug@sad.it>

	* text.C (setHeightOfRow): small fix
	(prepareToPrint): don't look at alignment if we don't have the place
	for doing it.

2002-01-07  Angus Leeming  <a.leeming@ic.ac.uk>

	* box.C: New file. Move the Box methods and functions out of box.h,
	following Lars' suggestion.

2002-01-07  Angus Leeming  <a.leeming@ic.ac.uk>

	* box.h: #include "support/LOstream.h", needed for inlined function.

	* lyxtextclass.C:
	* lyxtextclasslist.C: added some using std declarations.

2002-01-06  John Levon  <moz@compsoc.man.ac.uk>

	* box.h: make signed dimensions to allow insets wider than
	  the screen (bug #162)

	* BufferView_pimpl.C: add some insetHit debug

2002-01-05  John Levon  <moz@compsoc.man.ac.uk>

	* vc-backend.C: add FIXME

2002-01-03  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (getStatus): enable code for showing math font status
	in toolbar/menu.

2002-01-07  Juergen Vigna  <jug@sad.it>

	* text.C (nextBreakPoint): removed debug output not needed anymore.

2002-01-06  Juergen Vigna  <jug@sad.it>

	* text.C (nextBreakPoint): fixed up this function we had this bug
	since ever but now hopefully we break row better.
	(insertChar): we have to check if an inset is the next char as it
	could now happen that a large inset is causing a break.

2002-01-05  Juergen Vigna  <jug@sad.it>

	* BufferView2.C (showLockedInsetCursor): don't draw the inset cursor
	if it doesn't like to be drawed.

2002-01-04  Juergen Vigna  <jug@sad.it>

	* BufferView2.C (lockInset): forgot to set a cursor.

	* lyxfunc.C (dispatch): add a finishUndo() in LFUN_ESCAPE.

2002-01-03  Martin Vermeer  <martin.vermeer@hut.fi>

	* FormMathsPanel.C:
	* FormMathsPanel.h
	* MathsSymbols.C:
	* form_maths_panel.C:
	* form_maths_panel.h:
	* form_maths_panel.fd: implemented sub- and super- buttons in math
	panel.

	* lyx_main.C: Revised hardwired bindings to allow original _ and ^
	(or ^ space) to be used as in TeX (req'd by Andrï¿½.

	* lyxfunc.C: Allow ^ and _ again to be used both as
	super/subscript (mathed) and as themselves (in text).

2002-01-03  Allan Rae  <rae@lyx.org>

	* LyXView.C (updateWindowTitle): Setup a short icon title of either
	"LyX" or the filename of the current buffer if it has one.  This is a
	modified form of John Levon's patch.

	* XFormsView.C (setWindowTitle): also set icon title.

	* LyXView.h (setWindowTitle): signature changed.
	* XFormsView.h (setWindowTitle): ditto.

2002-01-02  Juergen Vigna  <jug@sad.it>

	* tabular.C (AppendColumn): hopefully fixed this memory access problem.

2001-12-28  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* screen.C (topCursorVisible): introduce a temp var for
	text->cursor.row(), handle the case where this row is null. (kindo
	hachish)

	* text2.C (setCursor): add a couple of asserts.

	* paragraph.h (inset_iterator): add -> operator

	* paragraph.[Ch] (autoDeleteInsets): remove member function

	* BufferView2.C (removeAutoInsets): rewrite to handle the old
	cursor pos correctly and handle inset deletion by itself.
	(insertErrors): move iterator declaration out of for expression

	* lyxtextclass.C: add <algorithm>

	* Makefile.am: added the new files to sources, removed layout.C

	* layout.C: removed file

	* layout.h: remove LYX_DUMMY_LAYOUT

	* lyxtextclasslist.C (NumberOfLayout): do not special case dummy
	layout.

	* lyxlayout.[Ch]:
	* lyxtextclass.[Ch]:
	* lyxtextclasslist.[Ch]: new files

	* include order changes to a lot of files, also changes because of
	the six new files.

2001-12-27  Juergen Vigna  <jug@sad.it>

	* buffer.C (asciiParagraph): more fixes.

	* tabular.C (ascii): make ascii export support export of only the
	data separated by a column-delimiter.
	(ascii): better support for ascii export.

	* buffer.C (asciiParagraph): rewrote to hopefully work as expected!

2001-12-26  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* tabular_funcs.C: use a "using std::getline" instead of the
	previous fix from Angus (necessary for cxx + lyxstring)

2001-12-24  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (tripleClick): fixed for InsetText.

	* buffer.C (parseSingleLyXformat2Token): fixed 2 compatibility read
	problems. First check a minipage also if we have some ert-contents
	(not only on par->size(), second set the right depth of the paragraph
	on the relink to the root-paragraph-list!

	* undo_funcs.C (textHandleUndo): fixed a stupid earlier wrong fix
	which then did not anymore update the main paragraphs on undo/redo!

2001-12-21  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* lyxfunc.C (getStatus): use func_status::toggle to simplify the
	code. Support all font-changing funcs (even those which are not in
	menu currently). Support for reporting font settings in
	mathed (disabled until Andre provides a function on mathed's side).

	* func_status.h (toggle): small helper function to set toggle
	state on a flag.

2001-12-21  Angus Leeming  <a.leeming@ic.ac.uk>

	* tabular_funcs.C: getline -> std::getline

2001-12-21  Juergen Vigna  <jug@sad.it>

	* undo_funcs.C (textHandleUndo): fixed a case where tmppar3 is
	accessed and could be 0 (I couldn't generate this but it seems
	Michael could!).

2001-12-20  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* tabular_funcs.C: add LIstream.h, move write_attribute to..
	* tabular_funcs.h: here and include iosfwd

2001-12-20  Juergen Vigna  <jug@sad.it>

	* undo_funcs.C (textHandleUndo): fixed crash when undo_cursor not
	inside inset but undo_par was.

2001-12-19  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* Thesaurus.C: always include <config.h> in sources.

	* Painter.h:
	* lyxlookup.h:
	* box.h: do not include <config.h> in header files

	* text.C (paintLastRow): remove unused variable

	* text.C (transformChar):
	(insertChar):
	* tabular-old.C (getTokenValue): use IsDigit instead of isdigit.

	* Painter.C (text):
	* font.C (width): rewrite to use uppercase() instead of
	islower/toupper.

	* lyxfind.C (IsStringInText): use uppercase instead of toupper.

2001-12-12  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfind.C: clean up of find failure position change

2001-12-20  Juergen Vigna  <jug@sad.it>

	* Makefile.am (lyx_SOURCES): added tabular_funcs.[hC].

	* tabular.C (isValidRow): added to check if we're in a LT-h/f row.
	(TeXRow): added to LaTeX a single tabular row.
	(TeXLongtableHeaderFooter): added to output LT-h/f data.
	(Latex): simplified and finally good LT-h/f support.
	(various_functions): just small adaptions for LT-h/f support.

	* tabular_funcs.[hC]: added and moved here all not classfunctions
	of LyXTabular.

2001-12-19  Juergen Vigna  <jug@sad.it>

	* tabular.[Ch]: better support for longtabular options (not finished
	yet!)

2001-12-18  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* text.C (paintLastRow): use the label font instead of the font of
	the last character to compute the size of *_BOX. This makes more
	sense and avoids a crash with empty paragraphs.
	Use Painter::rectangle to draw EMPTY_BOX.

2001-12-19  Juergen Vigna  <jug@sad.it>

	* undo_funcs.C (textHandleUndo): fixed setting of inset_owner of
	the paragraphs if the replaced paragraph is not the first one!
	Tried to delete not used paragraphs but does not work yet so for
	now it's inside #ifdef's and by default off!

2001-12-18  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* MenuBackend.C: include "lyx_main.h" instead of declaring
	lastfiles (actually was declared as LastFiles* instead of a
	scoped_ptr).

2001-12-17  Juergen Vigna  <jug@sad.it>

	* tabular.C (AppendColumn): applied John's fix

2001-12-15  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView.h:
	* BufferView.C:
	* BufferView_pimpl.h:
	* BufferView_pimpl.C: cleanup and fix of checkInsetHit().

	* Makefile.am:
	* box.h: new start of class for above

	* lyxfunc.C: ignore space-only minibuffer dispatches.
	  Show the command name when it doesn't exist

	* minibuffer.C: don't add empty lines to the history

	* minibuffer.C: add a space on dropdown completion

2001-12-14  John Levon  <moz@compsoc.man.ac.uk>

	* text.C: fix line above/below drawing in insets

2001-12-15  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxlength.C (LyXLength): Initialize private variables.

2001-12-15  Dekel Tsur  <dekelts@tau.ac.il>

	* CutAndPaste.C (SwitchLayoutsBetweenClasses): Use buffer language
	when inserting error insets.

2001-12-13  Juergen Vigna  <jug@sad.it>

	* undo_funcs.C (textRedo/Undo): fixed as the first paragraph was
	actually sometimes the before-paragraph.
	(setUndo): don't clear the redostack if we're not actually undoing!

2001-12-06  Juergen Vigna  <jug@sad.it>

	* undo_funcs.C (textHandleUndo): well after John's hint I got here
	and fixed redoing of main paragraph, so we can use it now ;)

	* text2.C (redoParagraphs): fixed a crash when having only 1 row!

2001-12-13  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* undo_funcs.C (textHandleUndo): undo undo leak fix below, as per
	Juergen's request

2001-12-13  André Pönitz <poenitz@gmx.net>

	* undostack.[Ch]:
	* undo_func.C: minor cleanup

2001-12-12  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* FontLoader.C (getFontinfo): only use symbol fonts with encoding
	-adobe-fontspecific. At least Mandrake and Redhat have a symbol
	font in urw-fonts package which is marked as -urw-fontspecific and
	does not work (incidentally, changing the encoding in the
	fonts.dir of this package to -adobe-fontspecific fixes the
	problem).

	* undo_funcs.C (textHandleUndo): fix leak in undo, but now there
	is a crash when undoing first paragraph (Juergen, please take a
	look). THis does not mean the undo fix is wrong, just that it
	uncovers problems.

	* text2.C (ownerParagraph): let the (int,Paragraph*) version call
	the (Paragraph*) version when needed instead of duplicating the
	code.

	* text.C (workWidth): use Inset::parOwner to find out where the
	inset has been inserted. This is a huge performance gain for large
	documents with lots of insets. If Inset::parOwner is not set, fall
	back on the brute force method

	* paragraph_pimpl.C (insertInset):
	* paragraph.C (Paragraph):
	(cutIntoMinibuffer): set parOwner of insets when
	inserting/removing them

	* lyxtext.h: add short comment on deleteEmptyParagraphMechanism

2001-12-12  Martin Vermeer  <martin.vermeer@hut.fi>

	* commandtags.h:
	* LyXAction.C:
	* lyx_main.C:
	* lyxfunc.C:
	* mathed/formulabase.C:
	* mathed/math_cursor.[Ch]:
	make sub/superscript into functions LFUN_SUB/SUPERSCRIPT.


2001-12-12  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxlength.[Ch] (operator!=): new function

2001-12-12  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* text.C (workWidth): use Inset::parOwner to find out where the
	inset has been inserted. This is a huge performance gain for large
	documents with lots of insets. If Inset::parOwner is not set, fall
	back on the brute force method

	* paragraph_pimpl.C (insertInset):
	* paragraph.C (Paragraph):
	(cutIntoMinibuffer): set parOwner of insets when
	inserting/removing them

	* lyxtext.h: add short comment on deleteEmptyParagraphMechanism

2001-12-10  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* tabular-old.C (getTokenValue):
	* tabular.C (getTokenValue):
	(write_attribute): new versions for LyXLength
	(everywhere): adjust the use of widths

	* tabular.h: change the type of widths from string to LyXLength

2001-12-11  Ben Stanley <bds02@uow.edu.au>

	* paragraph.C: fixed missing line number count when exporting
	Environments to LaTeX file

	* buffer.C: added informational message for checking line numbers.

2001-12-11  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* text2.C (deleteEmptyParagraphMechanism): if there is only one
	paragraph, do the 'double space' part, but not the 'empty
	paragraph' one.

	* text.C (workWidth): small optimization
	(getLengthMarkerHeight): use minimal size for negative lengths.

2001-12-11  Dekel Tsur  <dekelts@tau.ac.il>

	* lyxfont.C (GUIFamilyNames): Fix GUIFamilyNames array

	* FontLoader.C (getFontinfo): Use "*-eufrak-medium"

2001-12-11  André Pönitz <poenitz@gmx.net>

	* FontLoader.C:
	* lyxfont.[Ch]: support for fraktur font used by \mathfrak

2001-12-06  John Levon  <moz@compsoc.man.ac.uk>

	* text2.C: keep selection on a setFont()

2001-12-06  John Levon  <moz@compsoc.man.ac.uk>

	* lyx_cb.C: another bv->text misuse, from insert label

2001-12-03  John Levon  <moz@compsoc.man.ac.uk>

	* kbsequence.h:
	* kbsequence.C: re-instate nmodifier mask

2001-12-12  Angus Leeming  <a.leeming@ic.ac.uk>

	* lyx_main.h: make lyxGUI private.

2001-12-06  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfind.C: place the cursor correctly on failed search

2001-12-09  Jean-Marc Lasgouttes  <lasgouttes@freesurf.fr>

	* text.C (getLengthMarkerHeight): for small heights, the arrows
	are not always on top/bottom of the text
	(drawLengthMarker): smaller arrows; take the left margin in
	account; draw also vfills.
	(paintFirstRow):
	(paintLastRow): remove special code for vfill and standard spaces,
	since everything is handled in drawLengthMarker now.

2001-12-08  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C (insertErtContents): try to handle font and language
	interaction a bit better.g

	* ColorHandler.C (updateColor): change the hash to cover the whole
	LColor enum, ws cleanup
	(getGCLinepars): ditto
	(getGCLinepars): only lookup in the linecache once.

2001-12-07  Dekel Tsur  <dekelts@tau.ac.il>

	* iterators.C (operator++): Make the iterator more robust

	* BufferView2.C (removeAutoInsets): Use paragraph iterators
	(John's patch)
	* CutAndPaste.C (SwitchLayoutsBetweenClasses): Ditto

2001-12-05  John Levon  <moz@compsoc.man.ac.uk>

	* lyxtext.h:
	* text.C: better added space drawing

2001-12-05  John Levon  <moz@compsoc.man.ac.uk>

	* LyXView.C:
	* BufferView2.C: fix layout combo update on inset unlock

2001-12-05  John Levon  <moz@compsoc.man.ac.uk>

	* Makefile.am: don't compile unused files

2001-12-05  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.C:
	* commandtags.h:
	* LyXAction.C: remove old LFUN_LAYOUTNO

2001-12-05  John Levon  <moz@compsoc.man.ac.uk>

	* paragraph_pimpl.h:
	* paragraph_pimpl.C: isTextAt() doesn't need font param

2001-12-05  John Levon  <moz@compsoc.man.ac.uk>

	* lyxlex.h:
	* lyxlex.C: little cleanup

2001-12-05  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: fix insertAscii for insets

2001-12-05  Juergen Vigna  <jug@sad.it>

	* CutAndPaste.C (pasteSelection): remove not allowed insets/chars and
	set the right font on the "multi" paragraph paste!

2001-12-05  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* trans_decl.h:
	* trans_mgr.[Ch]:
	* trans.[Ch]:
	* lyxgluelength.C:
	* lyxlength.C: remove out-commented code.

	* BufferView_pimpl:
	* CutAndPaste.C:
	* DepTable.C:
	* buffer.C:
	* chset.C:
	* lastfiles.C:
	* lyxlex.C:
	* lyxlex_pimpl.C:
	* lyxserver.C:
	* screen.C:
	* tabular-old.C:
	* tabular.C:
	* text.C:
	* trans_mgr.C:
	* vc-backend.C: change "while(" to "while ("

	* lyxlength.[Ch]: add zero function to check if length is zero or
	not
	* lyxgluelength.C: use it

2001-12-05  Allan Rae  <rae@lyx.org>

	* lyxlength.C: Attempted a fix for the abs(int) header selection.
	Works for 2.95.3, from what I understand of Garst's reports this should
	work for other g++ versions.  We're screwed if the abs(int) definition
	changed between bugfix releases of gcc.

2001-12-04  John Levon  <moz@compsoc.man.ac.uk>

	* text.C: fix chapter label offset !

2001-12-04  John Levon  <moz@compsoc.man.ac.uk>

	* lyxtext.h:
	* text.C: fix hfill at end of line, clean up

2001-12-04  Juergen Vigna  <jug@sad.it>

	* undo_funcs.C (textHandleUndo): added a call to inset->update() so
	that we force an update of the inset and it's owners if neccessary.

2001-12-03  Juergen Vigna  <jug@sad.it>

	* text.C (rowLast): simplified code

2001-12-03  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.C: fix show options on timeout

2001-12-03  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* screen.C (topCursorVisible): scroll half a page when the cursor
	reached top of bottom of screen

2001-12-02  John Levon  <moz@compsoc.man.ac.uk>

	* minibuffer.C: deactivate on loss of focus

2001-12-02  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* vspace.[Ch] (operator!=): add operator.

2001-12-01  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: refuse to open an inset when
	there's a selection.

2001-11-30  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: allow to click on RHS of full row insets

2001-11-30  Juergen Vigna  <jug@sad.it>

	* tabular.C (LyXTabular): add a same_id to set the same id's in the
	insets for undo reasons.

2001-11-28  André Pönitz <poenitz@gmx.net>

	* vspace.[Ch]: cosmetical changes

2001-11-26  John Levon  <moz@compsoc.man.ac.uk>

	* LyXAction.h:
	* LyXAction.C:
	* lyxfunc.h:
	* lyxfunc.C:
	* kbmap.h:
	* kbmap.C:
	* lyxrc.C:
	* kbsequence.h:
	* kbsequence.C: part re-write of old kb code

	* Painter.C:
	* WorkArea.C: remove Lgb_bug_find_hack

2001-11-30  José Matos <jamatos@fep.up.pt>

	* buffer.C (makeDocBookFile): add a comment to point a hack.
	(simpleDocBookOnePar): changed a PAR::META_INSET to isInset().
	Fixed a double write of labels.

2001-11-29 Ben Stanley <bds02@uow.edu.au>

	* LaTeX.C:
	* LaTeX.h Fixed bug in LaTeX class where it would not
	re-run latex if no depfiles were changed, but the .dvi was removed.

2001-11-28  André Pönitz <poenitz@gmx.net>

	* all the files from the change on 2001/11/26:
	use lyx::layout_type instead of LyXTextClass::size_type
	use lyx::textclass_type instead of LyXTextClassList::size_type

2001-11-29  Juergen Vigna  <jug@sad.it>

	* text.C: added support for paragraph::isFreeSpacing()

	* buffer.C: same as above

	* paragraph.h: inserted isFreeSpacing() function to enable
	FreeSpacing inside InsetERT.

	* CutAndPaste.C (cutSelection/copySelection): set the inset_owner
	of the paragraph's in the cut/copy buffer to 0!

	* text2.C (removeRow): remove the assert as it can!

	* lyxtext.h: added helper function firstRow returning firstrow and
	made firstrow private again.

	* BufferView2.C (lockInset): don't relock if we're already locked!

	* text2.C (deleteEmptyParagraphMechanism): don't do anything if it's
	the only paragraph.
	(removeRow): added Assert::(firstrow)

	* debug.C: forgot to add INSETTEXT here.

2001-11-28  Juergen Vigna  <jug@sad.it>

	* sp_spell.C (initialize): changed error text to more general
	spellchecker command use (not only ispell!)

	* bufferlist.C (qwriteAll): fixed "Cancel" button handling!

	* debug.h: inserted one for debugging INSETTEXT (and InsetTabular)!

2001-11-26  John Levon  <moz@compsoc.man.ac.uk>

	* vspace.C: initialise lyxgluelength on failure

2001-11-28  Allan Rae  <rae@lyx.org>

	* text.C (paintLastRow): g++-2.95.3 and others don't like variable
	declaration & definition that looks like a function declaration.

2001-11-27  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* BufferView2.C (copy):
	(copyEnvironment): do not clear the selection when doing a copy.

	* text.C (paintFirstRow): compilation fix

2001-11-27  Ben Stanley  <bds02@uow.edu.au>

	* tabular.C (Latex): correct line count when writing latex.

2001-11-27  John Levon  <moz@compsoc.man.ac.uk>

	* paragraph_pimpl.h:
	* paragraph_pimpl.C: tidy, and fix font-change in "LaTeX"
	  bug a bit

2001-11-26  John Levon  <moz@compsoc.man.ac.uk>

	* text.C:
	* LColor.h:
	* LColor.C: change vfillline->added_space

	* text.C: add markers and text for added space

	* vspace.C: fix comment

2001-11-28  André Pönitz <poenitz@gmx.net>

	* paragraph.C: whitespace changes
	* all the other files from the change on 2001/11/26:
	change *::pos_type into lyx::pos_type

2001-11-27  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (parseSingleLyXformat2Token): Set the language to the
	language of the document when inserting error insets.

2001-11-26  André Pönitz <poenitz@gmx.net>

	* BufferView_pimpl.[Ch]:
	*	CutAndPaste.C:
	* buffer.[Ch]:
	* lyxcursor.[Ch]:
	* lyxfind.C:
	* lyxfunc.C:
	* lyxrow.[Ch]:
	* paragraph.[Ch]:
	* paragraph_pimpl.[Ch]:
	* sp_spell.C:
	* text.C:
	* text2.C: reduce header dependencies, introduce type for positions

2001-11-23  John Levon  <moz@compsoc.man.ac.uk>

	* <various>: change to use Alert.h

2001-11-25  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (parseSingleLyXformat2Token): Insert an error inset
	when encountering an unknown token.
	(readLyXformat2): Show an error message if there were unknown tokens.

2001-11-22  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView2.C:
	* BufferView_pimpl.C:
	* buffer.C:
	* paragraph.h:
	* text.C:
	* text2.C: use par->isInset()

2001-11-23  John Levon  <moz@compsoc.man.ac.uk>

	* paragraph_pimpl.h:
	* paragraph_pimpl.C: cleanup

2001-11-22  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text2.C (removeRow):
	* text.C (setHeightOfRow): remove useless (and costly) call to
	getRow.

2001-11-20  Allan Rae  <rae@lyx.org>

	* paragraph.C (insertFromMinibuffer): Fix for inset related crashes.
	Now need Inset*::checkInsertChar() to return true for appropriate
	cases so that the characters in the minibuffer will actually be
	inserted.

2001-11-15  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text.C: change the order of the includes.
	(workWidth): initialize it at once.
	(workWidth): make maxw unsigned
	(setHeightOfRow): remove unused variable (inset)
	(selectSelectedWord): remove unused variable (inset)
	(paintRowText): fix drawing of hfill characters, and clean up a bit.

2001-11-14  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxserver.C (emergencyCleanup): do not try to close pipes if
	server is not running.
	(openConnection):
	(closeConnection): add debug info when server is disabled.

	* ColorHandler.C (getGCForeground): send debug message to GUI
	channel.

	* lyxrc.C: do not include lyxserver.h and tex-strings.h.

	* kbmap.C (bind): modify because return conventions of
	kb_sequence::parse have changed.

	* kbsequence.C (parse): only ignore spaces and not any stupid
	control character. This avoids tests like s[i] <= ' ', which are
	guaranteed to fail with 8bit characters and signed chars.
	Change return code to string::npos when there have been no error
	(0 was a bad idea when error is at first character)

2001-11-14  José Matos  <jamatos@fep.up.pt>

	* buffer.h:
	* buffer.C (simpleDocBookOnePar): removed unused argument.

2001-11-13  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text.C (selectNextWordToSpellcheck): do not test explicitely for
	insets which are part of a word. Paragraph::isLetter takes care of
	that now. Use Paragraph::isInset to identify insets.
	(selectSelectedWord): do not test for hyphenation break.

	* BufferView_pimpl.C (smartQuote): use Inset::isSpace, so
	that protected spaces are considered as spaces.

	* paragraph.C (isLetter): cleanup the code for ispell extras; use
	Inset::isLetter.

2001-11-12  John Levon  <moz@compsoc.man.ac.uk>

	* lyxserver.h:
	* lyxserver.C: fix it. and small cleanup.

2001-11-07  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: use inline helpers

	* LaTeXFeatures.h:
	* LaTeXFeatures.C: fix typos

	* Spacing.h:
	* Spacing.C: move spacing_string into class

	* ToolbarDefaults.C: move stuff into namespace anon

	* layout.h: update enum

	* lyxfunc.C: use better debug

	* minibuffer.h: fix typo

	* debug.h:
	* debug.C:
	* WorkArea.C: add and use Debug::WORKAREA

	* lyxtext.h:
	* text.C:
	* text2.C: code re-organisation, inline helpers

2001-11-09  Michael A. Koziarski <michael@koziarski.org>

	* Layout.C: replaced a few cases of std::vector.size() == 0 with
	std::vector.empty().

2001-11-09  Allan Rae  <rae@lyx.org>

	* paragraph.C (TeXOnePar): remove old, now-irrelevent comments about
	'\n's after tables.  Tabular and ERT inset work now makes this no
	longer necessary.

2001-11-07  John Levon  <moz@compsoc.man.ac.uk>

	* minibuffer.h:
	* minibuffer.C: fix crash, improve drop-down completion

2001-11-06  John Levon  <moz@compsoc.man.ac.uk>

	* lyxserver.h:
	* lyxserver.C: invalidate fd's when doing endPipe()

2001-11-08  José Matos  <jamatos@fep.up.pt>

	* buffer.C (sgmlLineBreak): renamed from linux_doc_line_break.
	(simpleDocBookOnePar): removed code made obsolete by the new inset code.

	* paragraph.h:
	* paragraph.C (sgmlConvertChar): renamed from linuxDocConvertChar.

2001-11-07  José Matos  <jamatos@fep.up.pt>

	* buffer.h:
	* buffer.C (sgmlError): linuxDocError renamed, and made public, added
	const qualifier.

	* buffer.C (sgmlOpenTag):
	* buffer.C (sgmlCloseTag): removed debug info.

	* buffer.h (sgmlOpenTag):
	* buffer.h (sgmlCloseTag): made public.

2001-11-07  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* buffer.C (saveParamsAsDefaults):
	* lyx_cb.C (MenuLayoutSave): remove

	* LyXAction.C (init):
	* commandtags.h:
	* lyxfunc.C (dispatch): remove LFUN_LAYOUT_SAVE_DEFAULT.

2001-11-06  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* buffer.C (setPaperStuff): removed from here...

	* bufferparams.C (setPaperStuff): ... and moved there.

2001-11-03  John Levon  <moz@compsoc.man.ac.uk>

	* minibuffer.h:
	* minibuffer.C:
	* XFormsView.C: add support for drop-down completion

2001-11-03  Dekel Tsur  <dekelts@tau.ac.il>

	* paragraph.C (TeXOnePar): Correct placement of \selectlanguage
	commands.

2001-10-31  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* gettext.C (locale_init): set LC_NUMERIC to "C" even if nls is
	disabled.

2001-10-30  John Levon  <moz@compsoc.man.ac.uk>

	* lyx_main.C: change ref to known bugs

2001-10-30  Kayvan A. Sylvan  <kayvan@sylvan.com>

	* LaTeXFeatures.C (getPackages): Use lyxskak.sty now instead
	to work around older babel problems.

2001-10-28  Kayvan A. Sylvan  <kayvan@sylvan.com>

	* LaTeXFeatures.[hC]: Now uses skak.sty for chess material.

2001-10-24  Juergen Vigna  <jug@sad.it>

	* tabular-old.C (ReadOld): below variable changes reflected.

	* tabular.[Ch]: added ltType struct for longtable header/footer
	defines and changed all instances where they are used. Added
	future support for double top/bottom rows.

2001-10-24  José Matos  <jamatos@fep.up.pt>

	* buffer.h (docbookHandleCaption):
	* buffer.C (docbookHandleCaption): removed unused function.
	(makeDocBookFile): moved docbook supported version to v4.1.

2001-10-24  José Matos  <jamatos@fep.up.pt>

	* tabular.h:
	* tabular.C (docbookRow): new function to export docbook code of a row.
	(DocBook): now honors the longtable flags.

2001-10-23  José Matos  <jamatos@fep.up.pt>

	* LaTeXFeatures.h:
	* LaTeXFeatures.C (getLyXSGMLEntities): new function to get the name
	of the lyx defined sgml entities used in a docbook/linuxdoc document.

	* buffer.C (makeLinuxDocFile):
	(makeDocBookFile): reworked the preamble, more clean, and with
	support for lyx defined entities. Changed the document declaration
	to be more XML friendly.

	* tabular.C (DocBook): removed / terminator to be more SGML friendly,
	if we need to output XML that should be done with a filter.

2001-10-22  Juergen Vigna  <jug@sad.it>

	* sp_pspell.h (class PSpell): add alive function needed in the
	controller to see if the spellchecker could be started.

2001-10-22  Juergen Vigna  <jug@sad.it>

	* buffer.C (insertStringAsLines): modify the font for inserting
	chars in certain conditions by calling checkInsertChar(font).

2001-10-19  Juergen Vigna  <jug@sad.it>

	* text.C (workWidth): use getRow instead of wrong algorithm.
	(setHeightOfRow): fix for MARGIN_RIGHT_ADDRESS_BOX

2001-10-19  John Levon  <moz@compsoc.man.ac.uk>

	* lyxserver.h:
	* lyxserver.C:
	* lyx_main.h:
	* lyx_main.C: add emergencyCleanup (remove pipes on crash)

2001-10-19  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text.C (workWidth): do not search for the exact row when
	margintype is not MARGIN_RIGHT_ADDRESS_BOX. This is an
	optimization for big documents.

2001-10-18  Juergen Vigna  <jug@sad.it>

	* text.C (workWidth): new function with added Inset * parameter.

2001-10-16  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text2.C (setCursorFromCoordinates): use Paragraph::size_type

	* lyxtext.h: change type of refresh_pos to Paragraph::size_type;
	change return type of getColumnNearX.


	* text.C (changeRegionCase): use uppercase/lowercase instead of
	toupper/tolower.
	(leftMargin):
	(rightMargin): simplify code by factoring out the uses of
	textclasslist.
	(labelFill):
	(numberOfHfills):
	(setHeightOfRow):
	(appendParagraph): use Paragraph::size_type

2001-10-15  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* vspace.C (asLatexString): add a missing break

2001-10-15  Herbert Voss  <voss@perce.de>

	* vspace.C (asLatexString): fix bug in output of string for l% and p%.

2001-10-11  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfunc.C (getStatus): disable thesaurus when aiksaurus library
	is not available.

2001-10-10  André Pönitz <poenitz@gmx.net>

	* lyxfunc.C: removed greek_kb_flag.

2001-10-10  Herbert Voss  <voss@perce.de>

	* lyx_main.C: delete global string help_lyxdir.

2001-10-09  Herbert Voss  <voss@perce.de>

	* commandtags.h (kb_action): added LFUN_HELP_TEXINFO.

	* LyXAction.C (init): added LFUN_HELP_TEXINFO to items array.

	* lyx_main.C: added global string help_lyxdir.

	* lyxfunc.C (dispatch): added LFUN_HELP_TEXINFO to switch.

2001-10-07  Adrien Rebollo  <adrien.rebollo@gmx.fr>

	* lyxrc.C (set_font_norm_type): support iso8859-4

2001-07-02  Claus Hentschel  <claus.hentschel@mbau.fh-hannover.de>

	* LaTeX.C (deplog): add another regex for MikTeX

2001-10-05  Adrien Rebollo  <adrien.rebollo@gmx.fr>

	* lyxrc.C (set_font_norm_type): support iso8859-3

2001-10-04  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* BufferView_pimpl.C (tripleClick): fix stupid logic error.

	* LaTeXFeatures.C: remove special case of french and index

	* buffer.C (makeLaTeXFile): _really_ load babel late (i.e. just
	before \begin{document}). This solves several incompatibilities.

2001-10-03  Garst Reese  <reese@isn.net>

	* lyx_cb.C: change CheckTex error msg.

2001-10-03  José Matos  <jamatos@fep.up.pt>

	* buffer.C (simpleDocBookOnePar): add support for pass_thru.

2001-10-03  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* .cvsignore: update

	* lyx_main.C (commandLineVersionInfo): use new style version info.

	* buffer.C (writeFile):
	(makeLaTeXFile):
	(makeLinuxDocFile):
	(makeDocBookFile): use lyx_docversion instead of LYX_DOCVERSION.

	* WorkArea.C (WorkArea): use lyx_version instead of LYX_VERSION.

	* version.h: update to use stuff in version.C

	* version.C.in: new file. Contains version information determined
	at compile time. This is a merging of version.h and
	version_info.h.in.

2001-10-03  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (update): don't change "dirty" status in
	updateInset call.

2001-10-03  Angus Leeming  <a.leeming@ic.ac.uk>

	* WorkArea.C (c-tor): re-position version string slightly.

2001-10-02  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView_pimpl.C (buffer): remove call to WorkArea::show() and
	revert to previous code.

	WorkArea.[Ch]: (show, destroySplash): methods removed.

	WorkArea.C: rework code so that it's an amalgam of the codes before and
	after the splash screen was moved to WorkArea.

2001-10-01  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxrc.C (read):
	* vspace.C (inPixels):
	(lyx_advance):
	* kbmap.C (bind):
	* buffer.C (insertStringAsLines):
	(asciiParagraph): fix types to be large enough

	* lyxlex_pimpl.h: change member status from short to int

	* layout.h: fix type of endlabeltype

	* kbmap.C (bind):
	* kbsequence.C (parse): change return type to string::size_type

	* LaTeX.C (updateBibtexDependencies): comment out unneeded
	variable

	* Bullet.C (bulletSize):
	(bulletEntry): do not use short ints as parameters

	* BufferView2.C (insertLyXFile): change a char to an int.

	* WorkArea.C (WorkArea): remove unneeded floats in computation

2001-10-01  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (asciiParagraph): Treat '\\' as other chars.

	* paragraph.C (asString): Do not ignore newline/hfill chars when
	copying to the clipboard.

2001-09-29  Dekel Tsur  <dekelts@tau.ac.il>

	* paragraph_pimpl.C (simpleTeXSpecialChars): Call to textrow.start
	after a multi-line inset.

2001-09-28  Dekel Tsur  <dekelts@tau.ac.il>

	* paragraph.C (validate): Set NeedLyXFootnoteCode

2001-09-27  Angus Leeming  <a.leeming@ic.ac.uk>

	* lyxfont.C (LyXSizeNames): changed increase-error to increase
	and decrease-error to decrease.

2001-09-27  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text2.C (deleteEmptyParagraphMechanism): reformat a bit to make
	it more readable (should be equivalent)

2001-09-27  Adrien Rebollo  <adrien.rebollo@gmx.fr>

	* paragraph_pimpl.C (simpleTeXSpecialChars): handle latin9 too.

2001-09-26  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text2.C (fixCursorAfterDelete): new method. Fixes the parameters
	of a cursor (row, etc.) after a character has been deleted
	(deleteEmptyParagraphMechanism): call the method above on _all_
	cursors held by the LyXText when a double space has been
	detected/deleted.

2001-09-27  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView_pimpl.C (buffer): call WorkArea::show to pop-up the
	pixmap.
	(resizeCurrentBuff): remove code to destroy the old splash dialog.

	* WorkArea.[Ch]: add the "LyX" pixmap and version string to the
	background. Use greyOut() and the new show() methods to toggle between
	the foreground and background. Add code to remove the splash after
	its initial showing.

	* lyx_gui.C: Remove dependency on frontends/Dialogs.h.
	(create_forms): no longer call Dialogs::showSplash.

2001-09-26  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* .cvsignore: add version_info.h

2001-09-25  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* version_info.h.in: new file

	* Makefile.am: add version_info.h.in

	* lyx_main.C (commandLineVersionInfo): use version_info defined in
	version_info.h instead of VERSION_INFO

2001-09-24  Angus Leeming  <a.leeming@ic.ac.uk>

	* text.C (selectNextWordToSpellcheck): reverted change to if-block.
	The ERT inset now returns string().

2001-09-21  Angus Leeming  <a.leeming@ic.ac.uk>

	* lyxtext.h, text.C (selectNextWord): renamed as
	selectNextWordToSpellcheck.

	* text.C (selectNextWordToSpellcheck): Modified to not select
	words inside an ERT inset.

2001-09-21  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyx_cb.C (MenuLayoutSave): change a bit the question

	* sp_base.h: include <sys/types.h>

2001-09-18  Angus Leeming  <a.leeming@ic.ac.uk>

	* LColor.[Ch]: added graphicsbg to color enum and to ColorEntry.

2001-09-20  Michael Schmitt  <Michael.Schmitt@teststep.org>

	* several files: fix typos in user-visible strings

2001-09-18  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text2.C (pasteSelection): do not set the selection, since it
	will be cleared later. Actually, the intent was to fix the way the
	selection was set, but I figured rmoving the code was just as good.

2001-09-19  Dekel Tsur  <dekelts@tau.ac.il>

	* FontLoader.C (available): Check if font is available without
	loading the font.

2001-09-19  Jürgen Spitzmüller  <j.spitzmueller@gmx.de>

	* lyxrc.[Ch]: added auto_reset_options variable and associated code.

2001-09-13  Angus Leeming  <a.leeming@ic.ac.uk>

	* lyxrc.[Ch]: added display_graphics variable and associated code.

2001-09-17  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* bufferparams.C (hasClassDefaults): new method. Returns true if
	the buffer parameters correspond to known class defaults

2001-09-17  Angus Leeming  <a.leeming@ic.ac.uk>

	* XFormsView.C (show): set minimum size to the main window.

2001-09-12  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text2.C (copySelection):
	(cutSelection):
	* lyxfind.C (LyXReplace):
	* BufferView_pimpl.C (Dispatch): pass the correct flag to
	LyXText::selectionAsString.

	* paragraph.C (asString): add "label" argument to the second form

	* text2.C (selectionAsString): add "label" argument and pass it to
	Paragraph::asString.

2001-09-10  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyx_main.C (commandLineHelp): remove version information

2001-09-08  Rob Lahaye  <lahaye@users.sourceforge.net>

	* lyx_main.C: add -version commandline option

2001-09-09  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.h: make the optional constructor arg required instead.
	some modifications to other files because of this.

	* minibuffer.C (C_MiniBuffer_peek_event): make it static

	* lyxserver.C (C_LyXComm_callback): make it static

	* lyx_main.C (error_handler): make it static

	* lyx_gui.C (LyX_XErrHandler): make it static

	* XFormsView.C (C_XFormsView_atCloseMainFormCB): make it static

	* WorkArea.C: make the extern "C" methods static.

	* Makefile.am (lyx_LDADD): simplify

2001-09-02  Angus Leeming  <a.leeming@ic.ac.uk>

	* commandtags.h: removed redundant LFUNs, LFUN_HELP_COPYRIGHT,
	LFUN_HELP_CREDITS, LFUN_HELP_VERSION.

	* LyXAction.C (init):
	* lyxfunc.C (dispatch): associated code removal.

2001-09-07  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfont.h (isSymbolFont): shut off warning

	* text.C (setHeightOfRow):
	(getVisibleRow): fix crash with empty paragraphs which have a
	bottom line

2001-09-07  Rob Lahaye  <lahaye@users.sourceforge.net>

	* lyxrc.[Ch]: added dialogs_iconify_with_main variable and associated
	code.

2001-09-04  José Matos  <jamatos@fep.up.pt>
	* buffer.C
	* buffer.h
	* tabular.C (docbook): rename docBook method to docbook.

2001-09-02  Angus Leeming  <a.leeming@ic.ac.uk>

	* Makefile.am: add dependencies to main.o.

2001-09-03  Dekel Tsur  <dekelts@tau.ac.il>

	* FontLoader.C (available): Return false if !lyxrc.use_gui

2001-09-03  Michael Schmitt <schmitt@itm.mu-luebeck.de>

	* FontInfo.C (query):
	* converter.C (view):
	* importer.C (Import):
	* exporter.C (Export): Can not -> cannot.

2001-09-02  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: allow to create index inset even if
	  string is empty

2001-09-02  Angus Leeming  <a.leeming@ic.ac.uk>

	* buffer.C (getLists): replace boost::tie code with an explicit pair
	as boost::tie can break some compilers.

	* iterators.h: Added a std:: declaration to the return type of
	ParIterator::size.

2001-08-31  John Levon  <moz@compsoc.man.ac.uk>

	* lyxrc.C: add help for view_dvi_paper_option, default to safe
	  case.

2001-09-02  Dekel Tsur  <dekelts@tau.ac.il>

	* iterators.[Ch]: New files. Provide paragraph iterators.

	* buffer.C (changeLanguage): Use paragraph iterators.
	(isMultiLingual): ditto

	* BufferView2.C (ChangeInsets): Use paragraph iterators.

2001-09-01  Dekel Tsur  <dekelts@tau.ac.il>

	* FontLoader.C: Support for cmr font.

2001-08-31  Dekel Tsur  <dekelts@tau.ac.il>

	* FontLoader.C (getFontinfo): Handle latex symbol fonts.
	(available): New method.

	* FontInfo.C (getFontname): Use scalable fonts even when
	lyxrc.use_scalable_fonts is false, if no non-scalable fonts was
	found.

2001-08-23  Angus Leeming  <a.leeming@ic.ac.uk>

	* converter.C (Formats::view): reverted! Incorrect fix.

2001-08-23  Angus Leeming  <a.leeming@ic.ac.uk>

	* converter.C (Formats::view): only output the -paper option
	if the dvi viewer is xdvi, thereby fixing bug #233429.

2001-08-23  Herbert Voss  <voss@perce>

	* BufferView_pimpl.C: small fix for LFUN_INSERT_BIBTEX

2001-08-20  Dekel Tsur  <dekelts@tau.ac.il>

	* Spacing.h (Spacing): Set space to Default on in the default
	constructor.

2001-08-19  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* vc-backend.h (RCS::versionString): add RCS to version
	(CVS::versionString): add CVS to version

	* vc-backend.C (scanMaster): do not add CVS to version.
	(scanMaster): do not add RCS to version

	* lyxvc.C (versionString): new method

	* lyxfunc.C (initMiniBuffer): use LyXVC::versionString

2001-08-18  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* Spacing.C (set): initialize fval

2001-08-15  Dekel Tsur  <dekelts@tau.ac.il>

	* lyxlex_pimpl.C (next): Treat \ as normal char if not followed by
	" or \.

2001-08-16  Juergen Vigna  <jug@sad.it>

	* lyxfunc.C (dispatch): implemented the new FINISHED states.

2001-08-16  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C:
	* figureForm.C:
	* lyxtext.h:
	* text2.C: setParagraph takes linespacing now

2001-08-15  John Levon  <moz@compsoc.man.ac.uk>

	* LyxAction.C: add internal LFUN_CITATION_INSERT

	* LyXView.C: actually apply fix

	* bufferlist.C: fix open non-existent file

	* lyxfind.C: fix indentation

	* lyxfunc.C: remove unneeded assert, fix typo

2001-08-16  John Levon  <moz@compsoc.man.ac.uk>

	* MenuBackend.C: use "Floatname List"

2001-08-14  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (parseSingleLyXformat2Token): Do not generate errors
	when converting LaTeX layout to insetERT.
	Generate a non-collapsed float when reading old float

2001-08-13  Dekel Tsur  <dekelts@tau.ac.il>

	* BufferView2.C (showLockedInsetCursor): Use normal cursor shape in
	ERT insets.

2001-08-13  Juergen Vigna  <jug@sad.it>

	* text.C (fill): return 0 instead of 20 as this seems to be the more
	correct value.

2001-08-13  Dekel Tsur  <dekelts@tau.ac.il>

	* encoding.C (TransformChar): Use lyxrc.font_norm_type instead of
	lyxrc.font_norm.

2001-08-13  Juergen Vigna  <jug@sad.it>

	* lyxfind.C (LyXReplace): fixed not single-replacing characters with
	casesensitive off.
	(SearchBackward): comment out the unlocking of the inset_owner this
	should not be needed!

2001-08-11  Dekel Tsur  <dekelts@tau.ac.il>

	* Many files: Remove inherit_language, and add latex_language

	* BufferView2.C (showLockedInsetCursor): Fix cursor shape in
	collapsible insets.

2001-08-10  Juergen Vigna  <jug@sad.it>

	* text.C (prepareToPrint): fixed hfill-width in draw!

	* BufferView2.C (selectLastWord): save the selection cursor as this
	now is cleared in the function LyXText::clearSelection!

2001-08-08  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (Dispatch): use a non-cut-buffer cut on DELTE
	BACKSPACE type functions.

	* CutAndPaste.C (cutSelection): added a bool so that the stuff actually
	is only cutted from the document but not put in the cut-buffer, where
	still the old stuff should be.

	* text2.C (cutSelection): added bool to pass to CutAndPaste::cutSelection.

	* BufferView2.C (cut): added a bool to pass to LyXText::cutSelection.

	* tabular.C (SetWidthOfCell): fixed special case where the width
	was not updated!
	(LeftLine): handle '|' in align_special.
	(RightLine): ditto
	(LeftAlreadyDrawed): ditto
	(SetWidthOfCell): ditto

2001-08-07  Juergen Vigna  <jug@sad.it>

	* lyx_main.C (readUIFile): fixed some forgotten lowercase!

2001-08-06  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxlex_pimpl.[Ch]: converto to lowercase funcs
	* lyxlex.[hC]: ditto

2001-08-06  Juergen Vigna  <jug@sad.it>

	* text.C (getVisibleRow): fix up row clearing a bit.

2001-08-04  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* minibuffer.C: make sure the X server sees the changes in the input.

2001-08-03  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.C (getFont): split into...
	(getLabelFont): this
	(getLayoutFont): and this
	* paragraph_pimpl.C (realizeFont): calling this

	* text2.C (getFont): split into...
	(getLayoutFont): this
	(getLabelFont): and this
	(realizeFont): all three calling this

	* lyxfont.h: remove all NO_LATEX macros and code... adjust all
	files where used.

2001-08-03  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfunc.C (getStatus): add checkbox support for LFUN_APPENDIX

2001-08-02  Kayvan A. Sylvan  <kayvan@sylvan.com>

	* BufferView_pimpl.C (smartQuote): Added code to exempt pass_thru
	layouts from the Quote inset insertion.

2001-08-03  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (update): do the fitCursor only at the end!

	* screen.C (drawFromTo): don't call fitcursor here and do the loop
	only if status not is already CHANGED_IN_DRAW (second level).

	* text.C (draw): don't set the need_break_row when inside an
	InsetText LyXText.

2001-08-02  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C (parseSingleLyXformat2Token): handle more latex
	conversion cases.

	* bufferview_funcs.[hC]: change function names to
	begin with small char, adjust other files.

2001-08-02  André Pönitz <poenitz@gmx.net>

	* lyxfunc.C:
	BufferView_pimpl.C: remove broken special code for math-greek

2001-08-02  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (update): redone this function so that we
	update the text again if there was a CHANGE_IN_DRAW.

	* screen.C (cursorToggle): removed LyXText parameter and recoded.
	(drawFromTo): added a new internal bool which is used by draw() and
	redraw() function.
	(general): some cursor drawing problems fixed.

2001-08-01  Juergen Vigna  <jug@sad.it>

	* lyxfind.C (LyXFind): fixed
	(SearchForward): ditto
	(SearchBackward): ditto

	* BufferView_pimpl.C (workAreaMotionNotify): hopefully fixed the
	spurius drawing of the cursor in the main area.

	* text2.C (status): small fix which could lead to a segfault!
	(clearSelection): remove unneeded BufferView param.

2001-08-01  André Pönitz <poenitz@gmx.net>

	* lyxfunc.C: small change due to changed mathed interface

2001-08-01  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* bufferlist.C (loadLyXFile): add .lyx to file name if necessary

2001-08-01  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.c: fail gracefully if file doesn't exist

	* LyXSendto.C:
	* buffer.C:
	* lyxfunc.C:
	* BufferView_pimpl.C: IsDirWriteable() proto changed

	* LyXView.C: fix updateWindowTitle() to store the last title

2001-07-31  Juergen Vigna  <jug@sad.it>

	* text.C (setHeightOfRow): fixed setting of ascent/descent based on
	the font (wrong since using of Paragraph::highestFontInRange).

	* paragraph.C (highestFontInRange): added a default_size parameter.

	* text.C (getVisibleRow): minor clear row changes (still not perfect).
	(setHeightOfRow): reformat

2001-07-30  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* converter.[hC] + affected files: move to (inital-char)lowercase
	function names.

	* ParagraphParameters.C (ParagraphParameters): remove commented code

	* PainterBase.[Ch]: remove commented code

	* LaTeXFeatures.h: add "bool floats" for float.sty

	* LaTeXFeatures.C (LaTeXFeatures): init floats
	(require): handle float
	(getPackages): do it with floats

2001-07-30  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* BufferView_pimpl.C (Dispatch): improve handling of
	LFUN_INDEX_INSERT_LAST and LFUN_INDEX_CREATE

	* commandtags.h: #include lyxfont.h here temporarily to avoid
	keybinding bug.

	* bufferlist.h: include LString.h here.

2001-07-27  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* text2.C (getStringToIndex): new method.

2001-07-29  Asger Alstrup Nielsen  <alstrup@alstrup>

	* *: Reduced header file dependencies all over.

2001-07-30  Baruch Even  <baruch@lyx.org>

	* buffer.C (readInset): Stop auto-converting InsetFig to InsetGraphics.

2001-07-29  Baruch Even  <baruch@lyx.org>

	* buffer.C (readInset): Changed GRAPHICS to Graphics.

2001-07-27  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* ParameterStruct.h (endif): add a default constructor to make
	sure that all variables is initialized.

	* ParagraphParameters.C (ParagraphParameters): adjust

2001-07-27  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* BufferView_pimpl.C (Dispatch): use WHOLE_WORD selection for
	index; also, check that there is something to index, and that it
	does not span over several paragraphs.
	(doubleClick): use WHOLE_WORD_STRICT for double click.

	* text.C (getWord): handle new WHOLE_WORD_STRICT word_location value.

	* text2.C (toggleFree): do selection with WHOLE_WORD_STRICT
	scheme.

2001-07-26  Baruch Even  <baruch@lyx.org>

	* buffer.C (readInset): Changed to call up InsetGraphics when reading
	an InsetFig figure, backwards compatible reading of old figure code.

2001-07-27  Juergen Vigna  <jug@sad.it>

	* text2.C: font.realize function adaption.

	* text.C (draw): add a warnings lyxerr text if needed.

	* layout.C: font.realize function adaption.

	* language.C: add inherit_language and implement it's handlings

	* bufferview_funcs.C (StyleReset): remove language parameter from
	font creation (should be language_inherit now).

	* bufferparams.C (writeFile): handle ignore_language.

	* paragraph.C (getFontSettings): the language has to be resolved
	otherwise we have problems in LyXFont!

	* lyxfont.C (lyxWriteChanges): added document_language parameter
	(update): removed unneeded language parameter

	* paragraph.C (validate): fixed wrong output of color-package when
	using interface colors for certain fonts in certain environments,
	which should not seen as that on the final output.

2001-07-26  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C:
	* Thesaurus.h:
	* Thesaurus.C:
	* Makefile.am:
	* commandtags.h:
	* LyXAction.C: add thesaurus support

	* lyxfind.h:
	* lyxfind.C: add "once" parameter, for thesaurus, to not
	  move to the next match

2001-07-26  Juergen Vigna  <jug@sad.it>

	* lyxfont.C (realize): honor ignore_language too!
	(resolved): ditto.

	* paragraph.C (TeXOnePar): handle ignore language right (hopefully).

	* text.C (draw): one place more for ignore_language to not draw
	itself!

2001-07-25  Angus Leeming  <a.leeming@ic.ac.uk>

	* LaTeXFeatures.C (getPackages): clean-up a little of the natbib code.

2001-07-26  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C (parseSingleLyXformat2Token): a more general fix for
	the minipage conversion problem.

2001-07-26  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C (parseSingleLyXformat2Token): check minipage if we
	insert an inset.

2001-07-25  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* BufferView.h: don't forward declare WorkArea

	* BufferView.C: don't include WorkArea.h

2001-07-25  André Pönitz <poenitz@gmx.net>

	* commandtags.h:
	* LyXAction.C:
	* lyxfunc.C:  new LFUN 'math-space'

	* BufferView.[Ch]: remove unneeded reference to 'WorkArea'

2001-07-25  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C (toggleInset): call open/close

2001-07-24  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxfunc.C (dispatch): add debug for the disabled case

	* font.C (buttonText): make similar to rectText

	* buffer.C (readInset): comment out parsing of insetlist and
	insttheorem

	* PainterBase.C (rectText): small correction

	* BufferView_pimpl.C: comment out insettheorem and insetlist
	* LyXAction.C: ditto
	* commandtags.h: ditto

2001-07-24  Juergen Vigna  <jug@sad.it>

	* text.C (draw): honor the ignore_language.

	* lyxfont.C (LyXFont): set language to ignore_language in FONT_INIT1.

2001-07-24  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfunc.C (getStatus): BREAKLINE does _not_ insert a special
	char inset.

2001-07-24  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxtext.h: remove unused (and unimplemented) methods

2001-07-23  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* text.C (getVisibleRow): honor background color

	* PainterBase.h:
	* Painter.h: remove default color argument for fillRectangle

	* text.C (backgroundColor): new method

2001-07-24  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text.C (getVisibleRow): adjust

	* font.[Ch] (rectText): new method, metrics
	(buttonText): new method, metrics

	* PainterBase.[hC]: make rectText and buttonText always draw and take
	fewer paramteres.

2001-07-22  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* ToolbarDefaults.C (read):
	* MenuBackend.C (read): allow escaping in all strings

	* BufferView_pimpl.C (insertAndEditInset): new method.
	(Dispatch): use insertAndEditInset whenever appropriate.

	* BufferView_pimpl.C (insertNote): removed

	* BufferView_pimpl.C (smartQuote): new method, moved from
	BufferView; if an insetquote cannot be inserted, insert a '"'
	character instead.

	* BufferView2.C: remove insertCorrectQuote();

	* lyxfunc.C (getStatus): Add support for all remaingin
	inset-insert lfuns.

	* trans_mgr.C (insertVerbatim): do not treat '"' specially.

	* lyxrc.C (read): in RC_BIND, allow escaped sequences in the
	command (necessary to pass " as parameter of self-insert.

	* text.C (selectWordWhenUnderCursor):
	(selectWord): add word_location parameter
	(selectWordWhenUnderCursor): same + remove special code for word
	boundary.
	(selectNextWord): use kind() to guess type of insetspecialchar,
	not latex().

	* buffer.C (insertStringAsLines): new method, extracted from LyXText.
	(insertErtContents): create ert insets as collapsed.
	(readInset): better compatibility code for Info inset.

2001-07-20  Juergen Vigna  <jug@sad.it>

	* lyxfunc.C (dispatch): use always LyXFind now!

	* text2.C (init): add a reinit flag so that the LyXText can be
	reinited instead of deleted and reallocated (used in InsetText).

	* BufferView_pimpl.C: use the new Inset::edit(BV, bool) where needed.

	* text.C: ditto

	* text2.C: ditto

2001-07-18  Juergen Vigna  <jug@sad.it>

	* text.C (selectNextWord): handle insets inside inset by calling
	always the bv->text functions so that we can go up the_locking_inset!

	* BufferView_pimpl.C (show/hideCursor): fixed cursor showing up
	in strange locations when inside an inset!

	* lyxfind.[Ch]: give all functions a LyXText * parameter and implement
	handling to include insets.

	* lyxfunc.C (dispatch): changes to calls SearchBackward/Forward.

2001-07-20  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* LyXAction.C (init):
	* commandtags.h:
	* BufferView_pimpl.C (Dispatch): change HYPHENATION_BREAK to
	LIGATURE_BREAK, since the name is so stupid.

2001-07-20  Angus Leeming  <a.leeming@ic.ac.uk>

	* buffer.C (readInset): enable reading of new InsetNotes as well as old
	InsetInfos.

	* FontLoader.C: remove FORMS_H_LOCATION cruft.

	* sp_form.[Ch]: remove.

	* src/LColor.[Ch]: remove noteframe. Change note to "yellow".

	* src/BufferView_pimpl.C (insertNote): use InsetNote in place of
	InsetInfo.

	* src/buffer.C (readInset): ditto.

2001-07-19  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* BufferView_pimpl.C (specialChar): new method. Obsoletes
	menuSeparator(), endOfSentenceDot(), ldots() and
	hyphenationPoint(), which are therefore removed.
	(Dispatch): handle LFUN_HYPHENATION_BREAK.

	* LyXAction.C (init):
	* commandtags.h: add LFUN_HYPHENATION_BREAK.

	* paragraph.C (getWord): removed.

	* BufferView_pimpl.C (Dispatch): use last word or selection for
	LFUN_INDEX_INSERT_LAST and LFUN_INDEX_CREATE.

	* lyx_main.C (queryUserLyXDir): do not ask before creating
	user_dir, except if it has been named explicitely.

2001-07-20  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView_pimpl.C (updateScrollbar): Fix crash when reading in
	a document of zero size.

2001-07-19  Angus Leeming  <a.leeming@ic.ac.uk>

	* LaTeXFeatures.[Ch]: add variable "bool natbib" and set it
	approriately in the c-tor and in require().
	(getPackages): output the appropriate LaTeX for natbib support.

	* buffer.C (parseSingleLyXformat2Token): set the new bufferparams
	variables "use_natbib" and "use_numerical_citations" when reading the
	LyX file.
	(readInset): read the various natbib cite commands.
	(validate): white-space change.

	* bufferparams.[Ch]: new variables "bool use_natbib" and
	"bool use_numerical_citations".
	(writeFile): output them in the LyX file.

2001-07-19  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lyxfunc.C (getStatus): add support for all the inset insertion
	commands.

	* text2.C (insertInset):
	* paragraph.C (insetAllowed):
	* BufferView_pimpl.C (insertInset): update to take into account the
	renaming of insertInsetAllowed

	* lyxfunc.C (getStatus): add support for LFUN_INSET_TOGGLE.

	* text2.C (getInset): new method. returns inset at cursor position.

	* BufferView_pimpl.C (Dispatch): changes because of this.

	* LyXAction.C (init): rename open-stuff to inset-toggle.

	* commandtags.h: rename LFUN_OPENSTUFF to LFUN_INSET_TOGGLE.

	* text2.C (toggleInset): renamed from openStuff; use
	Inset::open().

2001-07-13  Yves Bastide  <stid@libd-pc11.univ-bpclermont.fr>

	* lyxrc.C (set_font_norm_type): recognise ISO_8859_15.

	* lyxrc.h: added ISO_8859_15 to enum FontEncoding.

2001-07-18  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (readLyXformat2): Add filename to the error dialog

2001-07-18  Juergen Vigna  <jug@sad.it>

	* tabular.C (GetCellNumber): put an assert here instead of the check!

2001-07-17  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (toggleSelection): adapted too.

	* text.C (selectNextWord): adapted for use with insets.
	(selectSelectedWord): ditto

2001-07-17  Juergen Vigna  <jug@sad.it>

	* sp_spell.C (PSpell): fix initialitation order.

2001-07-17  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.C: spacing

2001-07-17  Edwin Leuven  <leuven@fee.uva.nl>

	* sp_spell.C: repair language selection for pspell

2001-07-12  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxfunc.h: change more methods to begin with lower char.

2001-07-16  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (parseSingleLyXformat2Token): Generate error insets
	for unknown layouts.

2001-07-13  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (readLyXformat2): Generate an error dialog if there are
	unknown layouts.

2001-07-16  Juergen Vigna  <jug@sad.it>

	* sp_spell.C: always compile ISpell part.

	* lyxrc.C: added use_pspell entry and it's handling.

2001-07-13  Juergen Vigna  <jug@sad.it>

	* sp_spell.C: removed double includes.

2001-07-13  Angus Leeming  <a.leeming@ic.ac.uk>

	Consistent use of Lsstream.h:
	* Lsstream.h: added using std::stringstream for consistencies sake.

	* buffer.C: removed using std::stringstream

	* lyxfont.C (stateText):
	* paragraph.C (asString):
	* text.C (selectNextWord, selectSelectedWord):
	* text2.C (setCounter):
	* vspace.C (asString, asLatexString):
	std::ostringstream -> ostringstream.

2001-07-13  Edwin Leuven  <leuven@fee.uva.nl>

	* LyXAction.C: add LFUN_HELP_ABOUTLYX
	* commandtags.h: add LFUN_HELP_ABOUTLYX
	* lyxfunc.C: add about lyx remove credits/copyright/version stuff

2001-07-13  Edwin Leuven  <leuven@fee.uva.nl>

	* BufferView_pimpl.C: sigchldchecker instead of sigchldhandeler in
	cursorToggle()
	* lyx_gui_misc.C: remove spellchecker
	* lyxfunc.C: showSpellchecker
	* sp_base.h: added
	* sp_ispell.h: added
	* sp_pspell.h: added
	* sp_spell.C: added
	* sp_form.[Ch]: removed
	* spellchecker.[Ch]: removed

2001-07-12  Kayvan A. Sylvan  <kayvan@sylvan.com>

	* paragraph_pimpl.C (simpleTeXBlanks): Simply return if pass_thru
	is set.
	(simpleTeXSpecialChars): Simply print the input character without
	any special translation if pass_thru is set.

	* layout.h: Added bool pass_thru to layout class for being able to
	implement pass through of a paragraph for Literate Programming.

	* layout.C: add LT_PASS_THRU to LayoutTags enum.
	* layout.C (LyXLayout): set pass_thru to flase in constructor.
	* layout.C (Read): add "passthru" to list of layout tags and add
	code to set the pass_thru boolean when it is read.

2001-07-12  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* trans_decl.h: remove allowed from KmodInfo

	* trans.[Ch] (AddDeakkey): change prototype to not have allowd.
	remove allowed code
	(Load): adjust

	* paragraph_pimpl.C (erase): use boost::prior

	* Painter.C (text): use data() instead of c_str() when length is
	also provided.
	* WorkArea.C (putClipboard): ditto
	* font.h (width): ditto

	* BufferView2.C: use it-> instead of (*it). for iterators
	* texrow.C: ditto
	* paragraph_pimpl.C: ditto
	* paragraph.C: ditto
	* minibuffer.C: ditto
	* language.C: ditto
	* kbmap.C: ditto
	* encoding.C: ditto
	* counters.C: ditto
	* converter.C: ditto
	* chset.C: ditto
	* Variables.C: ditto
	* TextCache.C: ditto
	* MenuBackend.C: ditto
	* LyXAction.C: ditto
	* LColor.C: ditto
	* FloatList.C: ditto
	* DepTable.C: ditto
	* ColorHandler.C (LyXColorHandler): ditto

2001-07-10  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* BufferView_pimpl.C (Dispatch): handle LFUN_OPENSTUFF.

	* text2.C (openStuff): reintroduce this method (which had been
	nuked in NEW_INSETS frenzy).

	* lyxfunc.C (Dispatch): when an action has not been handled, use
	its name in the error message, not its number.

	* paragraph.C (inInset): change method name to begin with lowercase.

	* undo_funcs.C:
	* text2.C: updates because of this.

2001-07-09  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* ToolbarDefaults.C (add): add spaces in error message

2001-07-10  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C (readLyXformat2): initialize the ert comp. variables.
	(readLyXformat2): rename return_par to first_par, use lyxlex's
	pushToken and remove the manual push handling.
	(parseSingleLyXformat2Token): add another ert comp. variable:
	in_tabular, rename return_par to first_par. handle newlines better

2001-07-05  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* kbsequence.C (getiso): redirect debug info to Debug::KBMAP.

2001-07-09  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C (getParFromID): removed

	* buffer.C (getParFromID): new method moved form lyxtext.
	* BufferView2.C (insertErrors): adjust
	(setCursorFromRow): adjust
	* BufferView_pimpl.C (restorePosition): adjust
	* lyxfunc.C (Dispatch): adjust
	* undo_funcs.C (textUndo): adjust
	(textRedo): adjust
	(textHandleUndo): adjust
	(textHandleUndo): adjust

2001-07-08  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C: up' the LYX_FORMAT

	* lyxfont.h: turn NO_LATEX on as default

	* buffer.C (insertErtContents): new methods of tex style compability.
	(parseSingleLyXformat2Token): use it several places.
	* tabular.C (OldFormatRead): and here

2001-07-07  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C: remove some commented code.
	reindent file.

	* trans_mgr.[Ch]: simplify normalkey to only take a char as arg.
	* trans.C: changes because of the above.

2001-07-07  Dekel Tsur  <dekelts@tau.ac.il>

	* text2.C (setCounter): Fix counters bug with bibliography layout.

2001-07-06  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph_pimpl.C (simpleTeXBlanks): don't go through owner_ for
	own member functions
	(simpleTeXSpecialChars): ditto

2001-07-06  Juergen Vigna  <jug@sad.it>

	* a lot of files: changed the access to LyXText::status and the
	call of undo-functions.

	* undo.[Ch]: added a inset_id to the undo informations.

	* undo_funcs.[Ch]: added and moved here all undo functions.

	* lyxtext.h: give the status enum a weight, made status_ a private
	variable and made accessor functions for it, removed the whole bunch
	of undo-functions as they are now in their own file, make some
	functions publically available. Added function ownerParagraph with
	int parameter.

	* paragraph.[Ch]: added "bool same_ids" to the constructor,
	made InInset() a const function, added getParFromID() function.

	* buffer.[Ch]: added const version for inset_iterator functions,
	added getInsetFromID() function.

	* BufferView2.C, BufferView_pimpl.C, text.C, text2.C, lyxfunc.C:
	changed undo functions for new version.

2001-07-05  Juergen Vigna  <jug@sad.it>

	* paragraph_pimpl.C (Pimpl): set id_ also here (this is because some
	unknow mechanism does not call the proper constructor but only this
	one also if I request the other!?

2001-07-06  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* BufferView_pimpl.C (resizeCurrentBuffer): init the new LyXText

	* text2.C (LyXText): use initialization lists.

	* lyxtext.h (Selection): initialize set_ and mark_
	(init): remove method

2001-07-05  Dekel Tsur  <dekelts@tau.ac.il>

	* LaTeX.C (scanLogFile): Parse rerun messages from latex packages.

2001-07-04  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* screen.[Ch]: change method names to begin with lowercase

	* BufferView_pimpl.C (updateScrollbar): simplify further and
	hopefully make it a bit faster.

2001-07-03  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* ColorHandler.C (LyXColorHandler): use GUIRunTime instead of
	calling directly xforms functions.

	* Painter.C (Painter):
	* lyx_cb.C (MenuWrite):
	* FontInfo.C (query): use GUIRunTime::x11Display() instead of
	fl_display.

	* lyx_gui.C: remove bogus guiruntime extern declaration.

2001-07-03  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C (redoHeightOfParagraph): comment out stuff we don't need
	in NEW_INSETS
	(redoDrawingOfParagraph): ditto
	(redoParagraphs): ditto
	(cutSelection): don't create a object for CutAndPaste use the
	static method directly
	(pasteSelection): ditto

	* bufferview_funcs.[Ch]: move ProhibitInput and AllowInput to
	LyXview (+ rename)

2001-07-03  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* modifications to some other files because of this.

	* Makefile.am (lyx_SOURCES): add XFormsView

	* XFormsView.[Ch]: new files

	* LyXView.[Ch]: make LyXView a base class for the gui handling for
	the main window. Move the gui dependent stuff to XFormsView

2001-07-03  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* tabular.C (GetCellInset): update cur_cell also in the row/col
	version of this function.

	* lyxfunc.C: no need to include figure_form.h here.

	* FontLoader.h:
	* lyxfunc.h:
	* lyxscreen.h:
	* text2.C:
	* lyxvc.C: no need to include forms.h here.

2001-06-29  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxrc.C (read): change debugging channel for RC_BIND to lyxrc.

	* lyxfunc.C (Dispatch):
	* Spacing.C (set):
	* BufferView_pimpl.C (Dispatch): use .c_str() on istringstream
	constructor argument.

2001-06-29  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.C (Paragraph): dont't clear, and just set layout.
	(makeSameLayout): use params's copy contructor.

	* ParagraphParameters.[Ch] (makeSame): delete method

2001-06-29  John Levon  <moz@compsoc.man.ac.uk>

	* Variables.[Ch]: fix indentation, rename set to isSet

2001-06-29  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxfunc.C (Dispatch): fix typo

2001-06-28  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* paragraph_pimpl.C: add std:: qualifier to lower_bound and
	upper_bound.

	* bufferlist.C: include assert.h for emergencyWrite().

2001-06-22  John Levon  <moz@compsoc.man.ac.uk>

	* lyx_main.C: if we can't even find a readable LYX_DIR directory,
	  give up at last (bug #425202) !

2001-06-27  John Levon  <moz@compsoc.man.ac.uk>

	* lyx_gui_misc.C:
	* sp_form.h:
	* sp_form.C:
	* spellchecker.h:
	* spellchecker.C: strip spellchecker options and bring up
	  preferences tab instead

2001-06-28  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* BufferView_pimpl.C (Dispatch): add .c_str() to the argument of
	the istringstream constructor

2001-06-27  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* paragraph.C (getLayout): fix return value

	* paragraph.h: do not declare getLayout as inline.

	* lyxtext.h: remove LyXText:: qualifier to changeRegionCase

2001-06-27  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxcursor.h (operator<): new func
	(operator>): new func
	(operator>=): new func
	(operator<=): new func

	* text.C (changeCase): use selection.start and selection.end
	(changeRegionCase): require from to be <= to. Require par to be a
	valid paragraph.

	* LaTeXFeatures.C (getFloatDefinitions): std:: qualify ostream

2001-06-27  Juergen Vigna  <jug@sad.it>

	* text.C (cursorLeftOneWord): changed to return the cursor and added
	overlay with BufferView * parameter which calls this one.
	(getWord): added
	(selectWord): use new getWord function.
	(changeCase): renamed from changeWordCase as and extended to work
	also on selections.

	* lyxtext.h: added enum word_location

	* BufferView_pimpl.C (Dispatch): change function changeWordCase to
	changeCase as this operates now also on selections.

2001-06-26  The LyX Project  <lyx@violet.home.sad.it>

	* lyxfunc.C (getStatus): support LFUN_MATH_MUTATE

	* many files: send debug output to Debug::INFO instead of
	Debug::ANY.

	* converter.C (View):
	(Convert):
	(Move): send debug output to Debug::FILES instead of console.

2001-06-26  The LyX Project  <lyx@rose.home.sad.it>

	* lyxfunc.C (getStatus): use func_status

	* func_status.h: new header, describing the results of
	LyXFunc::getStatus;

	* lyxfunc.C (getStatus): add support for LFUN_MATH_VALIGN and
	LFUN_MATH_HALIGN.

2001-06-25  The LyX Project  <jug@sad.it>

	* buffer.C (sgmlOpenTag):
	(sgmlCloseTag):
	(SimpleDocBookOnePar):	disable the depth spaces, for the moment.

2001-06-26  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C: remove some dead code

	* tabular.C (GetCellInset): store the last cell checked (gotten)

	* tabular.h: add the helper for the speedup

	* lyxtext.h: remove some dead code

2001-06-26  The LyX Project  <Asger>

	* paragraph.C: Change export to LaTeX of alignment to
	\begin{center} and family for better roundtrip work with reLyX.

	* Tune the math drawing a bit.

2001-06-25  The LyX Project  <Asger>

	* LColor.C (LColor): New color for math background. New color
	for buttons.

2001-06-25  The LyX Project  <jug@sad.it>

	* lyxfunc.C (MenuNew): remove extra check for .lyx file

	* lyxfunc.C (Open):
	* bufferlist.C (newFile): do not restrict to files ending with
	.lyx

	* BufferView_pimpl.C (MenuInsertLyXFile):

2001-06-24  The LyX Project  <jug@sad.it>

	* lyxlex_pimpl.C (compare_tags): use compare_ascii_no_case instead
	of compare_no_case

2001-06-24  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxtext.h: rename most methods to begin with a small char.
	Lots of changes because of this.

	* paragraph.C (Paragraph): do not call fitToSize
	(erase): call Pimpl::erase
	(insertChar): call Pimpl::insertChar
	(insertInset): call Pipl::insertInset
	(breakParagraph): do not call fitToSize
	(breakParagraphConservative): do not call fitToSize
	(fitToSize): remove method

	* buffer.C (parseSingleLyXformat2Token): do not call fitToSize

2001-06-24  The LyX Project  <Asger>

	* Fix Qt compilation^2

2001-06-24  The LyX Project  <jug@sad.it>

	* paragraph.[Ch] (outerHook): new method. mostly equivalent to
	depthHook(getDepth()-1).

	* paragraph.h:
	* ParagraphParameters.h:
	* ParameterStruct.h: change type of depth to unsigned int ==
	depth_type. Many adaptations to other files before of that.

2001-06-24  The LyX Project  <Asger>

	* Fix Qt compilation.

2001-06-24  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.h: renamed several methods to begin with small letter.
	several changes to many parts of the code because of this.

2001-06-23  The LyX Project  <jug@sad.it>

	* text2.C (InsertStringAsLines): renamed from InsertStringA;
	rewritten to discard all double spaces when KeepEmpty is off
	(InsertStringAsParagraphs): renamed from InsertStringB; rewritten
	to only handle newlines but not fiddle with spaces and friends.

	* lyxfunc.C (MenuNew): when doing 'new from template', use
	template_path as default directory

2001-06-23  The LyX Project  <Asger>

	* Clean-up of header file includes all over
	* paragraph.h: Move some of the stuff into paragraph_pimpl.h

2001-06-23  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.h: renamed from lyxparagraph.h

2001-06-23  Asger  <lyx@violet.home.sad.it>

	* Buffer.h: Removed Buffer::resize
	* BufferList.h: Removed BufferList::resize
	* LyXView.h: Added LyXView::resize. This way, we will only reflow
	the document lazily when we change the width, or the font settings.

2001-06-22  John Levon  <moz@compsoc.man.ac.uk>

	* lyxfunc.C: silently ignore empty dispatches from the minibuffer

2001-06-22  John Levon  <moz@compsoc.man.ac.uk>

	* buffer.h: remove out of date comment

2001-06-22  John Levon  <moz@compsoc.man.ac.uk>

	* lyxscreen.h:
	* screen.C: fix "theoretical" GC leak

2001-06-20  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* LaTeX.C (scanAuxFile):
	(deplog): remove trailing \r when reading stream (useful under
	win32)

2001-06-15  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView_pimpl.C (fitCursor): emit a signal updateParagraph.
	(resizeCurrentBuffer): have functions BufferView::theLockingInset()
	and BufferView::theLockingInset(Inset*), so should use them and not
	access bv_->text->the_locking_inset directly.

	* lyxfunc.C (Dispatch): cosmetic name change of three signals.

2001-06-02  John Levon  <moz@compsoc.man.ac.uk>

	* Makefile.am:
	* tex-defs.h: remove old unused file

2001-06-15  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: fix typo, remove minibuffer message
	  when buffer has loaded

2001-06-14  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxfunc.C (Dispatch): use stringstream
	(MenuNew): use stringstream
	(Open): use stringstream

	* importer.C (Import): use stringstream

	* bufferview_funcs.C (CurrentState): use stringstream

	* LaTeX.C (run): use stringstream

	* BufferView_pimpl.C (savePosition): use stringstream
	(restorePosition): use stringstream
	(MenuInsertLyXFile): use stringstream

2001-06-14  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView.C:
	* Bullet.C:
	* ColorHandler.C:
	* FontInfo.C:
	* FontLoader.C:
	* LColor.C:
	* LaTeXFeatures.C:
	* Painter.C:
	* gettext.C:
	* lyx_gui_misc.C:
	* lyxserver.C:
	* vspace.C: removed // -*- C++ -*- as first line.

	* lyxfind.h:
	* version.h: added // -*- C++ -*- as first line.

2001-06-13  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfunc.C (getStatus): support LFUN_READ_ONLY_TOGGLE

	* text2.C (SetSelectionOverString): do not test str[i]==0 for end
	of string

2001-06-13  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C (parseSingleLyXformat2Token): fix compatability reading
	of floats.

2001-06-12  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* gettext.C: include LString.h even when --disable-nls is on.

2001-06-12  Angus Leeming  <a.leeming@ic.ac.uk>

	* converter.h (Get): changed argument type from int to
	FormatList::size_type to avoid unnecessary conversion.

	* bufferview_funcs.C (ToggleAndShow): check state of LyXText pointer
	before using it.

2001-06-07  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* gettext.h: include LString.h even when --disable-nls is on.

2001-06-07  Juergen Vigna  <jug@sad.it>

	* text.C (BreakAgain): subst spaces with tabs.

	* paragraph.C (deleteInsetsLyXText): set recursive on deleteLyXText.
	(resizeInsetsLyXText): set force on resizeLyXText.

2001-06-05  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* gettext.h (gettext_init):
	(locale_init): use a real definition instead of a macro

2001-06-02  John Levon  <moz@compsoc.man.ac.uk>

	* Bufferview_pimpl.C:
	* LColor.h:
	* LColor.C: further lcolor tidies

2001-06-05  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* BufferView_pimpl.C (updateScrollbar): simplify.

	* BufferView2.C: don't include insets/insetinfo.h, change
	prototype for insertInset and call the Pimpl version. let
	updateInset call Pimpl version.

	* BufferView.h: move inset_slept to BufferView::Pimpl, move
	gotoInset to BufferView::Pimpl

2001-06-01  Juergen Vigna  <jug@sad.it>

	* lyxfunc.C (Dispatch): LFUN_PREFIX don't call the update if we're
	inside a LockingInset (is the update needed at all?).

2001-05-31  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (Dispatch): we need a new instanze of cursor
	here not the old one otherwise how should we compare it afterwards
	if it's the same!

2001-06-01  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfont.C:
	* tabular.C:
	* tabular-old.C:
	* FontInfo.C: bring C functions into global namespace when
	necessary

2001-05-30  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* LString.h: make sure config.h has been loaded before LString.h.

	* lyxlex_pimpl.C (EatLine): comment out annoying debug messages
	(one for each char read by EatLine!).

	* lyx_main.C (init): constify lyxdir. Lowercase the name of some
	variables.

2001-06-01  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.C (BreakParagraph): set the inset_owner in the new par
	to the same as the par we break from

2001-05-31  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* commandtags.h: add LFUN_INSET_WIDE_FLOAT

	* MenuBackend.C (expand): also create menu entries for wide
	versions of the floats.

	* LyXAction.C (init): add entry for LFUN_INSET_WIDE_FLOAT

	* BufferView_pimpl.C (Dispatch): implement LFUN_INSET_WIDE_FLOAT

	* Makefile.am (lyx_DEPENDENCIES): adjust for change in
	frontends/Makefile.am

	* text2.C: adjust
	* text.C: adjust


	* tabular.C (getTokenValue): add std::

	* tabular-old.C (getTokenValue): add std::
	(getTokenValue): ditto
	(getTokenValue): ditto

	* screen.C (ToggleSelection): adjust

	* lyxtext.h: put selection cursors inside a Selection struct.

	* lyxfunc.C (moveCursorUpdate): adjust

	* lyxfont.C (latexWriteStartChanges): add std::

	* lyxfind.C: adjust

	* font.h: delete with(char const *, LyXFont const &)

	* buffer.C (parseSingleLyXformat2Token): use contains instead of strstr

	* FontInfo.C (getFontname): add std::

	* BufferView_pimpl.C (resizeCurrentBuffer): adjust
	(workAreaButtonPress): adjust
	(tripleClick): adjust
	(update): adjust
	(moveCursorUpdate): adjust
	(Dispatch): adjust

	* BufferView2.C (gotoInset): adjust

2001-05-30  Juergen Vigna  <jug@sad.it>

	* spellchecker.C (USE_ORIGINAL_MANAGER_FUNCS): as it seems only I use
	to check pspell I add this as default as I now have new pspell
	libraries and they seem to use this.

2001-05-30  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C (CutSelection): make the cursor valid before the call to
	ClearSelection.

2001-05-29  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* kbsequence.C (parse): de-uglify a bit the parsing code, which
	relied on 0 terminated strings and other horrors. Bug found due to
	the new assert in lyxstring!

	* lyx_main.C (defaultKeyBindings): add bindings the cursor-related
	KP_ keys.

2001-05-29  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyx_main.C (defaultKeyBindings): move self-insert KP_ bindings
	to latinkeys.bind.

	* lyxfunc.C (processKeySym): change method of getting to the
	self-insert char.

	* BufferView(2).[Ch]: move hfill, protectedBlank, newline,
	menuSeparator, endOfSentenceDot, ldots, hypenationPoint and menuUndo
	* BufferView_pimpl.[Ch]: here as private methods.

2001-05-28  Juergen Vigna  <jug@sad.it>

	* text.C (SetHeightOfRow): added the update() call again as it is
	needed to initialize inset dimensions!

2001-05-16  Juergen Vigna  <jug@sad.it>

	* text2.C (SetCharFont): Add new function with BufferView * and
	bool toggleall parameters for setting insets internal fonts.
	(SetFont): Freeze the undo as we may change fonts in Insets and
	all this change should be inside only one Undo!

	* bufferview_funcs.C (ToggleAndShow): fixed this functions for
	setting font's in insets as for them we have the SetFont function!

2001-05-15  Juergen Vigna  <jug@sad.it>

	* text2.C (ClearSelection): to be sure we REALLY don't have any
	selection anymore!

	* tabular.C (TeXCellPreamble): fixed the left border problem for
	multicolumn cells.

2001-05-27  Dekel Tsur  <dekelts@tau.ac.il>

	* LaTeX.C (deplog): Make sure that the main .tex file is in the
	dependancy file

2001-05-23  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyx_main.C (defaultKeyBindings): set KP_enter to point at
	LFUN_BREAKPARAGRAPH.

	* LyXAction.C (init): remove external name for LFUN_LAYOUTNO, set
	help test to "internal only", similar for LFUN_INSERT_URL

	* BufferView_pimpl.C (Dispatch::LFUN_QUOTE): change it to to the insertcorrectQuote.
	(Dispatch::LFUN_SELFINSERT): fix to handle math greek,
	auto_region_delete and deadkeys.

2001-05-22  John Levon  <moz@compsoc.man.ac.uk>

	* LColor.h:
	* LColor.C: remove some dead entries, tidy a little

2001-05-18  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxfunc.C (processKeySym): comment the Escape handling, remove
	commented code.
	(Dispatch): implement LFUN_ESCAPE

	* commandtags.h: add LFUN_ESCAPE

	* LyXAction.C (init): add entry for LFUN_ESCAPE

	* BufferView_pimpl.C (Dispatch): adjust for open_new_inset move.
	Remove commented code.
	(insertNote): moved here
	(open_new_inset): moved here

	* BufferView[2].[Ch]: move insertNote and open_new_inset to
	BufferView_pimpl

2001-05-16  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* kbmap.C (findbinding): clean it up and make it work correctly.

	* lyx_main.C (init): do not pass argc and argv as parameters

2001-05-16  Ruurd Reitsma  <r.a.reitsma@wbmt.tudelft.nl>

	* buffer.C: fix path for OS/2 & Win32

	* lyx_gui.C:
	* lyx_main:
	* lyx_main.C: Added os:: class.

	* os2_defines.h: update

2001-05-17  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxfunc.[Ch] (processKeySym): return void. Handle unknown actions
	better by trying again with reduced state.

2001-05-16  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxrc.C (read): print error about invalid key sequence only when
	debugging (because not all latinX keysyms are known to some X
	servers)

	* kbsequence.C (getiso): add a few std:: qualifiers
	(getiso): comment out extra return statement.

2001-05-11  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* BufferView_pimpl.C (Dispatch): comment out the old "default" key
	handling.
	(Dispatch): enhance the accent inset a bit. (not perfect)

2001-05-10  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* buffer.C (makeLaTeXFile): use stringstream on language_optons.

2001-05-09  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* bufferlist.C (emergencyWrite): fix assert() call

2001-05-04  Kayvan A. Sylvan  <kayvan@sylvan.com>

	* text.C (InsertChar): Added trivial patch to only send the "you
	can not do multiple spaces this way" message once during a
	session.

2001-05-08  Baruch Even  <baruch@lyx.org>

	* Makefile.am: Changed order of libraries to get LyX to link properly
	with the gnome frontend.

2001-05-09  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* LaTeXFeatures.h: add a std:: qualifier

2001-05-09  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.C (String): use stringstream

2001-05-08  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* paragraph.C (writeFile): remove footflag arg

	* buffer.C (makeLaTeXFile): use stringstream
	(latexParagraphs): remove footnot gurba

	* LaTeXFeatures.C (getPackages): use stringstream
	(getMacros): likewise
	(getTClassPreamble): likewise
	(getFloatDefinitions): new method

	* paragraph.C (writeFile): reindent
	(Erase): reindent

	* WorkArea.h: revert the xpos + etc changes.

	* CutAndPaste.C (SwitchLayoutsBetweenClasses): constify name and s

	* lyxparagraph.[Ch]: add copy constructor, remove Clone

	* CutAndPaste.C (copySelection): use LyXParagraph copy constructor
	(pasteSelection): likewise
	* text2.C (CreateUndo): likewise

2001-05-04  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* minibuffer.C (peek_event): temporarily reduce the functionality
	of the minibuffer (to allow args on lfuns)

	* commandtags.h: remove LFUN_LOA_INSERT, LFUN_LOF_INSERT,
	LFUN_LOT_INSERT. add LFUN_FLOAT_LIST

	* buffer.C (readInset): add compability reading of old float
	lists, add reading of new style float list.
	(readInset): avoid reevaluation of inscmd.getCmdName()
	(getLists): reindent

	* MenuBackend.C (MenuItem): implement parsing of
	md_floatlistinsert and md_floatinsert.
	(expand::LastFiles): move initalizaton of iterators out of loop,
	avoid reevaluation.
	(expand::Documents): introduce typdedef vector<string> Strings,
	and use it.
	(expand::ExportFormats): introduce typedef vector<Format const *>
	Formats, and use it.
	(expand): implement FloatListInsert and FloatInsert.

	* LyXAction.C (init): remove entries for LFUN_LOA_INSERT,
	LFUN_LOA_VIEW, LFUN_LOF_INSERT, LFUN_LOFVIEW, LFUN_LOT_INSERT,
	LFUN_LOTVIEW. Add entry for LFUN_FLOAT_LIST

	* BufferView_pimpl.C (Dispatch::LFUN_TOC_INSERT): remvoe the float
	handling.
	(Dispatch::LFUN_FLOAT_LIST): implement

2001-04-28  Kayvan A. Sylvan  <kayvan@sylvan.com>

	* LaTeX.C (run): Fix problem with --export code.

2001-04-26  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView.[Ch] (workarea): removed.
	(getClipboard) new method; wrapper for workarea()->getClipboard()

	* ToolbarDefaults.C (read): removed final lex.next() command; it's a
	bug.

	* WorkArea.h (width, height, xpos, ypos): These methods all
	returned the dimensions of the work_area sub-area of WorkArea,
	resulting in a position error if the WorkArea were resized. Now
	return the dimensions of the entire WorkArea.

	* lyx_main.C (ReadUIFile): don't print out spurious warnings.

2001-05-03  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* LaTeX.C (deplog): correct the syntax of regex reg1

2001-05-03  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* undo.C: remove !NEW_INSETS cruft

2001-04-28  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C: remove !NEW_INSETS cruft

	* text.C: remove !NEW_INSETS cruft

	* tabular.C: remove !NEW_INSETS cruft

	* spellchecker.C: remove !NEW_INSETS cruft

	* lyxtext.h: remove !NEW_INSETS cruft

	* lyxlex_pimpl.C: remove !NEW_INSETS cruft

	* lyxfunc.C: remove !NEW_INSETS cruft

	* lyxfind.C: remove !NEW_INSETS cruft

	* lyx_cb.C: remove !NEW_INSETS cruft

	* figureForm.C: remove  !NEW_INSETS cruft

	* bufferview_funcs.[Ch]: remove !NEW_INSETS cruft

	* buffer.[Ch]: remove !NEW_INSETS cruft

	* ToolbarDefaults.C: remove !NEW_INSETS cruft

	* CutAndPaste.C: remove !NEW_INSETS cruft

	* BufferView_pimpl.C: remove !NEW_INSETS cruft

	* BufferView2.C: remove !NEW_INSETS cruft

	* BufferView.h: remove !NEW_INSETS cruft

2001-05-03  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* Lsstream.h: include LString.h before the sstream headers to
	fix problem with gcc 2.95.3 and lyxstring

2001-05-02  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyx_main.C: add using directives when needed for C functions
	declared in std:: namespace.

2001-04-27  Juergen Vigna  <jug@sad.it>

	* text.C (Fill): return 20 instead of 0 if paper_width < 0 (endless)
	(SetHeightOfRow): comment out the update call should not be needed!

2001-04-13  Juergen Vigna  <jug@sad.it>

	* tabular.C (GetAdditionalHeight): changed parameter from cell to row.
	(LyXTabular): tried to minimize operator= operations (and realized
	hopfully Lars wish).

2001-04-27  Juergen Vigna  <jug@sad.it>

	* spellchecker.C (sc_check_word): fixed Assert to lyx::Assert.

2001-04-27  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* lyxfunc.C (Dispatch): hack to make listof algorithm work

	* buffer.C (readInset): hack to make listof algorithm work

	* BufferView_pimpl.C: hack to make listof algorithm work

2001-04-26  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* LyXAction.C: removed all !NEW_INSETS cruft
	(init): moved lfun_item in method

	* lyxparagraph.[Ch]: removed all !NEW_INSETS cruft

2001-04-26  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView2.C (theLockingInset): white space.

2001-04-25  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* minibuffer.C: include <iostream>

	* BufferView_pimpl.C: implement LFUN_TRANSPOSE_CHARS

	* LyXAction.C (init): add LFUN_TRANSPOSE_CHARS

	* commandtags.h: add LFUN_TRANSPOSE_CHARS

	* text.[Ch] (TransposeChars): new method

2001-04-24  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* call message directly through LyXView instead of through LyXFunc
	* BufferView2.C: adjust
	* BufferView_pimpl.C: adjust
	* FontLoader.C: adjust
	* buffer.C: adjust
	* bufferview_funcs.C: adjust
	* converter.C: adjust
	* figureForm.C: adjust
	* importer.C: adjust
	* lyx_cb.C: adjust
	* lyx_gui_misc.C: adjust
	* lyxfunc.C: adjust
	* lyxvc.C: adjust
	* text2.C: adjust
	+ more files in subdirs

	* lyxparagraph.h (size): move up int file
	(GetLayout): ditto

	* adjust all uses of Assert to lyx::Assert.

	* BufferView2.C (ChangeCitationsIfUnique): adjust for
	lyxfunctional in namespace lyx
	* layout.C (hasLayout): ditto
	(GetLayout): ditto
	(GetLayout): ditto
	(delete_layout): ditto
	(NumberOfClass): ditto
	* converter.C (GetFormat): ditto
	(GetNumber): ditto
	(Add): ditto
	(Delete): ditto
	(SetViewer): ditto
	* bufferlist.C (getFileNames): ditto
	(emergencyWriteAll): ditto
	(exists): ditto
	(getBuffer): ditto
	* MenuBackend.C (hasSubmenu): ditto
	(hasMenu): ditto
	(getMenu): ditto
	* BufferView_pimpl.C (getInsetByCode): ditto

2001-04-18  Juergen Vigna  <jug@sad.it>

	* vspace.C (asLatexString): fixed the 100% problem.

2001-04-18  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfunc.C (Dispatch):
	* minibuffer.C:
	* minibuffer.h: add a few std:: qualifiers

2001-04-17  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* minibuffer.[Ch]: reimplement so that commands is initiated and
	run from lyxfunc, simplified som handling, and made the completion
	and history code for complete. wip.

	* lyxfunc.C (processKeySym): call message
	(miniDispatch): new temporary method
	(LFUN_EXEC_COMMAND): reimplement for new minibuffer
	(LFUN_MESSAGE): implement
	(LFUN_MESSAGE_PUSH): implement
	(LFUN_MESSAGE_POP): implement
	(initMiniBuffer): the initial/defualt minibuffer message.

	* lyxfont.[Ch]: inline some more getters

	* lyx_gui_misc.C (WriteAlert): use LFUN_MESSAGE

	* lyx_gui_misc.[Ch] (WriteStatus): remove method

	* lyx_cb.[Ch] (ShowMessage): remove delay arg, use LFUN_MESSAGE
	(AutoSave): use LFUN_MESSAGE
	(Reconfigure): ditto

	* importer.C (Import): constify som local vars, use LFUN_MESSAGE

	* figureForm.C: use LFUN_MESSAGE

	* converter.C (runLaTeX): use LFUN_MESSAGE

	* bufferview_funcs.C: use LFUN_MESSAGE
	(Melt): ditto
	(changeDepth): ditto

	* bufferparams.h: use boost::

	* bufferlist.h: inherit privately from noncopyable

	* bufferlist.C (loadLyXFile): remove some commented code.

	* buffer.C (runChktex): use LFUN_MESSAGE

	* ShareContainer.h: inherit privately from noncopyable

	* ParagraphParameters.[hC] (depth): inline it.

	* LyXView.[Ch] (LyXView): connect the minibuffer signals to lyxfunc
	methods.
	(message): new method
	(messagePush): ditto
	(messagePop): ditto
	(show): init minibuffer
	(showState): direct call

	* LaTeX.[Ch]: inherit privately from noncopyable
	(run): change second arg to LyXFunc*, use LFUN_MESSAGE
	instead of WriteStatus.

	* FontLoader.C (doLoad): use LFUN_MESSAGE_PUSH and LFUN_MESSAGE_POP

	* BufferView_pimpl.C (buffer): don't init minibuffer
	(workAreaButtonPress): use LFUN_MESSAGE
	(workAreaButtonRelease): ditto
	(savePosition): ditto
	(restorePosition): ditto
	(MenuInsertLyXFile): ditto
	(workAreaExpose): don't init minibuffer
	(update): remove commented code, simplify

	* BufferView2.C (openStuff): use LFUN_MESSAGE
	(toggleFloat): ditto
	(menuUndo): ditto
	(menuRedo): ditto
	(copyEnvironment): ditto
	(pasteEnvironment): ditto
	(copy): ditto
	(cut): ditto
	(paste): ditto
	(gotoInset): ditto
	(updateInset): remove some commented code

	* lastfiles.h: inherit privately from noncopyable
	* layout.h: ditto
	* lyx_gui.h: ditto
	* lyx_main.h: ditto
	* lyxlex.h: ditto
	* lyxlex_pimpl.h: ditto

	* commandtags.h: comment out LFUN_FOOTMELT, LFUN_MARGINMELT,
	LFUN_FLOATSOPERATE, LFUN_MELT, add LFUN_MESSAGE,
	LFUN_MESSAGE_PUSH, LFUN_MESSAGE_POP

	* LyXAction.h: inherit privately from noncopyable, add methods
	func_begin, func_end, returning iterators to the func map.

	* LyXAction.C (init): comment out LFUN_FLOATSOPERATE, LFUN_MELT,
	add entries for LFUN_MESSAGE, LFUN_MESSAGE_PUSH, LFUN_MESSAGE_POP
	(func_begin): new method
	(func_end): new method

	* CutAndPaste.C (cutSelection): split into two versons (NEW_INSETS
	and not)
	(copySelection): ditto
	(pasteSelection): ditto

	* BufferView.C: whitespace change
	* BufferView.h: inherit privately from noncopyable

2001-04-16  Allan Rae  <rae@lyx.org>

	* tabular-old.C (l_getline):
	* spellchecker.C (sc_check_word):
	* lyxfunc.C (Dispatch): #warning triggers an error on Sun CC 6.0 as
	an unrecognised preprocessor directive.  So ensure they're wrapped.

2001-04-14  Dekel Tsur  <dekelts@tau.ac.il>

	* src/exporter.C (Export): Give an error message when path to file
	contains spaces.

2001-04-12  Dekel Tsur  <dekelts@tau.ac.il>

	* LaTeX.C (deplog): Always check that foundfile exists.

2001-04-06  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyx_main.h:
	* lyx_main.C (ReadLanguagesFile): fix weird typo in method name

2001-04-06  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* tabular.[Ch] (getLabelList): implement new method

	* minibuffer.h: comment ouf setTiimer

	* minibuffer.C (ExecutingCB): constify res
	(peek_event): constify s
	(Set): constify ntext
	(Init): constify nicename

	* BufferView2.C (updateInset): comment out Minibuffer::setTimer

	* BufferView_pimpl.C (update): comment out Minibuffer::setTimer
	(savePosition): use two params to Minibuffer::Set
	(restorePosition): ditto

2001-04-06  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyx_main.C: include language.h

	* Makefile.am (lyx_main.o): add language.h

2001-04-05  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* exporter.C:
	* paragraph.C:
	* screen.C:
	* tabular.C:
	* CutAndPaste.C: include gettext.h

	* lyxfont.h: remove old hack with ON and OFF.

	* lyxparagraph.h:
	* lyxfont.h: do not include language.h...

	* BufferView2.C:
	* LaTeXFeatures.C:
	* Painter.C:
	* bufferview_funcs.C:
	* font.C:
	* lyxfont.C:
	* text.C:
	* text2.C:
	* trans_mgr.C:
	* paragraph.C: ... but do it here instead

2001-04-04  Lars Gullik Bjønnes  <larsbj@birdstep.com>

	* text2.C (SetLayout): split in NEW_INSETS and non NEW_INSETS version

	* tabular.C: small reformat

	* paragraph.C (GetFontSettings): split in NEW_INSETS and non
	NEW_INSETS version
	(GetChar): ditto
	(BreakParagraph): ditto
	(SetOnlyLayout): ditto
	(SetLayout): ditto

	* lyxparagraph.h: add definitions for SetLayout and SetOnlyLayout
	with one arg less.

	* lastfiles.C: removed most using decl, add std:: where needed

	* buffer.C: ws changes

	* MenuBackend.C (class compare_format): put into anon namespace
	(expand): constify label, names, action, action2
	(expand):

	* text.C (SingleWidth): constify font
	(IsBoundary): constify rtl2
	(GetVisibleRow): constify ww

	* LaTeX.C (deplog): constify logfile

	* BufferView_pimpl.C (checkInsetHit): constify width, inset_x,
	start_x, end_x
	(workAreaExpose): constify widthChange, heightChange

	* lyxrow.C (par): moved
	(height): moved
	(next): moved
	* lyxrow.h: as inlines here

	* lyxfont.h (shape): moved from lyxfont.C
	(emph): moved from lyxfont.C

	* lyxfont.C (LyXFont): use initialization list for all
	constructors
	(shape): move to lyxfont.h as inline
	(emph): move to lyxfont.h as inline


2001-04-04  Juergen Vigna  <jug@sad.it>

	* vspace.C: had to include stdio.h for use of sscanf

2001-04-03  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView.h:
	* BufferView_pimpl.h: remove xforms cruft. Both classes are
	independent of xforms.

2001-04-02  Juergen Vigna  <jug@sad.it>

	* spellchecker.C: fixed namespace placing!

2001-03-30  Angus Leeming  <a.leeming@ic.ac.uk>

	* lyxfunc.C (Dispatch): prevent crash in LFUN_GOTO_PARAGRAPH when
	the LyXParagraph * is 0.

2001-03-29  Juergen Vigna  <jug@sad.it>

	* vspace.C: added support for %, c%, p%, l%.
	(stringFromUnit): added helper function.
	(asLatexString): changed to give right results for the %-values.

	* buffer.C: convert the widthp in a width%.

2001-03-28  Angus Leeming  <a.leeming@ic.ac.uk>

	* Makefile.am: removed form1.[Ch], lyx.[Ch] and added figure_form.[Ch],
	figureForm.[Ch].

	* figureForm.[Ch]: stripped the FD_from_figure manipulation
	code out of lux_cb.[Ch], ready for its (imminent?) removal.

	* lyx_cb.[Ch]: see above.

	* figure_form.[Ch]: fdesign generated code, combining lyx.[Ch] and
	form1.[Ch].

	* form1.[Ch]:
	* lyx.[Ch]: replaced by figure_form.[Ch].

	* lyx_gui.C:
	* lyx_gui_misc.C:
	* lyxfunc.C: changed headers associated with above changes.

2001-03-27  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C: set the temporary cursor right!

2001-03-27  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView_pimpl.C (Dispatch): corrected spelling givven -> given.

2001-03-23  Angus Leeming  <a.leeming@ic.ac.uk>

	* LString.h: removed "using std::getline"!

	* BufferView_pimpl.C (Dispatch): changes due to changes in
	InsetInclude::Params.

	* buffer.C (tag_name): removed redundant break statements as they were
	producing lots of warnings with my compiler.

2001-03-23  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* LString.h: add "using std::getline" when using the real <string>.

2001-03-23  Josï¿½Abï¿½io Matos  <jamatos@fep.up.pt>

	* buffer.C: removed bitset usage.
	PAR_TAG moved to an anonymous name space.
	(tag_name): new funtion, also in the anonymous namespace.
	(SimpleLinuxDocOnePar): replaced all the references to bitset by PAR_TAG.
	(makeDocBookFile): clean code. Completed transition from string arrays
	to string vectors.
	(SimpleDocBookOnePar): code clean.

2001-03-23  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* tabular.C: add some comments.

2001-03-22  Juergen Vigna  <jug@sad.it>

	* buffer.C (parseSingleLyXformat2Token): redone the minipage
	compatibility read a bit and fixed bug with minipage in different
	depth.

2001-03-21  Josï¿½Abï¿½io Matos  <jamatos@fep.up.pt>

	* buffer.C (pop_tag): removed.
	(push_tag): removed.
	(makeLinuxDocFile): cleaner C++ code, declarations near usage point,
	array replaced with vector. Added support for CDATA sections.
	(SimpleLinuxDocOnePar): ditto. Paragraph tags are correctly handled,
	at any nest level.
	(makeDocBookFile): XML conformant declaration of CDATA section,
	fixed bug related to <emphasis> in the first paragraph char.
	(sgmlOpenTag): exclude empty tags.
	(sgmlCloseTag): ditto.

	* buffer.h (pop_tag): removed.
	(push_tag): removed.

2001-03-20  Angus Leeming  <a.leeming@ic.ac.uk>

	* language.h (Languages): added size_type and size().

2001-03-20  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* buffer.C (parseSingleLyXformat2Token): Try to give a bit better
	response on compability reading of minipages. One probliem is that
	the old usage of minipages was flertydig

	* several files here and in subdirs: don't use static at file
	scope use anon namespaces instead.

2001-03-19  Kayvan A. Sylvan <kayvan@sylvan.com>

	* paragraph.C (TeXEnvironment): Added \n to \end{environment}
	LaTeX output. This is necessary for Literate document
	processing.

2001-03-17  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* buffer.C: insert hfill when needed.

	* tabular.C (l_getline): use string::erase, small whitespace change.

	* BufferView_pimpl.C: try the anon namespace.
	* WorkArea.C: ditto

2001-03-16  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (workAreaButtonRelease): return only on button==2
	otherwise it won't open options-dialogs.

	* buffer.C: honor pextraWidth(p) on converting minipages.

	* tabular.C (l_getline): changed the functions to strip trailing \r.

2001-03-16  Angus Leeming  <a.leeming@ic.ac.uk>

	* BufferView_pimpl.C:
	* minibuffer..C: added "using SigC::slot" declaration.

2001-03-16  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* lyxlex_pimpl.h: noncopyable is in namespace boost.

	* text2.C: ditto

	* text.C: ditto

	* paragraph.C: ditto

	* lyxtext.h: NO_PEXTRA

	* buffer.C: NO_PEXTRA_REALLY, NO_PEXTRA

	* ParagraphParameters.C (clear): NO_PEXTRA_REALLY
	* ParameterStruct.h: ditto
	* ParagraphParameters.h: ditto
	* lyxparagraph.h: ditto

2001-03-15  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* buffer.C: add compability for minipage alignment.
	(latexParagraphs): remove unwanted pextra check.

	* several files: remove CXX_WORKING_NAMESPACES

	* buffer.C (pop_tag): tie is in namespace boost

	* BufferView.h: noncopyable is in namespace boost
	* lyxlex.h: ditto
	* lyx_main.h: ditto
	* lyx_gui.h: ditto
	* layout.h: ditto
	* lastfiles.h: ditto
	* bufferlist.h: ditto
	* ShareContainer.h: ditto
	* LyXView.h: ditto
	* LyXAction.h: ditto
	* LaTeX.h: ditto

2001-03-14  Angus Leeming  <a.leeming@ic.ac.uk>

	* Merging changes from BRANCH_MVC back into HEAD.

	* Makefile.am: added controllers/libcontrollers.la to lyx_DEPENDENCIES

2001-03-15  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: change from intl.C

	* combox.h:
	* combox.C:
	* Makefile.am: move combox.*

	* form1.h:
	* form1.C:
	* lyx_gui.C:
	* intl.h:
	* intl.C: remove dialog (covered by prefs)

2001-03-14  Angus Leeming  <a.leeming@ic.ac.uk>

	* lyxfunc.C (Dispatch): removed redundant break statement.

2001-03-14  Juergen Vigna  <jug@sad.it>

	* tabular.C (l_getline): pay attention on \r\n (from Windows-files)

2001-03-14  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* buffer.C: add hack to fix compability reading of minipages.

2001-03-13  Dekel Tsur  <dekelts@tau.ac.il>

	* buffer.C (getLists): Cleanup.

2001-03-13  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfont.C (update): don't honor toggleall on font size.

2001-03-13  John Levon  <moz@compsoc.man.ac.uk>

	* bmtable.c:
	* bmtable.h:
	* Makefile.am: moved to frontends/xforms/

	* lyx_gui_misc.C:
	* lyxfunc.C:
	* BufferView_pimpl.C: changes for moved mathpanel

2001-03-12  John Levon  <moz@compsoc.man.ac.uk>

	* gettext.h: fix gettext_init() in --disable-nls

2001-03-12  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* LaTeXFeatures.C (getMacros): add a .c_str() when using sstream.

2001-03-09  John Levon  <moz@compsoc.man.ac.uk>

	* lyx.C:
	* lyx.h: strip external form

2001-03-12  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: add comment, destroySplash()

2001-03-12  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C:
	* LyXAction.C:
	* buffer.C:
	* commandtags.h:
	* lyxfunc.C: use re-worked insetinclude

2001-03-12  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* buffer.C: add using std::stringstream.

	* lyx_cb.C: readd using std::ios.

	* buffer.C: add using std::map.

	* BufferView_pimpl.C: add using std::vector.

	* ShareContainer.h: add std:: to swap.

	* buffer.h: add some typedefs
	* buffer.C (getLists): use them
	(getLists): renamed from getTocList.
	add a counter for the different float types and use it in the
	generated string.
	(getLists): use the same counter for the NEW_INSETS and the "non"
	NEW_INSETS

	* lyx_cb.h: remove unused items, includes, using etc.

	* ShareContainer.h: remove some commented code, add more comments
	and "documentation".

2001-03-11  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* buffer.C (getTocList): make the list also when NEW_INSETS is
	defined.

	* buffer.h: remove TocType

	* buffer.C (getTocList): change to return a map<string,
	vector<TocItem> >, implement for dynamic number of list.

	* CutAndPaste.[Ch] (checkPastePossible): remove unused arg
	* text2.C (PasteSelection): adjust
	* CutAndPaste.C (pasteSelection): adjust

	* FloatList.C (FloatList): update from the new_insets branch.
	* Floating.[Ch]: ditto
	* LaTeXFeatures.C: ditto
	* buffer.C: ditto
	* lyxlex_pimpl.C: ditto

	* paragraph.C (Last): remove when NEW_INSETS is defined.

	* other file: changes because of the above.

2001-03-09  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* lyxparagraph.h: rename next to next_, previous to previous_,
	make them private for NEW_INSETS. Rename Next() to next(),
	Previous() to previous().

	* other files: changes because of the above.

2001-03-08  Dekel Tsur  <dekelts@tau.ac.il>

	* BufferView.h:
	* lyxparagraph.h: Add '#include "LString.h"' to fix compilation
	problem.

2001-03-08  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* main.C (main): pass lyx_localedir to gettext_init().

	* gettext.h: remove locale_init and gettext_init macros

	* gettext.C (locale_init): new function
	(gettext_init): new function

	* lyx_gui.C (LyXGUI): use locale_init() instead of explicit
	setlocale().

2001-03-07  Edwin Leuven  <leuven@fee.uva.nl>

	* Moved credits to frontends:
	* credits.[Ch]: removed
	* credits_form.[Ch]: removed
	* lyx_gui_misc.C: remove credits stuff
	* Makefile.am:

2001-03-07  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* lyx_main.C: make toplevel_keymap a boost::scoped_ptr.

	* kbmap.[Ch]: make kb_key::table a boost::shared_ptr, remove
	unneeded destructor.

	* intl.[Ch] (Intl): free the fd_form_keymap, make the fd_form_keymap
	a standalone pointer again.

	* ColorHandler.[Ch]: make lyxColorHandler a boost::scoped_ptr

2001-03-06  John Levon  <moz@compsoc.man.ac.uk>

	* Makefile.am:
	* filedlg.h:
	* filedlg.C:
	* LyXAction.C:
	* ToolbarDefaults.C:
	* bufferlist.C:
	* commandtags.h:
	* form1.C:
	* form1.h:
	* lyx_cb.C:
	* lyx_cb.h:
	* lyxfunc.h:
	* lyxfunc.C:
	* BufferView_pimpl.C: use new file dialog in GUII

	* lyx_cb.h:
	* lyx_cb.C: remove LayoutsCB to Toolbar

2001-03-07  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* ShareContainer.h (get): add std:: qualifier

2001-03-06  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* ShareContainer.h: define a proper ShareContainer::value_type
	type (and use typename to please compaq cxx)

2001-03-06  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* lyxparagraph.h: move serveral local vars to
	ParameterStruct/ParagraphParameters., use ShareContainer in
	FontTable., make vars in FontTable private and add getter and
	setter.

	* paragraph.C: changes because of the above.

	* lyxfont.h: remove copy constructor and copy assignment. (the
	default ones is ok), move number inside FontBits. move inlines to
	lyxfont.C

	* lyxfont.C: add number to initializaton of statics, move several
	inlines here. constify several local vars. some whitespace
	cleanup. Dont hide outerscope variables.

	* Spacing.h: add two new constructors to match the set methods.

	* ShareContainer.h: new file, will perhaps be moved to support

	* ParameterStruct.h: new file

	* ParagraphParameters.h: new file

	* ParagraphParameters.C: new file

	* Makefile.am (lyx_SOURCES): add ParagraphParameters.C,
	ParagraphParameters.h, ParameterStruct.h and ShareContainer.h

	* BufferView_pimpl.C: ParagraphParameter changes.
	* buffer.C: Likewise.
	* bufferview_funcs.C: Likewise.
	* text.C: Likewise.
	* text2.C: Likewise.

2001-03-06  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfind.C (LyXReplace): do not redefine default argument in
	implementation.
	(IsStringInText): ditto
	(SearchForward): ditto
	(SearchBackward): ditto

2001-03-06  Juergen Vigna  <jug@sad.it>

	* lyxfind.C (IsStringInText): put parentes around expressions.

2001-03-05  Edwin Leuven  <leuven@fee.uva.nl>

	* lyxfind.[Ch]: find stuff moved out of text2.C/lyxtext.h

2001-02-23  John Levon  <moz@compsoc.man.ac.uk>

	* lyx_main.C: add ISO_Left_Tab as bind synonym for Tab

	* stl_string_fwd.h: add comment

	* lyx_gui_misc.C: killed ALWAYS_CLOSE_MATH_PANELS

	* tabular.h:
	* tabular.C: remove unused DocBook methods

	* intl.C:
	* language.C:
	* paragraph.C:
	* buffer.C:
	killed DO_USE_DEFAULT_LANGUAGE

2001-03-01  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyx_gui.C: do not include language.h.

	* bufferview_funcs.C (ToggleAndShow): do not provide optional
	arguments in function implementation.

2001-02-28  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* BufferView_pimpl.C: add <ctime>

2001-02-27  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* BufferView_pimpl.C: add using std::find_if

2001-02-27  José Matos  <jamatos@fep.up.pt>

	* LaTeXFeatures.C (getIncludedFiles): call to BasePath replaced
	by OnlyPath.

2001-02-11  José Matos  <jamatos@fep.up.pt>

	* buffer.C (makeDocBookFile): command styles now have a parameter as
	"title" by default.

2001-02-23  Edwin Leuven <leuven@fee.uva.nl>

	* layout_forms.[Ch]: removed
	* lyx_cb.[Ch]: out character
	* lyx_gui.C: out character
	* lyx_gui_misc.C: out character
	* bufferview_funcs.C: : out character,
	added toggleall as parameter in ToggleAndShow

2001-02-26  Dekel Tsur  <dekelts@tau.ac.il>

	* lyxfunc.C (getStatus): Fix the LFUN_EXPORT case.

	* text2.C (SetCurrentFont): Disable number property at boundary.

2001-02-26  Juergen Vigna  <jug@sad.it>

	* lyxfunc.C (getStatus): added a string argument override function so
	that this is correctly called from LyXFunc::Dispatch if it contains a
	do_not_use_argument which is used!
	(Dispatch): added check for "custom" export and call appropriate func.

2001-02-23  Dekel Tsur  <dekelts@tau.ac.il>

	* lyxrc.C: Add language_command_local, language_use_babel and
	language_global_options.

	* lyxfont.C (latexWriteStartChanges): Use language_command_local.

	* buffer.C (makeLaTeXFile): Use language_use_babel and
	language_global_options.

2001-02-23  Juergen Vigna  <jug@sad.it>

	* lyxfunc.C (Dispatch): removed the whole part of the switch statement
	which works with LyXText and putted it inside BufferView. Here now we
	only call for that part the BufferView::Dispatch() function.

	* BufferView.C (Dispatch): added.

	* BufferView_pimpl.C (Dispatch): added! Here are now all dispatch
	functions which needs to use a LyXText over from LyXFunc.
	(MenuInsertLyXFile): added
	(getInsetByCode): added
	(moveCursorUpdate): added
	(static TEXT): added

2001-02-22  Juergen Vigna  <jug@sad.it>

	* BufferView_pimpl.C (update): call a status update to see if LyXText
	needs it.

2001-02-20  Lars Gullik Bjønnes  <larsbj@trylle.birdstep.com>

	* vc-backend.C (revert): implement for CVS
	(getLog): implement for CVS

2001-02-20  Juergen Vigna  <jug@sad.it>

	* text2.C (ClearSelection): added BufferView param for inset_owner call

	* lyxfunc.C (TEXT): added this function and use it instead of
	directly owner->view()-text of getLyXText().

2001-02-20  Edwin Leuven <leuven@fee.uva.nl>

	* src/layout_forms.C: out preamble
	* src/layout_forms.h: out preamble
	* src/lyx_cb.C: out preamble
	* src/lyx_cb.h: out preamble
	* src/lyx_gui.C: out preamble
	* src/lyx_gui_misc.C: out preamble
	* src/lyxfunc.C: connect with guii preamble

2001-02-19  Angus Leeming  <a.leeming@ic.ac.uk>

	* src/buffer.h: tiny clean-ups to allow compilation with DEC cxx.

2001-02-17  Dekel Tsur  <dekelts@tau.ac.il>

	* LaTeX.C (run): Do not use 'scanres & RERUN' when deciding
	whether to run bibtex.

2001-02-16  Dekel Tsur  <dekelts@tau.ac.il>

	* Makefile.am (lyx_SOURCES): Remove BackStack.h

2001-02-16  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* Makefile.am (lyx_SOURCES): removed bibforms.h

	* vspace.h: doxygen

	* text.C (GetVisibleRow): make several local vars const

	* tabular.C: small cleanup.

	* lyxserver.C (callback): use compare instead of strncmp

	* lyxparagraph.h: remove all code dep. on HAVE_ROPE, move inclass
	inlines to after class or to paragraph.C

	* lyxfont.h: remove friend operator!=

	* converter.h: move friend bool operator< to non friend and after
	class def.

	* combox.h: small cleanup

	* buffer.h: doxygen, remove unused constructor, move inclas inlies
	to inlines after class def.

	* buffer.C (pop_tag): use string operations instead of strcmp

	* bmtable.c: doxygen, small cleanup

	* LaTeX.h: remove friend operator==

2001-02-14  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* screen.C:
	* lyxrc.[Ch]:
	* lyxfunc.C:
	* lyxfont.[Ch]:
	* lyx_cb.C:
	* intl.[Ch]:
	* commandtags.h:
	* buffer.C:
	* WorkArea.[Ch]:
	* LyXAction.C:
	* BufferView_pimpl.C:
	* BufferView.[Ch]: remove cruft

2001-02-14  Juergen Vigna  <jug@sad.it>

	* lyxfunc.C: removed #if 0 unused code

	* lyxfunc.C (Dispatch): make LFUN_QUOTE work for InsetText.

	* BufferView_pimpl.C (update): set updatestatus of inset if needed.

	* text2.C (SetSelection): added a BufferView * parameter

2001-02-13  Juergen Vigna  <jug@sad.it>

	* lyxfunc.C (Dispatch): fixed protected blank problem.
	* BufferView2.C (protectedBlank): added LyxText * parameter.

	* tabular.C (AppendRow): forgot to set row_info of newly added row.
	(AppendColumn): same as above for column_info.

	* lyxfunc.C (Dispatch): supported some more functions in InsetText.
	(moveCursorUpdate): use a LyXText param for support of InsetText.

	* BufferView_pimpl.C (doubleClick): added support for InsetText.
	(tripleClick): ditto

	* lyxfunc.C (LFUN_APPENDIX): changed to use "text" pointer.

	* BufferView_pimpl.C (update): added LyXText param to honor insets.

	* bufferview_funcs.C (ToggleAndShow): fixed for text in insets.

	* text2.C (SetSelection): set correct update status if inset_owner
	(ToggleFree): ditto

2001-02-12  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* tabular.C: remove some commented code.

2001-02-12  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: call hideSplash()

	* LyXAction.C: make buffer-child-insert use LFUN_CHILD_CREATE

	* include_form.h:
	* bibforms.h: remove

	* lyxfunc.C:
	* src/commandtags.h: LFUN_CHILDINSERT -> LFUN_CHILD_INSERT,
	  add LFUN_CHILD_CREATE

	* counters.h: fix tiny typo

	* lyx_cb.C:
	* lyx.h:
	* lyx_gui.C:
	* lyx.C: move splash to frontends/xforms/

	* lyx_gui_misc.C: move Include and Bibform to frontends

	* lyxvc.h: clarify comment

	* vspace.C: tiny housekeeping

2001-02-10  Dekel Tsur  <dekelts@tau.ac.il>

	* text.C (PrepareToPrint): RTL Fix.

	* paragraph.C (GetUChar): New method.
	(String):  Use GetUChar.

	* buffer.C (asciiParagraph): Use GetUChar.

2001-02-09  Dekel Tsur  <dekelts@tau.ac.il>

	* text.C (GetVisibleRow): Fix selection drawing for RTL text in tables.

2001-02-09  John Levon  <moz@compsoc.man.ac.uk>

	* buffer.h:
	* buffer.C: rename to getLogName(), handle
	  build log / latex log nicely

2001-02-09  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* MenuBackend.C:
	* MenuBackend.h: remove support for reference menuitem type.

2001-02-07  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView_pimpl.C: housekeeping
	* BufferView_pimpl.h:
	* LyXView.h:
	* Makefile.am:
	* Timeout.C:
	* Timeout.h:
	* minibuffer.h: move Timeout GUI-I

2001-02-07  Dekel Tsur  <dekelts@tau.ac.il>

	* lyxrc.C (read): Update converters data-structures.

2001-02-07  Lars Gullik Bjønnes  <larsbj@lyx.org>

	* LaTeX.h (operator!=): add operator != for Aux_Info

2001-02-06  John Levon  <moz@compsoc.man.ac.uk>

	* Makefile.am: remove LaTeXLog.C, log_form.[Ch]

	* LaTeXLog.C: deleted, useful code moved to Buffer

	* buffer.h:
	* buffer.C: new function getLatexLogName()

	* lyx_gui_misc.C:
	* lyx_gui.C:
	* lyxvc.C:
	* lyxvc.h:
	* lyxfunc.C: use frontends for LaTeX and VC logs

2001-02-06  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* LaTeX.h: yet another std:: that Allan forgot.

	* Variables.C (set): renamed from isset(), because this clashes
	with some HP-UX macros (grr).

2001-02-06  Allan Rae  <rae@lyx.org>

	* LaTeX.h: Another bug fix.  Missing std:: this time.

2001-02-04  Allan Rae  <rae@lyx.org>

	* paragraph.C (TeXOnePar): Partial fix for the '\n' generation in
	floats problem. I've left it commented out because it's not quite
	correct.  It should also test that the current object is a table or
	figure inset.  But I haven't gotten around to figuring out how to do
	that.  I *think* it'll be something like: "table" == inset.type()

	* LaTeX.h (operator==): Aux_Info should have a friend that returns a
	bool.

2001-02-02  Dekel Tsur  <dekelts@tau.ac.il>

	* LaTeX.C (scanAuxFile): A rewrite of this method. It now returns
	all the citation/databases/styles in the auxilary file.
	(run): Rerun latex if there was a babel language error.

2001-02-01  Dekel Tsur  <dekelts@tau.ac.il>

	* text.C (Backspace): Preserve the font when changing newline char
	with a space.
	(BreakParagraph): If the cursor is before a space, delete the space.

	* lyx_cb.C (QuitLyX): Do not save files when running with no gui.

2001-01-31  Dekel Tsur  <dekelts@tau.ac.il>

	* BufferView2.C (ChangeInsets): Renamed from ChangeRefs. Accept a
	new argument (code).
	(ChangeCitationsIfUnique): New method.

	* paragraph.C (GetPositionOfInset): Handle bibkey.

2001-01-29  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* BufferView_pimpl.h: change type of Position::par_pos to
	LyXParagraph::size_type.

2001-01-29  Dekel Tsur  <dekelts@tau.ac.il>

	* BufferView_pimpl.C (savePosition, restorePosition): Write
	messages to minibuffer.

2001-01-28  José Matos  <jamatos@fep.up.pt>

	* buffer.C (makeDocBookFile): adds support for document language.
	A silly restriction on the name of LatexCommand types where removed.
	Added support for CDATA sections, allows to chars unescaped, used
	among others in code, to avoid escape < and >.

2001-01-27  Dekel Tsur  <dekelts@tau.ac.il>

	* BufferView_pimpl.C (savePosition, restorePosition): Use a vector of
	saved positions instrad of a stack. Furthermore, a position is
	stored using paragraph id/paragraph position.

	* commandtags.h: Add LFUN_BOOKMARK_SAVE and LFUN_BOOKMARK_GOTO.
	Remove LFUN_REF_BACK.

2001-01-27  Dekel Tsur  <dekelts@tau.ac.il>

	* converter.C (dvipdfm_options): New method.

2001-01-26  Dekel Tsur  <dekelts@tau.ac.il>

	* vspace.C (isValidLength): Fix for empty input string.

2001-01-26  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* LyXAction.C (init): change description of LFUN_FIGURE to
	"Insert Graphics"

2001-01-25  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* LaTeX.C: add using directive

2001-01-24  Dekel Tsur  <dekelts@tau.ac.il>

	* MenuBackend.C (expand): Fix the sorting of the formats.

2001-01-24  John Levon  <moz@compsoc.man.ac.uk>

	* lyx_main.C: tiny error message fix

2001-01-24  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyx_gui.C (LyXGUI): force the LC_NUMERIC locale to "C" after
	calling fl_initialize(). This fixes the problem with ',' as
	decimal separator in text files.

2001-01-24  Dekel Tsur  <dekelts@tau.ac.il>

	* trans.C (process): Fix the keymap bug.

2001-01-23  Dekel Tsur  <dekelts@tau.ac.il>

	* LaTeX.C (scanAuxFiles): New method. Provides support for
	multiple bibliographies (when using the bibtopic/bibunits pacakges).
	(scanLogFile) Scan for "run BibTeX" messages.

	* buffer.C (makeLaTeXFile): Do not load the ae package when using
	OT1 font encoding. Also, load the aecompl package if the ae
	package is loaded.

	* tex-strings.C: Add "ae" to tex_fonts[] (from Matej Cepl).

2001-01-22  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* texrow.C (increasePos): turn two error messages into debug
	messages.

2001-01-20  Dekel Tsur  <dekelts@tau.ac.il>

	* LaTeX.C (scanAux): Handle the \@input macro.
	(runBibTeX): Use scanAux().

	* language.C (latex_options_): New field.

	* LaTeXFeatures.C (getMacros): Add language macros.

	* buffer.C (makeLaTeXFile): Small fix.

2001-01-19  Jean-Marc Lasgouttes  <Jean-Marc.Lasgouttes@inria.fr>

	* lyxfunc.C: fix the name of the inset for LFUN_CHILDINSERT

	* text2.C: add a using directive.

2000-01-17  John Levon  <moz@compsoc.man.ac.uk>

	* BufferView2.C:
	* lyx_gui_misc.h:
	* lyxfr1.C:
	* lyxfunc.C: kill LyXBell.

2001-01-17  Dekel Tsur  <dekelts@tau.ac.il>

	* text.C (IsBoundary): Remove the error message

	* WorkArea.C (work_area_handler): Decrease keyboard purge threshold.

	* lyxrc.C (setDefaults): Correct initialization value for
	font_norm_type.

2001-01-15  Dekel Tsur  <dekelts@tau.ac.il>

	* BufferView2.C (gotoInset): New method. Replaces gotoNote() and
	gotoError().

	* text2.C (GotoNextInset): New method. Replaces GotoNextError()
	and GotoNextNote().

	* src/LyXAction.C: Added reference-next.

	* text.C (InsertChar): Use contains instead of strchr.

	* lyx_cb.C (MenuInsertLabel): Enable default value code.

2001-01-13  Dekel Tsur  <dekelts@tau.ac.il>

	* paragraph.C (SimpleTeXOnePar) Put \protect before paragraph
	alignment commands (when needed).

	* text.C (InsertChar): Add ':' to number separator chars.
